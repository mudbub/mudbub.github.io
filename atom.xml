<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>RmVsaXg</title>
  
  <subtitle>Stay hungry Stay foolish</subtitle>
  <link href="http://falkon.cn/atom.xml" rel="self"/>
  
  <link href="http://falkon.cn/"/>
  <updated>2021-02-21T03:32:31.274Z</updated>
  <id>http://falkon.cn/</id>
  
  <author>
    <name>Felix</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>在Docker中备份MySQL，备份文件中没有数据</title>
    <link href="http://falkon.cn/2021/02/21/linux/backup-in-the-docker-dumpfile-0/"/>
    <id>http://falkon.cn/2021/02/21/linux/backup-in-the-docker-dumpfile-0/</id>
    <published>2021-02-20T16:46:34.382Z</published>
    <updated>2021-02-21T03:32:31.274Z</updated>
    
    <content type="html"><![CDATA[<p>在Docker中使用脚本备份MySQL的时候出现一个奇怪的问题，产生的备份文件大小都为零，没有任何数据。但是手动执行脚本文件时候，备份文件中数据是完整的。</p><ul><li>备份脚本如下</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@docker-host ~]<span class="comment"># cat backup-mysql-redmine.sh </span></span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">bak_dir=<span class="string">"/backups/mysql-redmine"</span></span><br><span class="line">bak_time=`date +%Y%m%d-%H-%M-%S`</span><br><span class="line">docker <span class="built_in">exec</span> -it c51994799113 mysqldump -uroot -proot redmine &gt; <span class="variable">$bak_dir</span>/redmine-<span class="variable">$bak_time</span>.sql</span><br></pre></td></tr></table></figure><ul><li>计划任务如下</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@docker-host ~]<span class="comment"># crontab -l</span></span><br><span class="line">*/5 * * * * /root/backup-mysql-redmine.sh</span><br></pre></td></tr></table></figure><ul><li>crontab产生备份文件如下</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@docker-host mysql-redmine]<span class="comment"># ll</span></span><br><span class="line">total 0</span><br><span class="line">-rw-r--r--. 1 root root 0 Feb 21 00:45 redmine-20210221-00-45-01.sql</span><br><span class="line">-rw-r--r--. 1 root root 0 Feb 21 00:50 redmine-20210221-00-50-01.sql</span><br><span class="line">You have new mail <span class="keyword">in</span> /var/spool/mail/root</span><br></pre></td></tr></table></figure><ul><li>系统产生的邮件内容</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">You have new mail <span class="keyword">in</span> /var/spool/mail/root</span><br><span class="line">[root@docker-host mysql-redmine]<span class="comment"># </span></span><br><span class="line">[root@docker-host mysql-redmine]<span class="comment"># </span></span><br><span class="line">[root@docker-host mysql-redmine]<span class="comment"># more /var/spool/mail/root </span></span><br><span class="line">From root@docker-host.localdomain  Sat Feb 20 21:55:01 2021</span><br><span class="line">Return-Path: &lt;root@docker-host.localdomain&gt;</span><br><span class="line">X-Original-To: root</span><br><span class="line">Delivered-To: root@docker-host.localdomain</span><br><span class="line">Received: by docker-host.localdomain (Postfix, from userid 0)</span><br><span class="line">id D3D0E619B686; Sat, 20 Feb 2021 21:55:01 +0800 (CST)</span><br><span class="line">From: <span class="string">"(Cron Daemon)"</span> &lt;root@docker-host.localdomain&gt;</span><br><span class="line">To: root@docker-host.localdomain</span><br><span class="line">Subject: Cron &lt;root@docker-host&gt; /root/backup-mysql-redmine.sh</span><br><span class="line">Content-Type: text/plain; charset=UTF-8</span><br><span class="line">Auto-Submitted: auto-generated</span><br><span class="line">Precedence: bulk</span><br><span class="line">X-Cron-Env: &lt;XDG_SESSION_ID=6&gt;</span><br><span class="line">X-Cron-Env: &lt;XDG_RUNTIME_DIR=/run/user/0&gt;</span><br><span class="line">X-Cron-Env: &lt;LANG=en_US.UTF-8&gt;</span><br><span class="line">X-Cron-Env: &lt;SHELL=/bin/sh&gt;</span><br><span class="line">X-Cron-Env: &lt;HOME=/root&gt;</span><br><span class="line">X-Cron-Env: &lt;PATH=/usr/bin:/bin&gt;</span><br><span class="line">X-Cron-Env: &lt;LOGNAME=root&gt;</span><br><span class="line">X-Cron-Env: &lt;USER=root&gt;</span><br><span class="line">Message-Id: &lt;20210220135501.D3D0E619B686@docker-host.localdomain&gt;</span><br><span class="line">Date: Sat, 20 Feb 2021 21:55:01 +0800 (CST)</span><br><span class="line"></span><br><span class="line">the input device is not a TTY</span><br></pre></td></tr></table></figure><ul><li><p>分析<br>上面的备份命令中从mysqldump之后的命令我们是理解的，跟正常的MySQL的备份使用是一致的，那么问题应该出现在<code>docker exec -it c51994799113</code>这半条命令里面，首先<code>docker exec</code>根据官网的描述是：Run a command in a running container，意思是说在容器中运行命令，那么排除了这条命令出现问题的可能。其次<code>c51994799113</code>这个只是MySQL的容器ID，那么问题应该就出现在<code>-it</code>这个参数上了，执行<code>docker exec --help</code>来查看命令的帮助： </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@docker-host ~]<span class="comment"># docker exec --help</span></span><br><span class="line"></span><br><span class="line">Usage:  docker <span class="built_in">exec</span> [OPTIONS] CONTAINER COMMAND [ARG...]</span><br><span class="line"></span><br><span class="line">Run a <span class="built_in">command</span> <span class="keyword">in</span> a running container</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">  -d, --detach               Detached mode: run <span class="built_in">command</span> <span class="keyword">in</span> the background</span><br><span class="line">      --detach-keys string   Override the key sequence <span class="keyword">for</span> detaching a container</span><br><span class="line">  -e, --env list             Set environment variables</span><br><span class="line">      --env-file list        Read <span class="keyword">in</span> a file of environment variables</span><br><span class="line">  -i, --interactive          Keep STDIN open even <span class="keyword">if</span> not attached</span><br><span class="line">      --privileged           Give extended privileges to the <span class="built_in">command</span></span><br><span class="line">  -t, --tty                  Allocate a pseudo-TTY</span><br><span class="line">  -u, --user string          Username or UID (format: &lt;name|uid&gt;[:&lt;group|gid&gt;])</span><br><span class="line">  -w, --workdir string       Working directory inside the container</span><br></pre></td></tr></table></figure><p>在帮助中找到tty相关，描述为分配一个伪tty终端。</p></li><li><p>总结<br>TTY是终端设备的统称，来源于Teletypes，或者teletypewriters。the input device is not a TTY 这句话的意思是：<br>后台Linux执行的时候不是终端设备。一般在docker里执行命令的时候都喜欢加上<code>-it</code>这个参数，这个参数表示终端设备，所以<br>Docker执行后台任务或者程序时去掉<code>-it</code>这个参数就可以了。</p></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;在Docker中使用脚本备份MySQL的时候出现一个奇怪的问题，产生的备份文件大小都为零，没有任何数据。但是手动执行脚本文件时候，备份文件中数据是完整的。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;备份脚本如下&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight sh&quot;</summary>
      
    
    
    
    <category term="Linux" scheme="http://falkon.cn/categories/Linux/"/>
    
    
    <category term="Docker" scheme="http://falkon.cn/tags/Docker/"/>
    
    <category term="MySQL" scheme="http://falkon.cn/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>Centos 7.9 安装 Docker</title>
    <link href="http://falkon.cn/2021/02/20/linux/docker-installation-for-centos79/"/>
    <id>http://falkon.cn/2021/02/20/linux/docker-installation-for-centos79/</id>
    <published>2021-02-20T15:02:32.735Z</published>
    <updated>2021-02-20T15:23:50.938Z</updated>
    
    <content type="html"><![CDATA[<ul><li>查看操作系统版本</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@docker-host ~]<span class="comment"># cat /etc/redhat-release </span></span><br><span class="line">CentOS Linux release 7.9.2009 (Core)</span><br></pre></td></tr></table></figure><ul><li>安装yum-utils</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">[root@docker-host ~]<span class="comment"># yum -y install yum-utils</span></span><br><span class="line">Loaded plugins: fastestmirror</span><br><span class="line">Loading mirror speeds from cached hostfile</span><br><span class="line"> * base: mirrors.aliyun.com</span><br><span class="line"> * extras: mirrors.aliyun.com</span><br><span class="line"> * updates: mirrors.aliyun.com</span><br><span class="line">Resolving Dependencies</span><br><span class="line">--&gt; Running transaction check</span><br><span class="line">---&gt; Package yum-utils.noarch 0:1.1.31-54.el7_8 will be installed</span><br><span class="line">--&gt; Processing Dependency: python-kitchen <span class="keyword">for</span> package: yum-utils-1.1.31-54.el7_8.noarch</span><br><span class="line">--&gt; Processing Dependency: libxml2-python <span class="keyword">for</span> package: yum-utils-1.1.31-54.el7_8.noarch</span><br><span class="line">--&gt; Running transaction check</span><br><span class="line">---&gt; Package libxml2-python.x86_64 0:2.9.1-6.el7.5 will be installed</span><br><span class="line">---&gt; Package python-kitchen.noarch 0:1.1.1-5.el7 will be installed</span><br><span class="line">--&gt; Processing Dependency: python-chardet <span class="keyword">for</span> package: python-kitchen-1.1.1-5.el7.noarch</span><br><span class="line">--&gt; Running transaction check</span><br><span class="line">---&gt; Package python-chardet.noarch 0:2.2.1-3.el7 will be installed</span><br><span class="line">--&gt; Finished Dependency Resolution</span><br><span class="line"></span><br><span class="line">Dependencies Resolved</span><br><span class="line"></span><br><span class="line">==================================================================================</span><br><span class="line"> Package                Arch           Version                 Repository    Size</span><br><span class="line">==================================================================================</span><br><span class="line">Installing:</span><br><span class="line"> yum-utils              noarch         1.1.31-54.el7_8         base         122 k</span><br><span class="line">Installing <span class="keyword">for</span> dependencies:</span><br><span class="line"> libxml2-python         x86_64         2.9.1-6.el7.5           base         247 k</span><br><span class="line"> python-chardet         noarch         2.2.1-3.el7             base         227 k</span><br><span class="line"> python-kitchen         noarch         1.1.1-5.el7             base         267 k</span><br><span class="line"></span><br><span class="line">Transaction Summary</span><br><span class="line">==================================================================================</span><br><span class="line">Install  1 Package (+3 Dependent packages)</span><br><span class="line"></span><br><span class="line">Total download size: 863 k</span><br><span class="line">Installed size: 4.3 M</span><br><span class="line">Downloading packages:</span><br><span class="line">Delta RPMs disabled because /usr/bin/applydeltarpm not installed.</span><br><span class="line">(1/4): libxml2-python-2.9.1-6.el7.5.x86_64.rpm             | 247 kB  00:00:00     </span><br><span class="line">(2/4): yum-utils-1.1.31-54.el7_8.noarch.rpm                | 122 kB  00:00:00     </span><br><span class="line">(3/4): python-chardet-2.2.1-3.el7.noarch.rpm               | 227 kB  00:00:00     </span><br><span class="line">(4/4): python-kitchen-1.1.1-5.el7.noarch.rpm               | 267 kB  00:00:00     </span><br><span class="line">----------------------------------------------------------------------------------</span><br><span class="line">Total                                                1.5 MB/s | 863 kB  00:00     </span><br><span class="line">Running transaction check</span><br><span class="line">Running transaction <span class="built_in">test</span></span><br><span class="line">Transaction <span class="built_in">test</span> succeeded</span><br><span class="line">Running transaction</span><br><span class="line">  Installing : python-chardet-2.2.1-3.el7.noarch                              1/4 </span><br><span class="line">  Installing : python-kitchen-1.1.1-5.el7.noarch                              2/4 </span><br><span class="line">  Installing : libxml2-python-2.9.1-6.el7.5.x86_64                            3/4 </span><br><span class="line">  Installing : yum-utils-1.1.31-54.el7_8.noarch                               4/4 </span><br><span class="line">  Verifying  : libxml2-python-2.9.1-6.el7.5.x86_64                            1/4 </span><br><span class="line">  Verifying  : python-kitchen-1.1.1-5.el7.noarch                              2/4 </span><br><span class="line">  Verifying  : yum-utils-1.1.31-54.el7_8.noarch                               3/4 </span><br><span class="line">  Verifying  : python-chardet-2.2.1-3.el7.noarch                              4/4 </span><br><span class="line"></span><br><span class="line">Installed:</span><br><span class="line">  yum-utils.noarch 0:1.1.31-54.el7_8                                              </span><br><span class="line"></span><br><span class="line">Dependency Installed:</span><br><span class="line">  libxml2-python.x86_64 0:2.9.1-6.el7.5    python-chardet.noarch 0:2.2.1-3.el7   </span><br><span class="line">  python-kitchen.noarch 0:1.1.1-5.el7     </span><br><span class="line"></span><br><span class="line">Complete!</span><br></pre></td></tr></table></figure><ul><li>添加阿里的yum（docker）源</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@docker-host ~]<span class="comment"># yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span></span><br><span class="line">Loaded plugins: fastestmirror</span><br><span class="line">adding repo from: http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br><span class="line">grabbing file http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo to /etc/yum.repos.d/docker-ce.repo</span><br><span class="line">repo saved to /etc/yum.repos.d/docker-ce.repo</span><br></pre></td></tr></table></figure><ul><li>更新yum软件包索引</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@docker-host ~]<span class="comment"># yum makecache fast</span></span><br><span class="line">Loaded plugins: fastestmirror</span><br><span class="line">Loading mirror speeds from cached hostfile</span><br><span class="line"> * base: mirrors.aliyun.com</span><br><span class="line"> * extras: mirrors.aliyun.com</span><br><span class="line"> * updates: mirrors.aliyun.com</span><br><span class="line">base                                                       | 3.6 kB  00:00:00     </span><br><span class="line">docker-ce-stable                                           | 3.5 kB  00:00:00     </span><br><span class="line">extras                                                     | 2.9 kB  00:00:00     </span><br><span class="line">updates                                                    | 2.9 kB  00:00:00     </span><br><span class="line">(1/2): docker-ce-stable/7/x86_64/primary_db                |  55 kB  00:00:01     </span><br><span class="line">(2/2): docker-ce-stable/7/x86_64/updateinfo                |   55 B  00:00:02     </span><br><span class="line">Metadata Cache Created</span><br></pre></td></tr></table></figure><ul><li>安装docker</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br></pre></td><td class="code"><pre><span class="line">[root@docker-host ~]<span class="comment"># yum -y install docker-ce docker-ce-cli containerd.io</span></span><br><span class="line">Loaded plugins: fastestmirror</span><br><span class="line">Loading mirror speeds from cached hostfile</span><br><span class="line"> * base: mirrors.aliyun.com</span><br><span class="line"> * extras: mirrors.aliyun.com</span><br><span class="line"> * updates: mirrors.aliyun.com</span><br><span class="line">Resolving Dependencies</span><br><span class="line">--&gt; Running transaction check</span><br><span class="line">---&gt; Package containerd.io.x86_64 0:1.4.3-3.1.el7 will be installed</span><br><span class="line">--&gt; Processing Dependency: container-selinux &gt;= 2:2.74 <span class="keyword">for</span> package: containerd.io-1.4.3-3.1.el7.x86_64</span><br><span class="line">--&gt; Processing Dependency: libseccomp <span class="keyword">for</span> package: containerd.io-1.4.3-3.1.el7.x86_64</span><br><span class="line">---&gt; Package docker-ce.x86_64 3:20.10.3-3.el7 will be installed</span><br><span class="line">--&gt; Processing Dependency: docker-ce-rootless-extras <span class="keyword">for</span> package: 3:docker-ce-20.10.3-3.el7.x86_64</span><br><span class="line">--&gt; Processing Dependency: libcgroup <span class="keyword">for</span> package: 3:docker-ce-20.10.3-3.el7.x86_64</span><br><span class="line">---&gt; Package docker-ce-cli.x86_64 1:20.10.3-3.el7 will be installed</span><br><span class="line">--&gt; Running transaction check</span><br><span class="line">---&gt; Package container-selinux.noarch 2:2.119.2-1.911c772.el7_8 will be installed</span><br><span class="line">--&gt; Processing Dependency: policycoreutils-python <span class="keyword">for</span> package: 2:container-selinux-2.119.2-1.911c772.el7_8.noarch</span><br><span class="line">---&gt; Package docker-ce-rootless-extras.x86_64 0:20.10.3-3.el7 will be installed</span><br><span class="line">--&gt; Processing Dependency: fuse-overlayfs &gt;= 0.7 <span class="keyword">for</span> package: docker-ce-rootless-extras-20.10.3-3.el7.x86_64</span><br><span class="line">--&gt; Processing Dependency: slirp4netns &gt;= 0.4 <span class="keyword">for</span> package: docker-ce-rootless-extras-20.10.3-3.el7.x86_64</span><br><span class="line">---&gt; Package libcgroup.x86_64 0:0.41-21.el7 will be installed</span><br><span class="line">---&gt; Package libseccomp.x86_64 0:2.3.1-4.el7 will be installed</span><br><span class="line">--&gt; Running transaction check</span><br><span class="line">---&gt; Package fuse-overlayfs.x86_64 0:0.7.2-6.el7_8 will be installed</span><br><span class="line">--&gt; Processing Dependency: libfuse3.so.3(FUSE_3.2)(64bit) <span class="keyword">for</span> package: fuse-overlayfs-0.7.2-6.el7_8.x86_64</span><br><span class="line">--&gt; Processing Dependency: libfuse3.so.3(FUSE_3.0)(64bit) <span class="keyword">for</span> package: fuse-overlayfs-0.7.2-6.el7_8.x86_64</span><br><span class="line">--&gt; Processing Dependency: libfuse3.so.3()(64bit) <span class="keyword">for</span> package: fuse-overlayfs-0.7.2-6.el7_8.x86_64</span><br><span class="line">---&gt; Package policycoreutils-python.x86_64 0:2.5-34.el7 will be installed</span><br><span class="line">--&gt; Processing Dependency: setools-libs &gt;= 3.3.8-4 <span class="keyword">for</span> package: policycoreutils-python-2.5-34.el7.x86_64</span><br><span class="line">--&gt; Processing Dependency: libsemanage-python &gt;= 2.5-14 <span class="keyword">for</span> package: policycoreutils-python-2.5-34.el7.x86_64</span><br><span class="line">--&gt; Processing Dependency: audit-libs-python &gt;= 2.1.3-4 <span class="keyword">for</span> package: policycoreutils-python-2.5-34.el7.x86_64</span><br><span class="line">--&gt; Processing Dependency: python-IPy <span class="keyword">for</span> package: policycoreutils-python-2.5-34.el7.x86_64</span><br><span class="line">--&gt; Processing Dependency: libqpol.so.1(VERS_1.4)(64bit) <span class="keyword">for</span> package: policycoreutils-python-2.5-34.el7.x86_64</span><br><span class="line">--&gt; Processing Dependency: libqpol.so.1(VERS_1.2)(64bit) <span class="keyword">for</span> package: policycoreutils-python-2.5-34.el7.x86_64</span><br><span class="line">--&gt; Processing Dependency: libapol.so.4(VERS_4.0)(64bit) <span class="keyword">for</span> package: policycoreutils-python-2.5-34.el7.x86_64</span><br><span class="line">--&gt; Processing Dependency: checkpolicy <span class="keyword">for</span> package: policycoreutils-python-2.5-34.el7.x86_64</span><br><span class="line">--&gt; Processing Dependency: libqpol.so.1()(64bit) <span class="keyword">for</span> package: policycoreutils-python-2.5-34.el7.x86_64</span><br><span class="line">--&gt; Processing Dependency: libapol.so.4()(64bit) <span class="keyword">for</span> package: policycoreutils-python-2.5-34.el7.x86_64</span><br><span class="line">---&gt; Package slirp4netns.x86_64 0:0.4.3-4.el7_8 will be installed</span><br><span class="line">--&gt; Running transaction check</span><br><span class="line">---&gt; Package audit-libs-python.x86_64 0:2.8.5-4.el7 will be installed</span><br><span class="line">---&gt; Package checkpolicy.x86_64 0:2.5-8.el7 will be installed</span><br><span class="line">---&gt; Package fuse3-libs.x86_64 0:3.6.1-4.el7 will be installed</span><br><span class="line">---&gt; Package libsemanage-python.x86_64 0:2.5-14.el7 will be installed</span><br><span class="line">---&gt; Package python-IPy.noarch 0:0.75-6.el7 will be installed</span><br><span class="line">---&gt; Package setools-libs.x86_64 0:3.3.8-4.el7 will be installed</span><br><span class="line">--&gt; Finished Dependency Resolution</span><br><span class="line"></span><br><span class="line">Dependencies Resolved</span><br><span class="line"></span><br><span class="line">==================================================================================</span><br><span class="line"> Package                  Arch   Version                   Repository        Size</span><br><span class="line">==================================================================================</span><br><span class="line">Installing:</span><br><span class="line"> containerd.io            x86_64 1.4.3-3.1.el7             docker-ce-stable  33 M</span><br><span class="line"> docker-ce                x86_64 3:20.10.3-3.el7           docker-ce-stable  27 M</span><br><span class="line"> docker-ce-cli            x86_64 1:20.10.3-3.el7           docker-ce-stable  33 M</span><br><span class="line">Installing <span class="keyword">for</span> dependencies:</span><br><span class="line"> audit-libs-python        x86_64 2.8.5-4.el7               base              76 k</span><br><span class="line"> checkpolicy              x86_64 2.5-8.el7                 base             295 k</span><br><span class="line"> container-selinux        noarch 2:2.119.2-1.911c772.el7_8 extras            40 k</span><br><span class="line"> docker-ce-rootless-extras</span><br><span class="line">                          x86_64 20.10.3-3.el7             docker-ce-stable 9.0 M</span><br><span class="line"> fuse-overlayfs           x86_64 0.7.2-6.el7_8             extras            54 k</span><br><span class="line"> fuse3-libs               x86_64 3.6.1-4.el7               extras            82 k</span><br><span class="line"> libcgroup                x86_64 0.41-21.el7               base              66 k</span><br><span class="line"> libseccomp               x86_64 2.3.1-4.el7               base              56 k</span><br><span class="line"> libsemanage-python       x86_64 2.5-14.el7                base             113 k</span><br><span class="line"> policycoreutils-python   x86_64 2.5-34.el7                base             457 k</span><br><span class="line"> python-IPy               noarch 0.75-6.el7                base              32 k</span><br><span class="line"> setools-libs             x86_64 3.3.8-4.el7               base             620 k</span><br><span class="line"> slirp4netns              x86_64 0.4.3-4.el7_8             extras            81 k</span><br><span class="line"></span><br><span class="line">Transaction Summary</span><br><span class="line">==================================================================================</span><br><span class="line">Install  3 Packages (+13 Dependent packages)</span><br><span class="line"></span><br><span class="line">Total download size: 104 M</span><br><span class="line">Installed size: 428 M</span><br><span class="line">Downloading packages:</span><br><span class="line">(1/16): audit-libs-python-2.8.5-4.el7.x86_64.rpm           |  76 kB  00:00:00     </span><br><span class="line">(2/16): checkpolicy-2.5-8.el7.x86_64.rpm                   | 295 kB  00:00:00     </span><br><span class="line">(3/16): container-selinux-2.119.2-1.911c772.el7_8.noarch.r |  40 kB  00:00:00     </span><br><span class="line">warning: /var/cache/yum/x86_64/7/docker-ce-stable/packages/containerd.io-1.4.3-3.1.el7.x86_64.rpm: Header V4 RSA/SHA512 Signature, key ID 621e9f35: NOKEY</span><br><span class="line">Public key <span class="keyword">for</span> containerd.io-1.4.3-3.1.el7.x86_64.rpm is not installed</span><br><span class="line">(4/16): containerd.io-1.4.3-3.1.el7.x86_64.rpm             |  33 MB  00:00:20     </span><br><span class="line">(5/16): docker-ce-20.10.3-3.el7.x86_64.rpm                 |  27 MB  00:00:25     </span><br><span class="line">(6/16): fuse-overlayfs-0.7.2-6.el7_8.x86_64.rpm            |  54 kB  00:00:00     </span><br><span class="line">(7/16): libcgroup-0.41-21.el7.x86_64.rpm                   |  66 kB  00:00:00     </span><br><span class="line">(8/16): fuse3-libs-3.6.1-4.el7.x86_64.rpm                  |  82 kB  00:00:00     </span><br><span class="line">(9/16): libseccomp-2.3.1-4.el7.x86_64.rpm                  |  56 kB  00:00:00     </span><br><span class="line">(10/16): libsemanage-python-2.5-14.el7.x86_64.rpm          | 113 kB  00:00:00     </span><br><span class="line">(11/16): python-IPy-0.75-6.el7.noarch.rpm                  |  32 kB  00:00:00     </span><br><span class="line">(12/16): policycoreutils-python-2.5-34.el7.x86_64.rpm      | 457 kB  00:00:00     </span><br><span class="line">(13/16): setools-libs-3.3.8-4.el7.x86_64.rpm               | 620 kB  00:00:00     </span><br><span class="line">(14/16): slirp4netns-0.4.3-4.el7_8.x86_64.rpm              |  81 kB  00:00:00     </span><br><span class="line">(15/16): docker-ce-rootless-extras-20.10.3-3.el7.x86_64.rp | 9.0 MB  00:00:04     </span><br><span class="line">(16/16): docker-ce-cli-20.10.3-3.el7.x86_64.rpm            |  33 MB  00:00:09     </span><br><span class="line">----------------------------------------------------------------------------------</span><br><span class="line">Total                                                3.4 MB/s | 104 MB  00:30     </span><br><span class="line">Retrieving key from https://download.docker.com/linux/centos/gpg</span><br><span class="line">Importing GPG key 0x621E9F35:</span><br><span class="line"> Userid     : <span class="string">"Docker Release (CE rpm) &lt;docker@docker.com&gt;"</span></span><br><span class="line"> Fingerprint: 060a 61c5 1b55 8a7f 742b 77aa c52f eb6b 621e 9f35</span><br><span class="line"> From       : https://download.docker.com/linux/centos/gpg</span><br><span class="line">Running transaction check</span><br><span class="line">Running transaction <span class="built_in">test</span></span><br><span class="line">Transaction <span class="built_in">test</span> succeeded</span><br><span class="line">Running transaction</span><br><span class="line">  Installing : libseccomp-2.3.1-4.el7.x86_64                                 1/16 </span><br><span class="line">  Installing : libcgroup-0.41-21.el7.x86_64                                  2/16 </span><br><span class="line">  Installing : slirp4netns-0.4.3-4.el7_8.x86_64                              3/16 </span><br><span class="line">  Installing : 1:docker-ce-cli-20.10.3-3.el7.x86_64                          4/16 </span><br><span class="line">  Installing : setools-libs-3.3.8-4.el7.x86_64                               5/16 </span><br><span class="line">  Installing : audit-libs-python-2.8.5-4.el7.x86_64                          6/16 </span><br><span class="line">  Installing : python-IPy-0.75-6.el7.noarch                                  7/16 </span><br><span class="line">  Installing : libsemanage-python-2.5-14.el7.x86_64                          8/16 </span><br><span class="line">  Installing : fuse3-libs-3.6.1-4.el7.x86_64                                 9/16 </span><br><span class="line">  Installing : fuse-overlayfs-0.7.2-6.el7_8.x86_64                          10/16 </span><br><span class="line">  Installing : checkpolicy-2.5-8.el7.x86_64                                 11/16 </span><br><span class="line">  Installing : policycoreutils-python-2.5-34.el7.x86_64                     12/16 </span><br><span class="line">  Installing : 2:container-selinux-2.119.2-1.911c772.el7_8.noarch           13/16 </span><br><span class="line">  Installing : containerd.io-1.4.3-3.1.el7.x86_64                           14/16 </span><br><span class="line">  Installing : docker-ce-rootless-extras-20.10.3-3.el7.x86_64               15/16 </span><br><span class="line">  Installing : 3:docker-ce-20.10.3-3.el7.x86_64                             16/16 </span><br><span class="line">  Verifying  : checkpolicy-2.5-8.el7.x86_64                                  1/16 </span><br><span class="line">  Verifying  : fuse3-libs-3.6.1-4.el7.x86_64                                 2/16 </span><br><span class="line">  Verifying  : 3:docker-ce-20.10.3-3.el7.x86_64                              3/16 </span><br><span class="line">  Verifying  : fuse-overlayfs-0.7.2-6.el7_8.x86_64                           4/16 </span><br><span class="line">  Verifying  : libsemanage-python-2.5-14.el7.x86_64                          5/16 </span><br><span class="line">  Verifying  : slirp4netns-0.4.3-4.el7_8.x86_64                              6/16 </span><br><span class="line">  Verifying  : 2:container-selinux-2.119.2-1.911c772.el7_8.noarch            7/16 </span><br><span class="line">  Verifying  : python-IPy-0.75-6.el7.noarch                                  8/16 </span><br><span class="line">  Verifying  : libseccomp-2.3.1-4.el7.x86_64                                 9/16 </span><br><span class="line">  Verifying  : containerd.io-1.4.3-3.1.el7.x86_64                           10/16 </span><br><span class="line">  Verifying  : policycoreutils-python-2.5-34.el7.x86_64                     11/16 </span><br><span class="line">  Verifying  : docker-ce-rootless-extras-20.10.3-3.el7.x86_64               12/16 </span><br><span class="line">  Verifying  : audit-libs-python-2.8.5-4.el7.x86_64                         13/16 </span><br><span class="line">  Verifying  : setools-libs-3.3.8-4.el7.x86_64                              14/16 </span><br><span class="line">  Verifying  : 1:docker-ce-cli-20.10.3-3.el7.x86_64                         15/16 </span><br><span class="line">  Verifying  : libcgroup-0.41-21.el7.x86_64                                 16/16 </span><br><span class="line"></span><br><span class="line">Installed:</span><br><span class="line">  containerd.io.x86_64 0:1.4.3-3.1.el7      docker-ce.x86_64 3:20.10.3-3.el7     </span><br><span class="line">  docker-ce-cli.x86_64 1:20.10.3-3.el7     </span><br><span class="line"></span><br><span class="line">Dependency Installed:</span><br><span class="line">  audit-libs-python.x86_64 0:2.8.5-4.el7                                          </span><br><span class="line">  checkpolicy.x86_64 0:2.5-8.el7                                                  </span><br><span class="line">  container-selinux.noarch 2:2.119.2-1.911c772.el7_8                              </span><br><span class="line">  docker-ce-rootless-extras.x86_64 0:20.10.3-3.el7                                </span><br><span class="line">  fuse-overlayfs.x86_64 0:0.7.2-6.el7_8                                           </span><br><span class="line">  fuse3-libs.x86_64 0:3.6.1-4.el7                                                 </span><br><span class="line">  libcgroup.x86_64 0:0.41-21.el7                                                  </span><br><span class="line">  libseccomp.x86_64 0:2.3.1-4.el7                                                 </span><br><span class="line">  libsemanage-python.x86_64 0:2.5-14.el7                                          </span><br><span class="line">  policycoreutils-python.x86_64 0:2.5-34.el7                                      </span><br><span class="line">  python-IPy.noarch 0:0.75-6.el7                                                  </span><br><span class="line">  setools-libs.x86_64 0:3.3.8-4.el7                                               </span><br><span class="line">  slirp4netns.x86_64 0:0.4.3-4.el7_8                                              </span><br><span class="line"></span><br><span class="line">Complete!</span><br></pre></td></tr></table></figure><ul><li>启动docker</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@docker-host ~]<span class="comment"># systemctl start docker</span></span><br></pre></td></tr></table></figure><ul><li>查看docker服务的状态</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[root@docker-host ~]<span class="comment"># systemctl status docker</span></span><br><span class="line">● docker.service - Docker Application Container Engine</span><br><span class="line">   Loaded: loaded (/usr/lib/systemd/system/docker.service; disabled; vendor preset: disabled)</span><br><span class="line">   Active: active (running) since Sat 2021-02-20 20:06:57 CST; 10s ago</span><br><span class="line">     Docs: https://docs.docker.com</span><br><span class="line"> Main PID: 1833 (dockerd)</span><br><span class="line">    Tasks: 8</span><br><span class="line">   Memory: 43.0M</span><br><span class="line">   CGroup: /system.slice/docker.service</span><br><span class="line">           └─1833 /usr/bin/dockerd -H fd:// --containerd=/run/containerd/contai...</span><br><span class="line"></span><br><span class="line">Feb 20 20:06:57 docker-host dockerd[1833]: time=<span class="string">"2021-02-20T20:06:57.564408982...c</span></span><br><span class="line"><span class="string">Feb 20 20:06:57 docker-host dockerd[1833]: time="</span>2021-02-20T20:06:57.564424867...c</span><br><span class="line">Feb 20 20:06:57 docker-host dockerd[1833]: time=<span class="string">"2021-02-20T20:06:57.564434731...c</span></span><br><span class="line"><span class="string">Feb 20 20:06:57 docker-host dockerd[1833]: time="</span>2021-02-20T20:06:57.587687027...<span class="string">"</span></span><br><span class="line"><span class="string">Feb 20 20:06:57 docker-host dockerd[1833]: time="</span>2021-02-20T20:06:57.701550790...<span class="string">"</span></span><br><span class="line"><span class="string">Feb 20 20:06:57 docker-host dockerd[1833]: time="</span>2021-02-20T20:06:57.745648406...<span class="string">"</span></span><br><span class="line"><span class="string">Feb 20 20:06:57 docker-host dockerd[1833]: time="</span>2021-02-20T20:06:57.758999502...3</span><br><span class="line">Feb 20 20:06:57 docker-host dockerd[1833]: time=<span class="string">"2021-02-20T20:06:57.759132059..."</span></span><br><span class="line">Feb 20 20:06:57 docker-host systemd[1]: Started Docker Application Container ...e.</span><br><span class="line">Feb 20 20:06:57 docker-host dockerd[1833]: time=<span class="string">"2021-02-20T20:06:57.793207055..."</span></span><br><span class="line">Hint: Some lines were ellipsized, use -l to show <span class="keyword">in</span> full.</span><br></pre></td></tr></table></figure><ul><li>添加开机启动</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@docker-host ~]<span class="comment"># systemctl enable docker</span></span><br><span class="line">Created symlink from /etc/systemd/system/multi-user.target.wants/docker.service to /usr/lib/systemd/system/docker.service.</span><br></pre></td></tr></table></figure><ul><li>查看docker版本</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">[root@docker-host ~]<span class="comment"># docker version</span></span><br><span class="line">Client: Docker Engine - Community</span><br><span class="line"> Version:           20.10.3</span><br><span class="line"> API version:       1.41</span><br><span class="line"> Go version:        go1.13.15</span><br><span class="line"> Git commit:        48d30b5</span><br><span class="line"> Built:             Fri Jan 29 14:34:14 2021</span><br><span class="line"> OS/Arch:           linux/amd64</span><br><span class="line"> Context:           default</span><br><span class="line"> Experimental:      <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">Server: Docker Engine - Community</span><br><span class="line"> Engine:</span><br><span class="line">  Version:          20.10.3</span><br><span class="line">  API version:      1.41 (minimum version 1.12)</span><br><span class="line">  Go version:       go1.13.15</span><br><span class="line">  Git commit:       46229ca</span><br><span class="line">  Built:            Fri Jan 29 14:32:37 2021</span><br><span class="line">  OS/Arch:          linux/amd64</span><br><span class="line">  Experimental:     <span class="literal">false</span></span><br><span class="line"> containerd:</span><br><span class="line">  Version:          1.4.3</span><br><span class="line">  GitCommit:        269548fa27e0089a8b8278fc4fc781d7f65a939b</span><br><span class="line"> runc:</span><br><span class="line">  Version:          1.0.0-rc92</span><br><span class="line">  GitCommit:        ff819c7e9184c13b7c2607fe6c30ae19403a7aff</span><br><span class="line"> docker-init:</span><br><span class="line">  Version:          0.19.0</span><br><span class="line">  GitCommit:        de40ad0</span><br></pre></td></tr></table></figure><ul><li>修改或新增docker镜像源</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@docker-host docker]<span class="comment"># vi  /etc/docker/daemon.json</span></span><br><span class="line">[root@docker-host docker]<span class="comment"># cat /etc/docker/daemon.json </span></span><br><span class="line">&#123;</span><br><span class="line"><span class="string">"registry-mirrors"</span>: [<span class="string">"https://bytkgxyr.mirror.aliyuncs.com"</span>,<span class="string">"https://registry.docker-cn.com"</span>,<span class="string">"http://hub-mirror.c.163.com"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>测试docker</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[root@docker-host docker]<span class="comment"># docker run hello-world</span></span><br><span class="line">Unable to find image <span class="string">'hello-world:latest'</span> locally</span><br><span class="line">latest: Pulling from library/hello-world</span><br><span class="line">Digest: sha256:31b9c7d48790f0d8c50ab433d9c3b7e17666d6993084c002c2ff1ca09b96391d</span><br><span class="line">Status: Downloaded newer image <span class="keyword">for</span> hello-world:latest</span><br><span class="line"></span><br><span class="line">Hello from Docker!</span><br><span class="line">This message shows that your installation appears to be working correctly.</span><br><span class="line"></span><br><span class="line">To generate this message, Docker took the following steps:</span><br><span class="line"> 1. The Docker client contacted the Docker daemon.</span><br><span class="line"> 2. The Docker daemon pulled the <span class="string">"hello-world"</span> image from the Docker Hub.</span><br><span class="line">    (amd64)</span><br><span class="line"> 3. The Docker daemon created a new container from that image <span class="built_in">which</span> runs the</span><br><span class="line">    executable that produces the output you are currently reading.</span><br><span class="line"> 4. The Docker daemon streamed that output to the Docker client, <span class="built_in">which</span> sent it</span><br><span class="line">    to your terminal.</span><br><span class="line"></span><br><span class="line">To try something more ambitious, you can run an Ubuntu container with:</span><br><span class="line"> $ docker run -it ubuntu bash</span><br><span class="line"></span><br><span class="line">Share images, automate workflows, and more with a free Docker ID:</span><br><span class="line"> https://hub.docker.com/</span><br><span class="line"></span><br><span class="line">For more examples and ideas, visit:</span><br><span class="line"> https://docs.docker.com/get-started/</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;ul&gt;
&lt;li&gt;查看操作系统版本&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight sh&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;lin</summary>
      
    
    
    
    <category term="Linux" scheme="http://falkon.cn/categories/Linux/"/>
    
    
    <category term="Docker" scheme="http://falkon.cn/tags/Docker/"/>
    
  </entry>
  
  <entry>
    <title>ZABBIX SERVER IS NOT RENNING THE INFORMATION DISPLAYED MAY NOT BE CORRECT</title>
    <link href="http://falkon.cn/2021/01/27/linux/zabbix50-server-is-not-running/"/>
    <id>http://falkon.cn/2021/01/27/linux/zabbix50-server-is-not-running/</id>
    <published>2021-01-27T09:37:22.776Z</published>
    <updated>2021-01-27T03:17:30.107Z</updated>
    
    <content type="html"><![CDATA[<p>Zabbix 5.0 启动后总是弹出ZABBIX SERVER IS NOT RENNING: THE INFORMATION DISPLAYED MAY NOT BE CORRECT，服务器上的zabbix_server和zabbix_client状态都正常，根据网上的资料应该是selinux没有关闭，仔细查看才发现Linux 6.x和Linux 7.x的selinux永久关闭的配置文件的路径时不一样的，处理完错误后赶紧写个操作记录供大家参考学习。</p><a id="more"></a><ul><li>查看队列显示如下错误</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">connection to Zabbix server <span class="string">"localhost"</span> failed. Possible reasons:</span><br><span class="line">1. incorrect server IP/DNS <span class="keyword">in</span> the <span class="string">"zabbix.conf.php"</span>;</span><br><span class="line">2. incorrect DNS server configuration.</span><br><span class="line">Permission denied</span><br></pre></td></tr></table></figure><ul><li>查看操作系统版本</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@pe-sysmonitor-zabbix ~]<span class="comment"># cat /etc/redhat-release </span></span><br><span class="line">CentOS Linux release 8.1.1911 (Core)</span><br></pre></td></tr></table></figure><ul><li>查看Zabbix版本</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@pe-sysmonitor-zabbix ~]<span class="comment"># /usr/local/zabbix/sbin/zabbix_server -V</span></span><br><span class="line">zabbix_server (Zabbix) 5.0.1</span><br><span class="line">Revision c2a0b03480 25 May 2020, compilation time: Jun 10 2020 22:18:13</span><br><span class="line"></span><br><span class="line">Copyright (C) 2020 Zabbix SIA</span><br><span class="line">License GPLv2+: GNU GPL version 2 or later &lt;http://gnu.org/licenses/gpl.html&gt;.</span><br><span class="line">This is free software: you are free to change and redistribute it according to</span><br><span class="line">the license. There is NO WARRANTY, to the extent permitted by law.</span><br></pre></td></tr></table></figure><ul><li>查看selinux状态</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@pe-sysmonitor-zabbix ~]<span class="comment"># getenforce </span></span><br><span class="line">enforcing</span><br></pre></td></tr></table></figure><ul><li>关闭selinux并重启</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 注意：selinux从7.x往后的永久修改关闭的文件跟6.x有很大的却别，6.x关闭的文件为/etc/sysconfig/selinux，而7.x及以后的版本修改的文件为/etc/selinux/config</span></span><br><span class="line">[root@pe-sysmonitor-zabbix ~]<span class="comment"># vi /etc/selinux/config #SELINUX=disabled</span></span><br><span class="line">[root@pe-sysmonitor-zabbix ~]<span class="comment"># reboot</span></span><br><span class="line">[root@pe-sysmonitor-zabbix ~]<span class="comment"># getenforce </span></span><br><span class="line">Disabled</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;Zabbix 5.0 启动后总是弹出ZABBIX SERVER IS NOT RENNING: THE INFORMATION DISPLAYED MAY NOT BE CORRECT，服务器上的zabbix_server和zabbix_client状态都正常，根据网上的资料应该是selinux没有关闭，仔细查看才发现Linux 6.x和Linux 7.x的selinux永久关闭的配置文件的路径时不一样的，处理完错误后赶紧写个操作记录供大家参考学习。&lt;/p&gt;</summary>
    
    
    
    <category term="DevOps" scheme="http://falkon.cn/categories/DevOps/"/>
    
    
    <category term="Zabbix" scheme="http://falkon.cn/tags/Zabbix/"/>
    
  </entry>
  
  <entry>
    <title>Zabbix 5.0 编译安装</title>
    <link href="http://falkon.cn/2021/01/27/linux/zabbix50-compile-installation/"/>
    <id>http://falkon.cn/2021/01/27/linux/zabbix50-compile-installation/</id>
    <published>2021-01-27T09:37:22.770Z</published>
    <updated>2021-01-27T03:17:11.605Z</updated>
    
    <content type="html"><![CDATA[<ul><li>平台：Oracle Linux 7.8</li><li>数据库：MySQL 8.0</li><li>中间件：Apache 2.4</li><li>PHP：PHP 7.2</li></ul><a id="more"></a><ul><li><p>关闭SELINUX</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@pe-sysmonitor-zabbix ~]<span class="comment"># sed -i 's/SELINUX=enforcing/SELINUX=disabled/' /etc/sysconfig/selinux</span></span><br></pre></td></tr></table></figure></li><li><p>关闭防火墙</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@pe-sysmonitor-zabbix ~]<span class="comment"># systemctl disable --now firewalld</span></span><br></pre></td></tr></table></figure></li><li><p>安装LAMP</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@pe-sysmonitor-zabbix ~]<span class="comment"># dnf install -y httpd php php-gd php-ldap php-mysqlnd php-json php-bcmath php-mbstring php-xml mysql mysql-server mysql-devel libevent-devel pcre-devel gcc gcc-c++ make libcurl-devel curl-* net-snmp* libxml2-* wget tar</span></span><br></pre></td></tr></table></figure></li><li><p>启动相关组件并设置为开机启动</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@pe-sysmonitor-zabbix ~]<span class="comment"># systemctl enable --now httpd mysqlnd php-fpm</span></span><br><span class="line">[root@pe-sysmonitor-zabbix ~]<span class="comment"># systemctl start httpd mysqld php-fpm</span></span><br></pre></td></tr></table></figure></li><li><p>解压并编译Zabbix5.0源码</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@pe-sysmonitor-zabbix ~]<span class="comment"># tar -zxvf /opt/zabbix-5.0.1.tar.gz</span></span><br><span class="line">[root@pe-sysmonitor-zabbix ~]<span class="comment"># cd /opt/zabbix-5.0.1</span></span><br><span class="line">[root@pe-sysmonitor-zabbix ~]<span class="comment"># /configure --prefix=/usr/local/zabbix --enable-server --enable-agent --with-mysql  --with-net-snmp --with-libcurl --with-libxml2</span></span><br></pre></td></tr></table></figure></li><li><p>登录mysql数据库，建立zabbix数据库用户等相关信息，先安装的数据为mysql8.0，直接root用户可登录</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">[root@pe-sysmonitor-zabbix mysql]<span class="comment"># mysql -u root</span></span><br><span class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</span><br><span class="line">Your MySQL connection id is 8</span><br><span class="line">Server version: 8.0.17 Source distribution</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2019, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type <span class="string">'help;'</span> or <span class="string">'\h'</span> <span class="keyword">for</span> <span class="built_in">help</span>. Type <span class="string">'\c'</span> to clear the current input statement.</span><br><span class="line"></span><br><span class="line">mysql&gt; show databases;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| sys                |</span><br><span class="line">+--------------------+</span><br><span class="line">4 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; </span><br><span class="line">mysql&gt; </span><br><span class="line">mysql&gt; </span><br><span class="line">mysql&gt; create database zabbix character <span class="built_in">set</span> utf8 collate utf8_bin;</span><br><span class="line">Query OK, 1 row affected, 2 warnings (0.06 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; create user zabbix@localhost identified by <span class="string">'welcome1'</span>;</span><br><span class="line">Query OK, 0 rows affected (0.04 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; grant all privileges on zabbix.* to zabbix@localhost;</span><br><span class="line">Query OK, 0 rows affected (0.02 sec) </span><br><span class="line">mysql&gt; quit</span><br></pre></td></tr></table></figure></li><li><p>按顺序导入sql</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@pe-sysmonitor-zabbix ~]<span class="comment"># mysql -u zabbix -p zabbix &lt; /opt/zabbix-5.0.1/database/mysql/schema.sql</span></span><br><span class="line">[root@pe-sysmonitor-zabbix ~]<span class="comment"># mysql -u zabbix -p zabbix &lt; /opt/zabbix-5.0.1/database/mysql/images.sql</span></span><br><span class="line">[root@pe-sysmonitor-zabbix ~]<span class="comment"># mysql -u zabbix -p zabbix &lt; /opt/zabbix-5.0.1/database/mysql/data.sql</span></span><br></pre></td></tr></table></figure></li><li><p>修改zabbix server配置文件的数据库密码，配置文件位置：/usr/local/zabbix/etc/zabbix_server.conf</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">DBPassword=welcome1</span><br><span class="line">...</span><br></pre></td></tr></table></figure></li><li><p>为zabbix server添加systemd启动文件</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">vi /lib/systemd/system/zabbix-server.service</span><br><span class="line">[Unit]</span><br><span class="line">Description=Zabbix Server</span><br><span class="line">After=syslog.target</span><br><span class="line">After=network.target</span><br><span class="line">After=mysql.service</span><br><span class="line">After=mysqld.service</span><br><span class="line">After=mariadb.service</span><br><span class="line">After=postgresql.service</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Environment=<span class="string">"CONFFILE=/usr/local/zabbix/etc/zabbix_server.conf"</span></span><br><span class="line">EnvironmentFile=-/etc/sysconfig/zabbix-server</span><br><span class="line">Type=forking</span><br><span class="line">Restart=on-failure</span><br><span class="line">PIDFile=/tmp/zabbix_server.pid</span><br><span class="line">KillMode=control-group</span><br><span class="line">ExecStart=/usr/<span class="built_in">local</span>/zabbix/sbin/zabbix_server -c <span class="variable">$CONFFILE</span></span><br><span class="line">ExecStop=/bin/<span class="built_in">kill</span> -SIGTERM <span class="variable">$MAINPID</span></span><br><span class="line">RestartSec=10s</span><br><span class="line">TimeoutSec=0</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure></li><li><p>为zabbix agent添加systemd启动文件</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">vi /lib/systemd/system/zabbix-agent.service</span><br><span class="line">[Unit]</span><br><span class="line">Description=Zabbix Agent</span><br><span class="line">After=syslog.target</span><br><span class="line">After=network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Environment=<span class="string">"CONFFILE=/usr/local/zabbix/etc/zabbix_agentd.conf"</span></span><br><span class="line">EnvironmentFile=-/etc/sysconfig/zabbix-agent</span><br><span class="line">Type=forking</span><br><span class="line">Restart=on-failure</span><br><span class="line">PIDFile=/tmp/zabbix_agentd.pid</span><br><span class="line">KillMode=control-group</span><br><span class="line">ExecStart=/usr/<span class="built_in">local</span>/zabbix/sbin/zabbix_agentd -c <span class="variable">$CONFFILE</span></span><br><span class="line">ExecStop=/bin/<span class="built_in">kill</span> -SIGTERM <span class="variable">$MAINPID</span></span><br><span class="line">RestartSec=10s</span><br><span class="line">User=zabbix</span><br><span class="line">Group=zabbix</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure></li><li><p>设置为开机启动并启动zabbix server和zabbix agent</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[root@pe-sysmonitor-zabbix ~]<span class="comment"># systemctl enable --now zabbix-server</span></span><br><span class="line">[root@pe-sysmonitor-zabbix ~]<span class="comment"># systemctl enable --now zabbix-agent</span></span><br><span class="line">[root@pe-sysmonitor-zabbix ~]<span class="comment"># systemctl start zabbix-server</span></span><br><span class="line">[root@pe-sysmonitor-zabbix ~]<span class="comment"># systemctl start zabbix-agent</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 观察/tmp/zabbix_server.log有无错误，如果出现如下错误需要对zabbix用户增加授权</span></span><br><span class="line"><span class="comment"># mysql&gt; grant SUPER,SESSION_VARIABLES_ADMIN on *.* to 'zabbix'@'localhost';</span></span><br><span class="line">865:20200610:225723.864 Starting Zabbix Server. Zabbix 5.0.1 (revision c2a0b03480).</span><br><span class="line">865:20200610:225723.864 ****** Enabled features ******</span><br><span class="line">865:20200610:225723.864 SNMP monitoring:           YES</span><br><span class="line">865:20200610:225723.864 IPMI monitoring:            NO</span><br><span class="line">865:20200610:225723.864 Web monitoring:            YES</span><br><span class="line">865:20200610:225723.864 VMware monitoring:         YES</span><br><span class="line">865:20200610:225723.864 SMTP authentication:       YES</span><br><span class="line">865:20200610:225723.864 ODBC:                       NO</span><br><span class="line">865:20200610:225723.864 SSH support:                NO</span><br><span class="line">865:20200610:225723.864 IPv6 support:               NO</span><br><span class="line">865:20200610:225723.864 TLS support:                NO</span><br><span class="line">865:20200610:225723.864 ******************************</span><br><span class="line">865:20200610:225723.864 using configuration file: /usr/<span class="built_in">local</span>/zabbix/etc/zabbix_server.conf</span><br><span class="line">865:20200610:225723.870 [Z3001] connection to database <span class="string">'zabbix'</span> failed: [1227] Access denied; you need (at least one of) the SUPER, SYSTEM_VARIABLES_ADMIN or SESSION_VARIABLES_ADMIN privilege(s) <span class="keyword">for</span> this operation</span><br><span class="line">865:20200610:225723.870 Cannot connect to the database. Exiting...</span><br></pre></td></tr></table></figure></li><li><p>检查zabbix server的启动状态</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">[root@pe-sysmonitor-zabbix ~]<span class="comment"># systemctl status zabbix-server</span></span><br><span class="line">● zabbix-server.service - Zabbix Server</span><br><span class="line">   Loaded: loaded (/usr/lib/systemd/system/zabbix-server.service; enabled; vendor preset: disabled)</span><br><span class="line">   Active: active (running) since Wed 2020-06-10 22:59:57 CST; 11h ago</span><br><span class="line">  Process: 926 ExecStart=/usr/<span class="built_in">local</span>/zabbix/sbin/zabbix_server -c <span class="variable">$CONFFILE</span> (code=exited, status=0/SUCCESS)</span><br><span class="line"> Main PID: 928 (zabbix_server)</span><br><span class="line">    Tasks: 38 (<span class="built_in">limit</span>: 23588)</span><br><span class="line">   Memory: 47.8M</span><br><span class="line">   CGroup: /system.slice/zabbix-server.service</span><br><span class="line">           ├─928 /usr/<span class="built_in">local</span>/zabbix/sbin/zabbix_server -c /usr/<span class="built_in">local</span>/zabbix/etc/zabbix_server.conf</span><br><span class="line">           ├─929 /usr/<span class="built_in">local</span>/zabbix/sbin/zabbix_server: configuration syncer [synced configuration <span class="keyword">in</span> 0.036692 sec, idle 60 sec]</span><br><span class="line">           ├─930 /usr/<span class="built_in">local</span>/zabbix/sbin/zabbix_server: housekeeper [deleted 60 hist/trends, 0 items/triggers, 0 events, 0 sessions, 0 alarms, 0 audit items, 0 records <span class="keyword">in</span> 0.034538 sec, id&gt;</span><br><span class="line">           ├─931 /usr/<span class="built_in">local</span>/zabbix/sbin/zabbix_server: timer <span class="comment">#1 [updated 0 hosts, suppressed 0 events in 0.000782 sec, idle 59 sec]</span></span><br><span class="line">           ├─932 /usr/<span class="built_in">local</span>/zabbix/sbin/zabbix_server: http poller <span class="comment">#1 [got 0 values in 0.000887 sec, idle 5 sec]</span></span><br><span class="line">           ├─933 /usr/<span class="built_in">local</span>/zabbix/sbin/zabbix_server: discoverer <span class="comment">#1 [processed 0 rules in 0.000880 sec, idle 60 sec]</span></span><br><span class="line">           ├─934 /usr/<span class="built_in">local</span>/zabbix/sbin/zabbix_server: <span class="built_in">history</span> syncer <span class="comment">#1 [processed 0 values, 0 triggers in 0.000036 sec, idle 1 sec]</span></span><br><span class="line">           ├─935 /usr/<span class="built_in">local</span>/zabbix/sbin/zabbix_server: <span class="built_in">history</span> syncer <span class="comment">#2 [processed 0 values, 0 triggers in 0.000049 sec, idle 1 sec]</span></span><br><span class="line">           ├─936 /usr/<span class="built_in">local</span>/zabbix/sbin/zabbix_server: <span class="built_in">history</span> syncer <span class="comment">#3 [processed 0 values, 0 triggers in 0.000027 sec, idle 1 sec]</span></span><br><span class="line">           ├─937 /usr/<span class="built_in">local</span>/zabbix/sbin/zabbix_server: <span class="built_in">history</span> syncer <span class="comment">#4 [processed 0 values, 0 triggers in 0.000030 sec, idle 1 sec]</span></span><br><span class="line">           ├─938 /usr/<span class="built_in">local</span>/zabbix/sbin/zabbix_server: escalator <span class="comment">#1 [processed 0 escalations in 0.001530 sec, idle 3 sec]</span></span><br><span class="line">           ├─939 /usr/<span class="built_in">local</span>/zabbix/sbin/zabbix_server: proxy poller <span class="comment">#1 [exchanged data with 0 proxies in 0.000028 sec, idle 5 sec]</span></span><br><span class="line">           ├─940 /usr/<span class="built_in">local</span>/zabbix/sbin/zabbix_server: self-monitoring [processed data <span class="keyword">in</span> 0.000035 sec, idle 1 sec]</span><br><span class="line">           ├─941 /usr/<span class="built_in">local</span>/zabbix/sbin/zabbix_server: task manager [processed 0 task(s) <span class="keyword">in</span> 0.000552 sec, idle 5 sec]</span><br><span class="line">           ├─942 /usr/<span class="built_in">local</span>/zabbix/sbin/zabbix_server: poller <span class="comment">#1 [got 0 values in 0.000041 sec, idle 1 sec]</span></span><br><span class="line">           ├─943 /usr/<span class="built_in">local</span>/zabbix/sbin/zabbix_server: poller <span class="comment">#2 [got 1 values in 0.000554 sec, idle 1 sec]</span></span><br><span class="line">           ├─944 /usr/<span class="built_in">local</span>/zabbix/sbin/zabbix_server: poller <span class="comment">#3 [got 0 values in 0.000038 sec, idle 1 sec]</span></span><br><span class="line">           ├─945 /usr/<span class="built_in">local</span>/zabbix/sbin/zabbix_server: poller <span class="comment">#4 [got 0 values in 0.000022 sec, idle 1 sec]</span></span><br><span class="line">           ├─946 /usr/<span class="built_in">local</span>/zabbix/sbin/zabbix_server: poller <span class="comment">#5 [got 0 values in 0.000022 sec, idle 1 sec]</span></span><br><span class="line">           ├─947 /usr/<span class="built_in">local</span>/zabbix/sbin/zabbix_server: unreachable poller <span class="comment">#1 [got 0 values in 0.000020 sec, idle 5 sec]</span></span><br><span class="line">           ├─948 /usr/<span class="built_in">local</span>/zabbix/sbin/zabbix_server: trapper <span class="comment">#1 [processed data in 0.000532 sec, waiting for connection]</span></span><br><span class="line">           ├─949 /usr/<span class="built_in">local</span>/zabbix/sbin/zabbix_server: trapper <span class="comment">#2 [processed data in 0.000589 sec, waiting for connection]</span></span><br><span class="line">           ├─950 /usr/<span class="built_in">local</span>/zabbix/sbin/zabbix_server: trapper <span class="comment">#3 [processed data in 0.000450 sec, waiting for connection]</span></span><br><span class="line">           ├─951 /usr/<span class="built_in">local</span>/zabbix/sbin/zabbix_server: trapper <span class="comment">#4 [processed data in 0.000663 sec, waiting for connection]</span></span><br><span class="line">           ├─952 /usr/<span class="built_in">local</span>/zabbix/sbin/zabbix_server: trapper <span class="comment">#5 [processed data in 0.000391 sec, waiting for connection]</span></span><br><span class="line">           ├─953 /usr/<span class="built_in">local</span>/zabbix/sbin/zabbix_server: icmp pinger <span class="comment">#1 [got 0 values in 0.000022 sec, idle 5 sec]</span></span><br><span class="line">           ├─954 /usr/<span class="built_in">local</span>/zabbix/sbin/zabbix_server: alert manager <span class="comment">#1 [sent 0, failed 0 alerts, idle 5.005964 sec during 5.006082 sec]</span></span><br><span class="line">           ├─955 /usr/<span class="built_in">local</span>/zabbix/sbin/zabbix_server: alerter <span class="comment">#1 started</span></span><br><span class="line">           ├─956 /usr/<span class="built_in">local</span>/zabbix/sbin/zabbix_server: alerter <span class="comment">#2 started</span></span><br><span class="line">           ├─957 /usr/<span class="built_in">local</span>/zabbix/sbin/zabbix_server: alerter <span class="comment">#3 started</span></span><br><span class="line">           ├─958 /usr/<span class="built_in">local</span>/zabbix/sbin/zabbix_server: preprocessing manager <span class="comment">#1 [queued 0, processed 6 values, idle 5.002700 sec during 5.002968 sec]</span></span><br><span class="line">           ├─959 /usr/<span class="built_in">local</span>/zabbix/sbin/zabbix_server: preprocessing worker <span class="comment">#1 started</span></span><br><span class="line">           ├─960 /usr/<span class="built_in">local</span>/zabbix/sbin/zabbix_server: preprocessing worker <span class="comment">#2 started</span></span><br><span class="line">           ├─961 /usr/<span class="built_in">local</span>/zabbix/sbin/zabbix_server: preprocessing worker <span class="comment">#3 started</span></span><br><span class="line">           ├─962 /usr/<span class="built_in">local</span>/zabbix/sbin/zabbix_server: lld manager <span class="comment">#1 [processed 0 LLD rules during 5.004781 sec]</span></span><br><span class="line">           ├─963 /usr/<span class="built_in">local</span>/zabbix/sbin/zabbix_server: lld worker <span class="comment">#1 [processed 1 LLD rules, idle 3598.022039 sec during 3598.152512 sec]</span></span><br></pre></td></tr></table></figure></li><li><p>拷贝zabbix的前端文件到apache默认的web目录，进行前端安装</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@pe-sysmonitor-zabbix ~]<span class="comment"># cp -r /opt/zabbix-5.0.0/ui/* /var/www/html/</span></span><br><span class="line">[root@pe-sysmonitor-zabbix ~]<span class="comment"># chown -R apache:apache /var/www/html/</span></span><br></pre></td></tr></table></figure></li><li><p>配置php参数</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@pe-sysmonitor-zabbix ~]<span class="comment"># sed -i 's#post_max_size = 8M#post_max_size = 16M#' /etc/php.ini</span></span><br><span class="line">[root@pe-sysmonitor-zabbix ~]<span class="comment"># sed -i 's#max_execution_time = 30#max_execution_time = 300#' /etc/php.ini</span></span><br><span class="line">[root@pe-sysmonitor-zabbix ~]<span class="comment"># sed -i 's#max_input_time = 60#max_input_time = 300#' /etc/php.ini</span></span><br><span class="line">[root@pe-sysmonitor-zabbix ~]<span class="comment"># sed -i 's#;date.timezone =#date.timezone = Asia/Shanghai#' /etc/php.ini</span></span><br><span class="line">[root@pe-sysmonitor-zabbix ~]<span class="comment"># systemctl restart php-fpm</span></span><br></pre></td></tr></table></figure></li><li><p>配置完成后使用浏览器访问zabbix服务的ip进行web初始化</p><img src="http://qnlcbj437.fantom.run/static/images/zbx-server-001.png"></li><li><p>检查各个组件是否正常</p><img src="http://qnlcbj437.fantom.run/static/images/zbx-server-002.png"></li><li><p>数据zabbix数据库密码</p><img src="http://qnlcbj437.fantom.run/static/images/zbx-server-003.png"></li><li><p>zabbix服务器详情</p><img src="http://qnlcbj437.fantom.run/static/images/zbx-server-004.png"></li><li><p>初始化汇总信息</p><img src="http://qnlcbj437.fantom.run/static/images/zbx-server-005.png"></li><li><p>初始化安装，如果提示无法创建配置，点击页面上的链接下载配置文件上传到指定位置，并修改属组为apache:apache</p><img src="http://qnlcbj437.fantom.run/static/images/zbx-server-006.png"></li><li><p>初始化完成后登录，默认账号：Admin，密码：zabbix</p><img src="http://qnlcbj437.fantom.run/static/images/zbx-server-007.png"></li><li><p>zabbix主页</p><img src="http://qnlcbj437.fantom.run/static/images/zbx-server-008.png"></li></ul>]]></content>
    
    
    <summary type="html">&lt;ul&gt;
&lt;li&gt;平台：Oracle Linux 7.8&lt;/li&gt;
&lt;li&gt;数据库：MySQL 8.0&lt;/li&gt;
&lt;li&gt;中间件：Apache 2.4&lt;/li&gt;
&lt;li&gt;PHP：PHP 7.2&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="DevOps" scheme="http://falkon.cn/categories/DevOps/"/>
    
    
    <category term="Zabbix" scheme="http://falkon.cn/tags/Zabbix/"/>
    
  </entry>
  
  <entry>
    <title>Zabbix5.0添加中文</title>
    <link href="http://falkon.cn/2021/01/27/linux/zabbix50-add-chinese-language/"/>
    <id>http://falkon.cn/2021/01/27/linux/zabbix50-add-chinese-language/</id>
    <published>2021-01-27T09:37:22.765Z</published>
    <updated>2021-01-27T03:17:41.855Z</updated>
    
    <content type="html"><![CDATA[<ul><li>Zabbix安装完成后模式英文显示，问了方便后期的使用，将通过安装相关中文包，将语言由原来的英文切换到中文</li></ul><a id="more"></a><ul><li>检查中文依赖包和相关组件的安装</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[root@pe-sysmonitor-zabbix ~]<span class="comment"># locale -a | grep zh_CN</span></span><br><span class="line">[root@pe-sysmonitor-zabbix ~]<span class="comment"># dnf install langpacks-zh_CN.noarch</span></span><br><span class="line">CentOS-BaseOS-8 - Media                                                                                                                     243 kB/s | 3.9 kB     00:00</span><br><span class="line">CentOS-AppStream-8 - Media                                                                                                                  505 kB/s | 4.3 kB     00:00</span><br><span class="line">Dependencies resolved.</span><br><span class="line">============================================================================================================================================================================ Package                                      Architecture                      Version                                 Repository                                     Size</span><br><span class="line">============================================================================================================================================================================Installing:</span><br><span class="line"> langpacks-zh_CN                              noarch                            1.0-12.el8                              c8-media-AppStream                            9.6 k</span><br><span class="line">Installing weak dependencies:</span><br><span class="line"> glibc-langpack-zh                            x86_64                            2.28-72.el8                             c8-media-BaseOS                               2.1 M</span><br><span class="line"></span><br><span class="line">Transaction Summary</span><br><span class="line">============================================================================================================================================================================Install  2 Packages</span><br><span class="line"></span><br><span class="line">Total size: 2.2 M</span><br><span class="line">Installed size: 15 M</span><br><span class="line">Is this ok [y/N]: y</span><br><span class="line">Downloading Packages:</span><br><span class="line">Running transaction check</span><br><span class="line">Transaction check succeeded.</span><br><span class="line">Running transaction <span class="built_in">test</span></span><br><span class="line">Transaction <span class="built_in">test</span> succeeded.</span><br><span class="line">Running transaction</span><br><span class="line">  Preparing        :                                                                                                                                                    1/1</span><br><span class="line">  Installing       : glibc-langpack-zh-2.28-72.el8.x86_64                                                                                                               1/2</span><br><span class="line">  Installing       : langpacks-zh_CN-1.0-12.el8.noarch                                                                                                                  2/2</span><br><span class="line">  Running scriptlet: langpacks-zh_CN-1.0-12.el8.noarch                                                                                                                  2/2</span><br><span class="line">  Verifying        : glibc-langpack-zh-2.28-72.el8.x86_64                                                                                                               1/2</span><br><span class="line">  Verifying        : langpacks-zh_CN-1.0-12.el8.noarch                                                                                                                  2/2</span><br><span class="line"></span><br><span class="line">Installed:</span><br><span class="line">  langpacks-zh_CN-1.0-12.el8.noarch                                                   glibc-langpack-zh-2.28-72.el8.x86_64</span><br><span class="line"></span><br><span class="line">Complete!</span><br><span class="line">[root@pe-sysmonitor-zabbix ~]<span class="comment"># dnf install glibc-common</span></span><br><span class="line">Last metadata expiration check: 0:00:25 ago on Tue 18 Aug 2020 03:24:08 PM CST.</span><br><span class="line">Package glibc-common-2.28-72.el8.x86_64 is already installed.</span><br><span class="line">Dependencies resolved.</span><br><span class="line">Nothing to <span class="keyword">do</span>.</span><br><span class="line">Complete!</span><br><span class="line">[root@pe-sysmonitor-zabbix ~]<span class="comment"># dnf reinstall glibc-common</span></span><br><span class="line">Last metadata expiration check: 0:02:55 ago on Tue 18 Aug 2020 03:24:08 PM CST.</span><br><span class="line">Dependencies resolved.</span><br><span class="line">============================================================================================================================================================================ Package                                   Architecture                        Version                                   Repository                                    Size</span><br><span class="line">============================================================================================================================================================================Reinstalling:</span><br><span class="line"> glibc-common                              x86_64                              2.28-72.el8                               c8-media-BaseOS                              811 k</span><br><span class="line"></span><br><span class="line">Transaction Summary</span><br><span class="line">============================================================================================================================================================================</span><br><span class="line">Total size: 811 k</span><br><span class="line">Installed size: 3.6 M</span><br><span class="line">Is this ok [y/N]: y</span><br><span class="line">Downloading Packages:</span><br><span class="line">Running transaction check</span><br><span class="line">Transaction check succeeded.</span><br><span class="line">Running transaction <span class="built_in">test</span></span><br><span class="line">Transaction <span class="built_in">test</span> succeeded.</span><br><span class="line">Running transaction</span><br><span class="line">  Preparing        :                                                                                                                                                    1/1</span><br><span class="line">  Reinstalling     : glibc-common-2.28-72.el8.x86_64                                                                                                                    1/2</span><br><span class="line">  Cleanup          : glibc-common-2.28-72.el8.x86_64                                                                                                                    2/2</span><br><span class="line">  Running scriptlet: glibc-common-2.28-72.el8.x86_64                                                                                                                    2/2</span><br><span class="line">  Verifying        : glibc-common-2.28-72.el8.x86_64                                                                                                                    1/2</span><br><span class="line">  Verifying        : glibc-common-2.28-72.el8.x86_64                                                                                                                    2/2</span><br><span class="line"></span><br><span class="line">Reinstalled:</span><br><span class="line">  glibc-common-2.28-72.el8.x86_64</span><br><span class="line"></span><br><span class="line">Complete!</span><br></pre></td></tr></table></figure><ul><li>查看中文包安装后的信息</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@pe-sysmonitor-zabbix ~]<span class="comment"># locale -a | grep zh_CN</span></span><br><span class="line">zh_CN</span><br><span class="line">zh_CN.gb18030</span><br><span class="line">zh_CN.gbk</span><br><span class="line">zh_CN.utf8</span><br></pre></td></tr></table></figure><ul><li>切换到中文后，部分监控项出现乱码</li></ul><img src="http://qnlcbj437.fantom.run/static/images/chrome_202008201639495.png"><ul><li>上传字体<br>把C:\Windows\Fonts下的黑体（simhei.ttf）字体上传到Zabbix服务器，并复制到/var/www/html/assets/fonts目录（注意文件权限），每个人的Zabbix的安装目录都不一样，查找下对应的assets/fonts即可,上传完成后修改include/defines.inc.php，具体修改内容如下：<br>复制define(‘ZBX_GRAPH_FONT_NAME’,           ‘DejaVuSans’); // font file name这一行并注释掉<br>修改字体名称为我们上传的字体define(‘ZBX_GRAPH_FONT_NAME’,           ‘DejaVuSans’); // font file name</li></ul><ul><li>刷新后再次查看监控项中文已经正常显示</li></ul><img src="http://qnlcbj437.fantom.run/static/images/chrome_202008201702326.png">]]></content>
    
    
    <summary type="html">&lt;ul&gt;
&lt;li&gt;Zabbix安装完成后模式英文显示，问了方便后期的使用，将通过安装相关中文包，将语言由原来的英文切换到中文&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="DevOps" scheme="http://falkon.cn/categories/DevOps/"/>
    
    
    <category term="Zabbix" scheme="http://falkon.cn/tags/Zabbix/"/>
    
  </entry>
  
  <entry>
    <title>Openfiler安装配置</title>
    <link href="http://falkon.cn/2021/01/27/linux/openfiler-installation-and-configuration/"/>
    <id>http://falkon.cn/2021/01/27/linux/openfiler-installation-and-configuration/</id>
    <published>2021-01-27T09:37:22.758Z</published>
    <updated>2021-01-27T12:34:06.400Z</updated>
    
    <content type="html"><![CDATA[<ul><li>在workstation或者virtual box中创建一个内核为其他内核2.6x 64位的虚拟机，添加两块网卡，使用两块网卡来模拟磁盘多路径聚合，两块大小分别为10g和50g的硬盘，10g做为openfiler系统的安装磁盘，50g用来做LUN</li></ul><a id="more"></a><ul><li>挂在镜像，直接按回车</li></ul><img src="http://qnlcbj437.fantom.run/static/images/openfile01.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"><ul><li>进入下一步</li></ul><img src="http://qnlcbj437.fantom.run/static/images/openfile02.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"><ul><li>选择键盘</li></ul><img src="http://qnlcbj437.fantom.run/static/images/openfile03.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"><ul><li>选择系统安装磁盘，添加两块磁盘，一定不要另外一块磁盘</li></ul><img src="http://qnlcbj437.fantom.run/static/images/openfile04.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"><ul><li>选择卡网，默认选择后面再配置</li></ul><img src="http://qnlcbj437.fantom.run/static/images/openfile05.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"><ul><li>选择时区</li></ul><img src="http://qnlcbj437.fantom.run/static/images/openfile06.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"><ul><li>设置root密码</li></ul><img src="http://qnlcbj437.fantom.run/static/images/openfile07.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"><ul><li>进入下一步进行安装</li></ul><img src="http://qnlcbj437.fantom.run/static/images/openfile08.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"><ul><li>安装进度</li></ul><img src="http://qnlcbj437.fantom.run/static/images/openfile09.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"><ul><li>安装完成后重启</li></ul><img src="http://qnlcbj437.fantom.run/static/images/openfile10.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"><ul><li>启动后显示了web GUI信息</li></ul><img src="http://qnlcbj437.fantom.run/static/images/openfile11.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"><ul><li>配置静态IP地址</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 配置eth0</span></span><br><span class="line">[root@localhost ~]<span class="comment"># cat /etc/sysconfig/network-scripts/ifcfg-eth0 </span></span><br><span class="line"><span class="comment"># Intel Corporation 82545EM Gigabit Ethernet Controller (Copper)</span></span><br><span class="line">DEVICE=eth0</span><br><span class="line">BOOTPROTO=yes</span><br><span class="line">HWADDR=00:0C:29:9A:3B:BA</span><br><span class="line">ONBOOT=yes</span><br><span class="line">IPADDR=192.168.112.154</span><br><span class="line">NETMASK=255.255.255.0</span><br><span class="line">GATEWAY=192.168.112.1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置eth1</span></span><br><span class="line">[root@localhost ~]<span class="comment"># cat /etc/sysconfig/network-scripts/ifcfg-eth1 </span></span><br><span class="line"><span class="comment"># Intel Corporation 82545EM Gigabit Ethernet Controller (Copper)</span></span><br><span class="line">DEVICE=eth1</span><br><span class="line">BOOTPROTO=static</span><br><span class="line">HWADDR=00:0C:29:9A:3B:C4</span><br><span class="line">ONBOOT=yes</span><br><span class="line">IPADDR=192.168.112.155</span><br><span class="line">NETMASK=255.255.255.0</span><br><span class="line">GATEWAY=192.168.112.1</span><br></pre></td></tr></table></figure><ul><li>访问web GUI页面，默认的用户名为<code>openfiler</code>，密码为<code>password</code></li></ul><img src="http://qnlcbj437.fantom.run/static/images/openfile12.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"><ul><li>status显示当前NAS的物理信息</li></ul><img src="http://qnlcbj437.fantom.run/static/images/openfile13.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"><ul><li>开启iSCSI target</li></ul><img src="http://qnlcbj437.fantom.run/static/images/openfile14.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"><ul><li>点击System设置目标主机信息，Network/Host可以填写IP地址或者是主机名，如果是主机名的话，需要配置hosts解析</li></ul><img src="http://qnlcbj437.fantom.run/static/images/openfile15.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"><ul><li>点击Volume-&gt;Block Devices创建PV，系统预留5%，整块磁盘创建完成后，剩余的5%无法创建</li></ul><img src="http://qnlcbj437.fantom.run/static/images/openfile17.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"><p>&nbsp;</p><img src="http://qnlcbj437.fantom.run/static/images/openfile18.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"><p>&nbsp;</p><img src="http://qnlcbj437.fantom.run/static/images/openfile19.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"><ul><li>点击Volume-&gt;Volume Groups创建VG</li></ul><img src="http://qnlcbj437.fantom.run/static/images/openfile20.png"><p>&nbsp;</p><img src="http://qnlcbj437.fantom.run/static/images/openfile21.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"><ul><li>点击Volume-&gt;Add Volume创建LV</li></ul><img src="http://qnlcbj437.fantom.run/static/images/openfile22.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"><img src="http://qnlcbj437.fantom.run/static/images/openfile23.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"><ul><li>点击Volume-&gt;iSCSI Targets-&gt;Target Configuration设置IQN</li></ul><img src="http://qnlcbj437.fantom.run/static/images/openfile24.png"><ul><li>点击Volume-&gt;iSCSI Targets-&gt;LUN Mapping挂载LUN</li></ul><img src="http://qnlcbj437.fantom.run/static/images/openfile25.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"><ul><li>点击Volume-&gt;iSCSI Targets-&gt;Network ACL设置目标主机访问权限</li></ul><img src="http://qnlcbj437.fantom.run/static/images/openfile26.png"><ul><li>目标主机安装iSCSI包</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">[root@dev01 ~]<span class="comment"># yum -y install iscsi-initiator-utils</span></span><br><span class="line">Loaded plugins: security, ulninfo</span><br><span class="line">Setting up Install Process</span><br><span class="line">Resolving Dependencies</span><br><span class="line">--&gt; Running transaction check</span><br><span class="line">---&gt; Package iscsi-initiator-utils.x86_64 0:6.2.0.873-27.0.3.el6_9 will be installed</span><br><span class="line">--&gt; Finished Dependency Resolution</span><br><span class="line"></span><br><span class="line">Dependencies Resolved</span><br><span class="line"></span><br><span class="line">===============================================================================================================================================================================================================</span><br><span class="line"> Package                                               Arch                                   Version                                                  Repository                                         Size</span><br><span class="line">===============================================================================================================================================================================================================</span><br><span class="line">Installing:</span><br><span class="line"> iscsi-initiator-utils                                 x86_64                                 6.2.0.873-27.0.3.el6_9                                   public_ol6_latest                                 738 k</span><br><span class="line"></span><br><span class="line">Transaction Summary</span><br><span class="line">===============================================================================================================================================================================================================</span><br><span class="line">Install       1 Package(s)</span><br><span class="line"></span><br><span class="line">Total download size: 738 k</span><br><span class="line">Installed size: 2.5 M</span><br><span class="line">Downloading Packages:</span><br><span class="line">warning: rpmts_HdrFromFdno: Header V3 RSA/SHA256 Signature, key ID ec551f03: NOKEY</span><br><span class="line">Retrieving key from file:///etc/pki/rpm-gpg/RPM-GPG-KEY-oracle</span><br><span class="line">Importing GPG key 0xEC551F03:</span><br><span class="line"> Userid : Oracle OSS group (Open Source Software group) &lt;build@oss.oracle.com&gt;</span><br><span class="line"> Package: 6:oraclelinux-release-6Server-10.0.2.x86_64 (@anaconda-OracleLinuxServer-201806251353.x86_64/6.10)</span><br><span class="line"> From   : /etc/pki/rpm-gpg/RPM-GPG-KEY-oracle</span><br><span class="line">Running rpm_check_debug</span><br><span class="line">Running Transaction Test</span><br><span class="line">Transaction Test Succeeded</span><br><span class="line">Running Transaction</span><br><span class="line">  Installing : iscsi-initiator-utils-6.2.0.873-27.0.3.el6_9.x86_64                                                                                                                                         1/1 </span><br><span class="line">  Verifying  : iscsi-initiator-utils-6.2.0.873-27.0.3.el6_9.x86_64                                                                                                                                         1/1 </span><br><span class="line"></span><br><span class="line">Installed:</span><br><span class="line">  iscsi-initiator-utils.x86_64 0:6.2.0.873-27.0.3.el6_9                                                                                                                                                        </span><br><span class="line"></span><br><span class="line">Complete!</span><br></pre></td></tr></table></figure><ul><li>查找存储对外提供的卷</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@dev01 ~]<span class="comment"># iscsiadm -m discovery -t st -p 192.168.112.154</span></span><br><span class="line">Starting iscsid:                                           [  OK  ]</span><br><span class="line">192.168.112.154:3260,1 iqn.2006-01.com.openfiler:tsn.dev019527</span><br><span class="line">192.168.112.155:3260,1 iqn.2006-01.com.openfiler:tsn.dev019527</span><br></pre></td></tr></table></figure><ul><li>映射逻辑卷到系统中</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[root@dev01 ~]<span class="comment"># iscsiadm -m node -T iqn.2006-01.com.openfiler:tsn.dev019527 -p 192.168.112.154:3260 -l</span></span><br><span class="line">Logging <span class="keyword">in</span> to [iface: default, target: iqn.2006-01.com.openfiler:tsn.dev019527, portal: 192.168.112.154,3260] (multiple)</span><br><span class="line">Login to [iface: default, target: iqn.2006-01.com.openfiler:tsn.dev019527, portal: 192.168.112.154,3260] successful.</span><br><span class="line">[root@dev01 ~]<span class="comment"># iscsiadm -m node -T iqn.2006-01.com.openfiler:tsn.dev019527 -p 192.168.112.155:3260 -l</span></span><br><span class="line">Logging <span class="keyword">in</span> to [iface: default, target: iqn.2006-01.com.openfiler:tsn.dev019527, portal: 192.168.112.155,3260] (multiple)</span><br><span class="line">Login to [iface: default, target: iqn.2006-01.com.openfiler:tsn.dev019527, portal: 192.168.112.155,3260] successful.</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看LUN的映射，两条路径对应两块分盘</span></span><br><span class="line">Disk /dev/sdb: 51.2 GB, 51170508800 bytes</span><br><span class="line">64 heads, 32 sectors/track, 48800 cylinders</span><br><span class="line">Units = cylinders of 2048 * 512 = 1048576 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 512 bytes</span><br><span class="line">I/O size (minimum/optimal): 512 bytes / 512 bytes</span><br><span class="line">Disk identifier: 0x00000000</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Disk /dev/sdc: 51.2 GB, 51170508800 bytes</span><br><span class="line">64 heads, 32 sectors/track, 48800 cylinders</span><br><span class="line">Units = cylinders of 2048 * 512 = 1048576 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 512 bytes</span><br><span class="line">I/O size (minimum/optimal): 512 bytes / 512 bytes</span><br><span class="line">Disk identifier: 0x00000000</span><br></pre></td></tr></table></figure><ul><li>设置开机自动映射</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@dev01 ~]<span class="comment"># iscsiadm -m node -T iqn.2006-01.com.openfiler:tsn.dev019527 -p 192.168.112.154:3260 -o update -n node.startup -v automatic</span></span><br><span class="line">[root@dev01 ~]<span class="comment"># iscsiadm -m node -T iqn.2006-01.com.openfiler:tsn.dev019527 -p 192.168.112.155:3260 -o update -n node.startup -v automatic</span></span><br></pre></td></tr></table></figure><ul><li>安装多路径包</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">[root@dev01 ~]<span class="comment"># yum -y install device-mapper-multipath</span></span><br><span class="line">Loaded plugins: security, ulninfo</span><br><span class="line">Setting up Install Process</span><br><span class="line">Resolving Dependencies</span><br><span class="line">--&gt; Running transaction check</span><br><span class="line">---&gt; Package device-mapper-multipath.x86_64 0:0.4.9-106.0.1.el6 will be installed</span><br><span class="line">--&gt; Processing Dependency: device-mapper-multipath-libs = 0.4.9-106.0.1.el6 <span class="keyword">for</span> package: device-mapper-multipath-0.4.9-106.0.1.el6.x86_64</span><br><span class="line">--&gt; Processing Dependency: libmultipath.so()(64bit) <span class="keyword">for</span> package: device-mapper-multipath-0.4.9-106.0.1.el6.x86_64</span><br><span class="line">--&gt; Processing Dependency: libmpathpersist.so.0()(64bit) <span class="keyword">for</span> package: device-mapper-multipath-0.4.9-106.0.1.el6.x86_64</span><br><span class="line">--&gt; Running transaction check</span><br><span class="line">---&gt; Package device-mapper-multipath-libs.x86_64 0:0.4.9-106.0.1.el6 will be installed</span><br><span class="line">--&gt; Finished Dependency Resolution</span><br><span class="line"></span><br><span class="line">Dependencies Resolved</span><br><span class="line"></span><br><span class="line">===============================================================================================================================================================================================================</span><br><span class="line"> Package                                                      Arch                                   Version                                           Repository                                         Size</span><br><span class="line">===============================================================================================================================================================================================================</span><br><span class="line">Installing:</span><br><span class="line"> device-mapper-multipath                                      x86_64                                 0.4.9-106.0.1.el6                                 public_ol6_latest                                 134 k</span><br><span class="line">Installing <span class="keyword">for</span> dependencies:</span><br><span class="line"> device-mapper-multipath-libs                                 x86_64                                 0.4.9-106.0.1.el6                                 public_ol6_latest                                 205 k</span><br><span class="line"></span><br><span class="line">Transaction Summary</span><br><span class="line">===============================================================================================================================================================================================================</span><br><span class="line">Install       2 Package(s)</span><br><span class="line"></span><br><span class="line">Total download size: 339 k</span><br><span class="line">Installed size: 699 k</span><br><span class="line">Downloading Packages:</span><br><span class="line">---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span><br><span class="line">Total                                                                                                                                                                           39 MB/s | 339 kB     00:00     </span><br><span class="line">Running rpm_check_debug</span><br><span class="line">Running Transaction Test</span><br><span class="line">Transaction Test Succeeded</span><br><span class="line">Running Transaction</span><br><span class="line">  Installing : device-mapper-multipath-libs-0.4.9-106.0.1.el6.x86_64                                                                                                                                       1/2 </span><br><span class="line">  Installing : device-mapper-multipath-0.4.9-106.0.1.el6.x86_64                                                                                                                                            2/2 </span><br><span class="line">  Verifying  : device-mapper-multipath-libs-0.4.9-106.0.1.el6.x86_64                                                                                                                                       1/2 </span><br><span class="line">  Verifying  : device-mapper-multipath-0.4.9-106.0.1.el6.x86_64                                                                                                                                            2/2 </span><br><span class="line"></span><br><span class="line">Installed:</span><br><span class="line">  device-mapper-multipath.x86_64 0:0.4.9-106.0.1.el6                                                                                                                                                           </span><br><span class="line"></span><br><span class="line">Dependency Installed:</span><br><span class="line">  device-mapper-multipath-libs.x86_64 0:0.4.9-106.0.1.el6                                                                                                                                                      </span><br><span class="line"></span><br><span class="line">Complete!</span><br><span class="line"></span><br><span class="line"><span class="comment"># 复制multipath.conf到etc</span></span><br><span class="line">[root@dev01 ~]<span class="comment"># cp /usr/share/doc/device-mapper-multipath-0.4.9/multipath.conf /etc/</span></span><br></pre></td></tr></table></figure><ul><li>配置多路径聚合</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取磁盘的WWID号</span></span><br><span class="line">[root@dev01 ~]<span class="comment"># scsi_id -g -u -d /dev/sdb </span></span><br><span class="line">14f504e46494c4552523758456c352d437752492d59774b6e</span><br><span class="line">[root@dev01 ~]<span class="comment"># scsi_id -g -u -d /dev/sdc</span></span><br><span class="line">14f504e46494c4552523758456c352d437752492d59774b6e</span><br><span class="line"></span><br><span class="line"><span class="comment"># 编辑multipath.conf</span></span><br><span class="line">defaults &#123;</span><br><span class="line">user_friendly_names yes</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">blacklist &#123; </span><br><span class="line">devnode <span class="string">"^sda"</span> </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">multipaths &#123;</span><br><span class="line">multipath &#123; </span><br><span class="line">wwid <span class="string">"14f504e46494c4552523758456c352d437752492d59774b6e"</span></span><br><span class="line"><span class="built_in">alias</span> lv_dev01</span><br><span class="line">path_grouping_policymultibus</span><br><span class="line">path_selector<span class="string">"round-robin 0"</span> </span><br><span class="line">  failbackmanual </span><br><span class="line">  rr_weightpriorities </span><br><span class="line">  no_path_retry5 </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>查看聚合后的磁盘信息</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@dev01 ~]<span class="comment"># multipath -ll</span></span><br><span class="line">lv_dev01 (14f504e46494c4552523758456c352d437752492d59774b6e) dm-3 OPNFILER,VIRTUAL-DISK</span><br><span class="line">size=48G features=<span class="string">'1 queue_if_no_path'</span> hwhandler=<span class="string">'0'</span> wp=rw</span><br><span class="line">`-+- policy=<span class="string">'round-robin 0'</span> prio=1 status=active</span><br><span class="line">  |- 3:0:0:0 sdb 8:16 active ready running</span><br><span class="line">  `- 4:0:0:0 sdc 8:32 active ready running</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看磁盘映射</span></span><br><span class="line">[root@dev01 ~]<span class="comment"># ll /dev/mapper/*</span></span><br><span class="line">crw-rw----. 1 root root 10, 236 Mar 26 15:00 /dev/mapper/control</span><br><span class="line">lrwxrwxrwx. 1 root root       7 Mar 30 19:41 /dev/mapper/lv_dev01 -&gt; ../dm-3</span><br><span class="line">lrwxrwxrwx. 1 root root       7 Mar 26 15:00 /dev/mapper/VolGroup-lv_home -&gt; ../dm-2</span><br><span class="line">lrwxrwxrwx. 1 root root       7 Mar 26 15:00 /dev/mapper/VolGroup-lv_root -&gt; ../dm-0</span><br><span class="line">lrwxrwxrwx. 1 root root       7 Mar 26 15:00 /dev/mapper/VolGroup-lv_swap -&gt; ../dm-1</span><br></pre></td></tr></table></figure><ul><li>将iSCSI服务和multipathd服务设置为开启启动</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@dev01 ~]<span class="comment"># chkconfig --level 2345 iscsi on</span></span><br><span class="line">[root@dev01 ~]<span class="comment"># chkconfig --level 2345 multipathd on</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;ul&gt;
&lt;li&gt;在workstation或者virtual box中创建一个内核为其他内核2.6x 64位的虚拟机，添加两块网卡，使用两块网卡来模拟磁盘多路径聚合，两块大小分别为10g和50g的硬盘，10g做为openfiler系统的安装磁盘，50g用来做LUN&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="NAS" scheme="http://falkon.cn/categories/NAS/"/>
    
    
    <category term="Openfiler" scheme="http://falkon.cn/tags/Openfiler/"/>
    
  </entry>
  
  <entry>
    <title>Linux 7.8安装配置VNCSERVER</title>
    <link href="http://falkon.cn/2021/01/27/linux/linux78-config-vncserver/"/>
    <id>http://falkon.cn/2021/01/27/linux/linux78-config-vncserver/</id>
    <published>2021-01-27T09:37:22.752Z</published>
    <updated>2021-02-20T15:19:44.144Z</updated>
    
    <content type="html"><![CDATA[<ul><li>查看系统版本<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@aproddb19c ~]<span class="comment"># cat /etc/redhat-release </span></span><br><span class="line">CentOS Linux release 7.8.2003 (Core)</span><br></pre></td></tr></table></figure></li></ul><a id="more"></a><ul><li>关闭防火墙</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[root@aproddb19c ~]<span class="comment"># systemctl stop firewalld</span></span><br><span class="line">[root@aproddb19c ~]<span class="comment"># systemctl status firewalld</span></span><br><span class="line">● firewalld.service - firewalld - dynamic firewall daemon</span><br><span class="line">   Loaded: loaded (/usr/lib/systemd/system/firewalld.service; disabled; vendor preset: enabled)</span><br><span class="line">   Active: inactive (dead)</span><br><span class="line">     Docs: man:firewalld(1)</span><br><span class="line"></span><br><span class="line">Jun 30 10:59:40 aproddb19c firewalld[6550]: WARNING: COMMAND_FAILED: <span class="string">'/usr/sbin/iptables -w10 -w --table filter --delete FORWARD --in-interface virbr0 --out-interface virbr...hat chain?).</span></span><br><span class="line"><span class="string">Jun 30 10:59:40 aproddb19c firewalld[6550]: WARNING: COMMAND_FAILED: '</span>/usr/sbin/iptables -w10 -w --table filter --delete FORWARD --out-interface virbr0 --jump REJECT<span class="string">' faile...y that name.</span></span><br><span class="line"><span class="string">Jun 30 10:59:40 aproddb19c firewalld[6550]: WARNING: COMMAND_FAILED: '</span>/usr/sbin/iptables -w10 -w --table filter --delete FORWARD --<span class="keyword">in</span>-interface virbr0 --jump REJECT<span class="string">' failed...y that name.</span></span><br><span class="line"><span class="string">Jun 30 10:59:40 aproddb19c firewalld[6550]: WARNING: COMMAND_FAILED: '</span>/usr/sbin/iptables -w10 -w --table filter --delete INPUT --<span class="keyword">in</span>-interface virbr0 --protocol udp --destin...hat chain?).</span><br><span class="line">Jun 30 10:59:40 aproddb19c firewalld[6550]: WARNING: COMMAND_FAILED: <span class="string">'/usr/sbin/iptables -w10 -w --table filter --delete INPUT --in-interface virbr0 --protocol tcp --destin...hat chain?).</span></span><br><span class="line"><span class="string">Jun 30 10:59:40 aproddb19c firewalld[6550]: WARNING: COMMAND_FAILED: '</span>/usr/sbin/iptables -w10 -w --table filter --delete OUTPUT --out-interface virbr0 --protocol udp --dest...hat chain?).</span><br><span class="line">Jun 30 10:59:40 aproddb19c firewalld[6550]: WARNING: COMMAND_FAILED: <span class="string">'/usr/sbin/iptables -w10 -w --table filter --delete INPUT --in-interface virbr0 --protocol udp --destin...hat chain?).</span></span><br><span class="line"><span class="string">Jun 30 10:59:40 aproddb19c firewalld[6550]: WARNING: COMMAND_FAILED: '</span>/usr/sbin/iptables -w10 -w --table filter --delete INPUT --<span class="keyword">in</span>-interface virbr0 --protocol tcp --destin...hat chain?).</span><br><span class="line">Jun 30 10:59:48 aproddb19c systemd[1]: Stopping firewalld - dynamic firewall daemon...</span><br><span class="line">Jun 30 10:59:49 aproddb19c systemd[1]: Stopped firewalld - dynamic firewall daemon.</span><br><span class="line">Hint: Some lines were ellipsized, use -l to show <span class="keyword">in</span> full.</span><br><span class="line">[root@aproddb19c ~]<span class="comment"># systemctl disable firewalld</span></span><br></pre></td></tr></table></figure><ul><li>安装vncserver</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">[root@aproddb19c ~]<span class="comment"># yum -y install tigervnc-server</span></span><br><span class="line">Loaded plugins: fastestmirror, langpacks</span><br><span class="line">Loading mirror speeds from cached hostfile</span><br><span class="line">Resolving Dependencies</span><br><span class="line">--&gt; Running transaction check</span><br><span class="line">---&gt; Package tigervnc-server.x86_64 0:1.8.0-19.el7 will be installed</span><br><span class="line">--&gt; Finished Dependency Resolution</span><br><span class="line">Dependencies Resolved</span><br><span class="line">===========================================================================================================================================================================================</span><br><span class="line"> Package                                          Arch                                    Version                                          Repository                                 Size</span><br><span class="line">===========================================================================================================================================================================================</span><br><span class="line">Installing:</span><br><span class="line"> tigervnc-server                                  x86_64                                  1.8.0-19.el7                                     c7-media                                  216 k</span><br><span class="line">Transaction Summary</span><br><span class="line">===========================================================================================================================================================================================</span><br><span class="line">Install  1 Package</span><br><span class="line">Total download size: 216 k</span><br><span class="line">Installed size: 510 k</span><br><span class="line">Downloading packages:</span><br><span class="line">Running transaction check</span><br><span class="line">Running transaction <span class="built_in">test</span></span><br><span class="line">Transaction <span class="built_in">test</span> succeeded</span><br><span class="line">Running transaction</span><br><span class="line">  Installing : tigervnc-server-1.8.0-19.el7.x86_64                                                                                                                                     1/1 </span><br><span class="line">  Verifying  : tigervnc-server-1.8.0-19.el7.x86_64                                                                                                                                     1/1 </span><br><span class="line">Installed:</span><br><span class="line">  tigervnc-server.x86_64 0:1.8.0-19.el7                                                                                                                                                    </span><br><span class="line">Complete!</span><br></pre></td></tr></table></figure><ul><li>复制并修改配置文件</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[root@aproddb19c ~]<span class="comment"># cp /usr/lib/systemd/system/vncserver@.service /etc/systemd/system/vncserver@.service</span></span><br><span class="line">[root@aproddb19c ~]<span class="comment"># vi /etc/systemd/system/vncserver@.service </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 编辑完成后的内容</span></span><br><span class="line">[Unit]</span><br><span class="line">Description=Remote desktop service (VNC)</span><br><span class="line">After=syslog.target network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=simple</span><br><span class="line"></span><br><span class="line"><span class="comment"># Clean any existing files in /tmp/.X11-unix environment</span></span><br><span class="line">ExecStartPre=/bin/sh -c <span class="string">'/usr/bin/vncserver -kill %i &gt; /dev/null 2&gt;&amp;1 || :'</span></span><br><span class="line"><span class="comment"># ExecStart=/usr/bin/vncserver_wrapper &lt;USER&gt; %i</span></span><br><span class="line">ExecStart=/sbin/runuser -l root -c <span class="string">"/usr/bin/vncserver %i"</span></span><br><span class="line">PIDFile=/root/.vnc/%H%i.pid</span><br><span class="line">ExecStop=/bin/sh -c <span class="string">'/usr/bin/vncserver -kill %i &gt; /dev/null 2&gt;&amp;1 || :'</span></span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure><ul><li>设置vnc密码</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@aproddb19c ~]<span class="comment"># vncpasswd</span></span><br><span class="line">Password:</span><br><span class="line">Verify:</span><br><span class="line">Would you like to enter a view-only password (y/n)? </span><br><span class="line">A view-only password is not used</span><br></pre></td></tr></table></figure><ul><li>启动vnc服务并查看服务的状态</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@aproddb19c system]<span class="comment"># systemctl daemon-reload</span></span><br><span class="line">[root@aproddb19c system]<span class="comment"># systemctl start vncserver@:1</span></span><br><span class="line">[root@aproddb19c system]<span class="comment"># systemctl status vncserver@:1</span></span><br><span class="line">● vncserver@:1.service - Remote desktop service (VNC)</span><br><span class="line">   Loaded: loaded (/etc/systemd/system/vncserver@.service; disabled; vendor preset: disabled)</span><br><span class="line">   Active: active (running) since Sat 2020-06-27 17:27:52 CST; 5s ago</span><br><span class="line">  Process: 7301 ExecStartPre=/bin/sh -c /usr/bin/vncserver -<span class="built_in">kill</span> %i &gt; /dev/null 2&gt;&amp;1 || : (code=exited, status=0/SUCCESS)</span><br><span class="line"> Main PID: 7325 (Xvnc)</span><br><span class="line">   CGroup: /system.slice/system-vncserver.slice/vncserver@:1.service</span><br><span class="line">           ‣ 7325 /usr/bin/Xvnc :1 -auth /root/.Xauthority -desktop aproddb19c:1 (root) -fp catalogue:/etc/X11/fontpath.d -geometry 1024x768 -pn -rfbauth /root/.vnc/passwd -rfbport 590...</span><br><span class="line"></span><br><span class="line">Jun 27 17:27:52 aproddb19c systemd[1]: Starting Remote desktop service (VNC)...</span><br><span class="line">Jun 27 17:27:52 aproddb19c systemd[1]: Started Remote desktop service (VNC).</span><br></pre></td></tr></table></figure><ul><li>测试连接<img src="http://qnlcbj437.fantom.run/static/images/testvcnserver01.png"></li></ul>]]></content>
    
    
    <summary type="html">&lt;ul&gt;
&lt;li&gt;查看系统版本&lt;figure class=&quot;highlight sh&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;[root@aproddb19c ~]&lt;span class=&quot;comment&quot;&gt;# cat /etc/redhat-release &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;CentOS Linux release 7.8.2003 (Core)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="Linux" scheme="http://falkon.cn/categories/Linux/"/>
    
    
    <category term="VNC" scheme="http://falkon.cn/tags/VNC/"/>
    
  </entry>
  
  <entry>
    <title>Linux扩展swap分区</title>
    <link href="http://falkon.cn/2021/01/27/linux/linux-extend-swap/"/>
    <id>http://falkon.cn/2021/01/27/linux/linux-extend-swap/</id>
    <published>2021-01-27T09:37:22.745Z</published>
    <updated>2021-01-28T03:23:07.284Z</updated>
    
    <content type="html"><![CDATA[<ul><li><p>查看现有的swap分区大小</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@ystdb11g ~]<span class="comment"># free -m</span></span><br><span class="line">             total       used       free     shared    buffers     cached</span><br><span class="line">Mem:          1725       1618        106          8         81        872</span><br><span class="line">-/+ buffers/cache:        664       1060</span><br><span class="line">Swap:         2047         13       2034</span><br></pre></td></tr></table></figure><a id="more"></a></li><li><p>增加交换分区文件大小，bs为块大小，count为块的数量，增加2GB大小的swap交换分区，写法如下</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@ystdb11g ~]<span class="comment"># dd if=/dev/zero of=/opt/swap01 bs=1M count=2048</span></span><br><span class="line">2048+0 records <span class="keyword">in</span></span><br><span class="line">2048+0 records out</span><br></pre></td></tr></table></figure></li><li><p>设置交换文件</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@ystdb11g ~]<span class="comment"># mkswap /opt/swap01</span></span><br><span class="line">Setting up swapspace version 1, size = 2097148 KiB</span><br><span class="line">no label, UUID=739f980d-ab1a-4858-bcc5-f5389d4365ef</span><br></pre></td></tr></table></figure></li><li><p>启用交换分区文件</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@ystdb11g ~]<span class="comment"># swapon /opt/swap01</span></span><br></pre></td></tr></table></figure></li><li><p>查看扩展后的交换分区</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@ystdb11g ~]<span class="comment"># free -m</span></span><br><span class="line">             total       used       free     shared    buffers     cached</span><br><span class="line">Mem:          1725       1631         93          8          2       1041</span><br><span class="line">-/+ buffers/cache:        587       1137</span><br><span class="line">Swap:         4095         36       4059</span><br></pre></td></tr></table></figure></li></ul>]]></content>
    
    
    <summary type="html">&lt;ul&gt;
&lt;li&gt;&lt;p&gt;查看现有的swap分区大小&lt;/p&gt;
&lt;figure class=&quot;highlight sh&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;[root@ystdb11g ~]&lt;span class=&quot;comment&quot;&gt;# free -m&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;             total       used       free     shared    buffers     cached&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Mem:          1725       1618        106          8         81        872&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-/+ buffers/cache:        664       1060&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Swap:         2047         13       2034&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="Linux" scheme="http://falkon.cn/categories/Linux/"/>
    
    
    <category term="SWAP" scheme="http://falkon.cn/tags/SWAP/"/>
    
  </entry>
  
  <entry>
    <title>Linux下创建模拟僵尸进程并杀死</title>
    <link href="http://falkon.cn/2021/01/27/linux/linux-create-zombie-processes-and-killed/"/>
    <id>http://falkon.cn/2021/01/27/linux/linux-create-zombie-processes-and-killed/</id>
    <published>2021-01-27T09:37:22.740Z</published>
    <updated>2021-02-21T03:44:51.552Z</updated>
    
    <content type="html"><![CDATA[<p>僵尸进程是当子进程比父进程先结束，而父进程又没有回收子进程，释放子进程占用的资源，此时子进程将成为一个僵尸进程。如果父进程先退出，子进程被init接管，子进程退出后init会回收其占用的相关资源。我们都知道进程的工作原理。我们启动一个程序，开始我们的任务，然后等任务结束了，我们就停止这个进程。进程停止后，该进程就会从进程表中移除。下面通过一个示例，在Linux下模拟创建僵尸进程，并通过查找僵尸进程并杀死僵尸进程的过程。</p><a id="more"></a><ul><li>创建僵尸进程</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;signal.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;linux/wait.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc,<span class="keyword">char</span> **argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">pid_t</span> pid=fork();</span><br><span class="line">        <span class="keyword">if</span>(pid==<span class="number">-1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(pid==<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"son pid is %d\n"</span>,getpid());</span><br><span class="line">                <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">"son---i=%d\n"</span>,i);</span><br><span class="line">                        i++;</span><br><span class="line">                        sleep(<span class="number">1</span>);</span><br><span class="line">                        <span class="keyword">if</span>(i==<span class="number">5</span>)</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"son is over!\n"</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(pid&gt;<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"parent pid is %d\n"</span>,getpid());</span><br><span class="line">                <span class="keyword">while</span>(<span class="number">1</span>) sleep(<span class="number">100</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>查看僵尸进程</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">top - 11:20:26 up 5 days, 1 min,  2 users,  load average: 0.18, 0.32, 0.44</span><br><span class="line">Tasks: 379 total,   1 running, 376 sleeping,   1 stopped,   1 zombie                 &lt;&lt;&lt;&lt;&lt;&lt; 僵尸进程</span><br><span class="line">Cpu(s):  6.1%us,  5.5%sy,  0.0%ni, 84.4%id,  3.8%wa,  0.0%hi,  0.2%si,  0.0%st</span><br><span class="line">Mem:   4045668k total,  3835188k used,   210480k free,   231976k buffers</span><br><span class="line">Swap:  4194300k total,  1039544k used,  3154756k free,  2101984k cached</span><br><span class="line"></span><br><span class="line">  PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND  </span><br><span class="line"> 4577 grid      RT   0 1103m 128m  58m S  3.9  3.2  58:10.06 ocssd.bin</span><br><span class="line"> 9946 root      RT   0  828m  95m  60m S  3.9  2.4 171:54.39 osysmond.bin</span><br><span class="line">10158 root      RT  -5  826m 158m  66m S  3.9  4.0 112:46.22 ologgerd</span><br><span class="line">   18 root      20   0     0    0    0 S  1.9  0.0   9:53.31 rcuos/1</span><br><span class="line"> 4474 grid      20   0 1137m  38m  24m S  1.9  1.0  25:10.52 oraagent.bin</span><br><span class="line"> 5594 oracle    -2   0 1953m  40m  40m S  1.9  1.0 140:08.02 oracle</span><br><span class="line"> 5608 oracle    20   0 1966m  65m  57m S  1.9  1.7  26:11.98 oracle</span><br><span class="line"> 5614 oracle    -2   0 1968m 686m 675m S  1.9 17.4  20:10.71 oracle</span><br><span class="line">19583 root      20   0     0    0    0 S  1.9  0.0   0:01.02 kworker/u4:1</span><br><span class="line">26619 root      20   0     0    0    0 S  1.9  0.0   0:00.02 kworker/u4:0</span><br><span class="line">26717 root      20   0 15216 2240 1720 R  1.9  0.1   0:00.02 top</span><br><span class="line">    1 root      20   0 19396 1736 1532 S  0.0  0.0   0:04.20 init</span><br><span class="line">    2 root      20   0     0    0    0 S  0.0  0.0   0:00.07 kthreadd</span><br><span class="line">    3 root      20   0     0    0    0 S  0.0  0.0   2:33.69 ksoftirqd/0</span><br><span class="line">    5 root       0 -20     0    0    0 S  0.0  0.0   0:00.00 kworker/0:0H</span><br><span class="line">    7 root      20   0     0    0    0 S  0.0  0.0  20:46.80 rcu_sched</span><br><span class="line">    8 root      20   0     0    0    0 S  0.0  0.0   0:00.00 rcu_bh</span><br><span class="line">    9 root      20   0     0    0    0 S  0.0  0.0   9:45.87 rcuos/0</span><br><span class="line">   10 root      20   0     0    0    0 S  0.0  0.0   0:00.00 rcuob/0</span><br><span class="line">   11 root      RT   0     0    0    0 S  0.0  0.0   0:01.38 migration/0</span><br><span class="line">   12 root      RT   0     0    0    0 S  0.0  0.0   0:01.40 watchdog/0</span><br><span class="line">   13 root      RT   0     0    0    0 S  0.0  0.0   0:01.38 watchdog/1</span><br><span class="line">   14 root      RT   0     0    0    0 S  0.0  0.0   0:01.33 migration/1</span><br><span class="line">   15 root      20   0     0    0    0 S  0.0  0.0   2:01.14 ksoftirqd/1</span><br><span class="line">   17 root       0 -20     0    0    0 S  0.0  0.0   0:00.00 kworker/1:0H</span><br><span class="line">   19 root      20   0     0    0    0 S  0.0  0.0   0:00.00 rcuob/1</span><br><span class="line">   20 root       0 -20     0    0    0 S  0.0  0.0   0:00.00 khelper</span><br><span class="line">   21 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kdevtmpfs</span><br><span class="line">   22 root       0 -20     0    0    0 S  0.0  0.0   0:00.00 netns</span><br><span class="line">   23 root       0 -20     0    0    0 S  0.0  0.0   0:00.00 perf</span><br><span class="line">   24 root      20   0     0    0    0 S  0.0  0.0   0:00.49 khungtaskd</span><br><span class="line">   25 root       0 -20     0    0    0 S  0.0  0.0   0:00.00 writeback</span><br><span class="line">   26 root      25   5     0    0    0 S  0.0  0.0   0:00.00 ksmd</span><br><span class="line">   28 root       0 -20     0    0    0 S  0.0  0.0   0:00.00 crypto</span><br><span class="line">   29 root       0 -20     0    0    0 S  0.0  0.0   0:00.00 kintegrityd</span><br><span class="line">   30 root       0 -20     0    0    0 S  0.0  0.0   0:00.00 bioset</span><br><span class="line">   31 root       0 -20     0    0    0 S  0.0  0.0   0:00.00 kblockd</span><br><span class="line">   32 root       0 -20     0    0    0 S  0.0  0.0   0:00.00 ata_sff</span><br><span class="line">   33 root       0 -20     0    0    0 S  0.0  0.0   0:00.00 md</span><br><span class="line">   36 root      20   0     0    0    0 S  0.0  0.0   0:08.09 kswapd0:0</span><br><span class="line">   37 root      20   0     0    0    0 S  0.0  0.0   0:00.00 fsnotify_mark</span><br></pre></td></tr></table></figure><ul><li>查找具体的僵尸进程</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@rac1 ~]<span class="comment"># ps aux | grep Z</span></span><br><span class="line">USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND</span><br><span class="line">root     26698  0.0  0.0      0     0 pts/0    Z+   11:20   0:00 [<span class="built_in">test</span>] &lt;defunct&gt;</span><br><span class="line">root     26732  0.0  0.0 103392  2076 pts/1    S+   11:20   0:00 grep Z</span><br></pre></td></tr></table></figure><ul><li>查找僵尸进程的父进程</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@rac1 ~]<span class="comment"># ps aux | grep test</span></span><br><span class="line">root     26697  0.0  0.0   3984   400 pts/0    S+   11:20   0:00 ./<span class="built_in">test</span></span><br><span class="line">root     26698  0.0  0.0      0     0 pts/0    Z+   11:20   0:00 [<span class="built_in">test</span>] &lt;defunct&gt;     &lt;&lt;&lt;&lt;&lt;&lt;&lt; 进程子ID</span><br><span class="line">root     26874  0.0  0.0 103388  2148 pts/1    S+   11:20   0:00 grep <span class="built_in">test</span></span><br><span class="line"></span><br><span class="line">[root@rac1 ~]<span class="comment"># ps -ef | grep 26698</span></span><br><span class="line">root     26698 26697  0 11:20 pts/0    00:00:00 [<span class="built_in">test</span>] &lt;defunct&gt;                      &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; 进程父ID</span><br><span class="line">root     26906 23344  0 11:20 pts/1    00:00:00 grep 26698</span><br></pre></td></tr></table></figure><ul><li>杀死僵尸进程</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@rac1 ~]<span class="comment"># kill -s 9 26697</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;僵尸进程是当子进程比父进程先结束，而父进程又没有回收子进程，释放子进程占用的资源，此时子进程将成为一个僵尸进程。如果父进程先退出，子进程被init接管，子进程退出后init会回收其占用的相关资源。我们都知道进程的工作原理。我们启动一个程序，开始我们的任务，然后等任务结束了，我们就停止这个进程。进程停止后，该进程就会从进程表中移除。下面通过一个示例，在Linux下模拟创建僵尸进程，并通过查找僵尸进程并杀死僵尸进程的过程。&lt;/p&gt;</summary>
    
    
    
    <category term="Linux" scheme="http://falkon.cn/categories/Linux/"/>
    
    
    <category term="Linux" scheme="http://falkon.cn/tags/Linux/"/>
    
    <category term="Zombie" scheme="http://falkon.cn/tags/Zombie/"/>
    
  </entry>
  
  <entry>
    <title>CentOS 8 Mini installed then installation Desktop</title>
    <link href="http://falkon.cn/2021/01/27/linux/centos8-mini-installed-then-install-desktop/"/>
    <id>http://falkon.cn/2021/01/27/linux/centos8-mini-installed-then-install-desktop/</id>
    <published>2021-01-27T09:37:22.734Z</published>
    <updated>2021-01-28T03:23:27.700Z</updated>
    
    <content type="html"><![CDATA[<ul><li>Centos 8 系列如果默认以文本模式或者最小话安装，后期需要安装图形桌面的安装及设置</li></ul><a id="more"></a><ul><li>列出可以安装的选项 </li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">[root@yongstoneinc yum.repos.d]<span class="comment"># yum grouplist</span></span><br><span class="line">CentOS-BaseOS-8 - Media                                                                                                                      71 MB/s | 2.2 MB     00:00</span><br><span class="line">CentOS-AppStream-8 - Media                                                                                                                   85 MB/s | 5.7 MB     00:00</span><br><span class="line">Available Environment Groups:</span><br><span class="line">   Server with GUI</span><br><span class="line">   Server</span><br><span class="line">   Workstation</span><br><span class="line">   Custom Operating System</span><br><span class="line">   Virtualization Host</span><br><span class="line">Installed Environment Groups:</span><br><span class="line">   Minimal Install</span><br><span class="line">Available Groups:</span><br><span class="line">   Legacy UNIX Compatibility</span><br><span class="line">   Container Management</span><br><span class="line">   Development Tools</span><br><span class="line">   .NET Core Development</span><br><span class="line">   Graphical Administration Tools</span><br><span class="line">   Headless Management</span><br><span class="line">   Network Servers</span><br><span class="line">   RPM Development Tools</span><br><span class="line">   Scientific Support</span><br><span class="line">   Security Tools</span><br><span class="line">   Smart Card Support</span><br><span class="line">   System Tools</span><br></pre></td></tr></table></figure><ul><li>安装Server with GUI</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@yongstoneinc yum.repos.d]<span class="comment"># yum groupinstall "Server with GUI"</span></span><br><span class="line">Last metadata expiration check: 0:05:31 ago on Thu 13 Aug 2020 12:47:36 AM CST.</span><br><span class="line">no group <span class="string">'dns-server'</span> from environment <span class="string">'graphical-server-environment'</span></span><br><span class="line">No match <span class="keyword">for</span> group package <span class="string">"insights-client"</span></span><br><span class="line">No match <span class="keyword">for</span> group package <span class="string">"hpijs"</span></span><br><span class="line">No match <span class="keyword">for</span> group package <span class="string">"centos-release-eula"</span></span><br><span class="line">Dependencies resolved.</span><br><span class="line">......</span><br><span class="line">Transaction Summary</span><br><span class="line">==============================================================================================</span><br><span class="line">Install  929 Packages</span><br></pre></td></tr></table></figure><ul><li>将模式的命令行模式修改图形模式</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@yongstoneinc ~]<span class="comment"># systemctl get-default</span></span><br><span class="line">multi-user.target</span><br><span class="line">[root@yongstoneinc ~]<span class="comment"># systemctl set-default graphical.target</span></span><br><span class="line">Removed /etc/systemd/system/default.target.</span><br><span class="line">Created symlink /etc/systemd/system/default.target → /usr/lib/systemd/system/graphical.target.</span><br></pre></td></tr></table></figure><ul><li>卸载Server with GUI</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@yongstoneinc yum.repos.d]<span class="comment"># yum groupremove "Server with GUI"</span></span><br><span class="line">Last metadata expiration check: 0:05:31 ago on Thu 13 Aug 2020 12:47:36 AM CST.</span><br><span class="line">no group <span class="string">'dns-server'</span> from environment <span class="string">'graphical-server-environment'</span></span><br><span class="line">No match <span class="keyword">for</span> group package <span class="string">"insights-client"</span></span><br><span class="line">No match <span class="keyword">for</span> group package <span class="string">"hpijs"</span></span><br><span class="line">No match <span class="keyword">for</span> group package <span class="string">"centos-release-eula"</span></span><br><span class="line">Dependencies resolved.</span><br><span class="line">......</span><br><span class="line">Transaction Summary</span><br><span class="line">==============================================================================================</span><br><span class="line">Install  929 Packages</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;ul&gt;
&lt;li&gt;Centos 8 系列如果默认以文本模式或者最小话安装，后期需要安装图形桌面的安装及设置&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="Linux" scheme="http://falkon.cn/categories/Linux/"/>
    
    
    <category term="CentOS8" scheme="http://falkon.cn/tags/CentOS8/"/>
    
  </entry>
  
  <entry>
    <title>The plug-in BI Publisher Configuration has failed its perform method</title>
    <link href="http://falkon.cn/2021/01/27/database/the-plug-in-bi-iublisher-configuration-has-failed-its-perform-method/"/>
    <id>http://falkon.cn/2021/01/27/database/the-plug-in-bi-iublisher-configuration-has-failed-its-perform-method/</id>
    <published>2021-01-27T09:37:22.726Z</published>
    <updated>2021-01-27T03:13:23.135Z</updated>
    
    <content type="html"><![CDATA[<ul><li><p>平台：Oracle Linux 7.8</p></li><li><p>数据库： Oracle database 19c</p></li><li><p>EMCC： 13.4.0.0.0</p></li><li><p>19c &amp; EMCC13.4安装到%78日志报The plug-in BI Publisher Configuration has failed its perform method</p></li><li><p>CfmLogger_2020-06-07_03-20-28-PM.log</p></li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">INFO: oracle.sysman.top.oms:start writing</span><br><span class="line">INFO: oracle.sysman.top.oms:data written successfully</span><br><span class="line">INFO: oracle.sysman.top.oms:file flush successfully</span><br><span class="line">INFO: oracle.sysman.top.oms:file closed successfully</span><br><span class="line">INFO: oracle.sysman.top.oms:The plug-in BI Publisher Configuration has failed its perform method</span><br><span class="line">INFO: Cfm.save() was called</span><br><span class="line">INFO: Cfm.save(): 5 aggregate instances saved</span><br><span class="line">INFO: <span class="keyword">done</span> waiting <span class="keyword">for</span> Action from 18:05:05.846</span><br></pre></td></tr></table></figure><a id="more"></a><ul><li>bipca_20200607165716.log</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[] [oracle.sysman.bipca] [host: pe-dbmonitor-emcc] [nwaddr: 10.10.251.102] [tid: 1] [userId: oracle] [ecid: ba168280-6f23-49f3-ac9f-cb73fd25b363-00000002,0] [SRC_CLASS: oracle.sysman.sdkImpl.core.ip.model.bipca.BIPCA] [SRC_METHOD: lockEM]             Starting BI Publisher ...</span><br><span class="line">[2020-06-07T17:02:16.942+08:00] [sysman] [NOTIFICATION] [] [oracle.sysman.bipca] [host: pe-dbmonitor-emcc] [nwaddr: 10.10.251.102] [tid: 1] [userId: oracle] [ecid: ba168280-6f23-49f3-ac9f-cb73fd25b363-00000002,0] [SRC_CLASS: oracle.sysman.sdkImpl.core.ip.model.bipca.BIPCA] [SRC_METHOD: execCommand] Executing the <span class="built_in">command</span>: /u01/app/oracle/Middleware/bin/emctl  start oms  -bip_only  -debug</span><br><span class="line">[2020-06-07T17:02:17.544+08:00] [sysman] [NOTIFICATION] [] [oracle.sysman.bipca] [host: pe-dbmonitor-emcc] [nwaddr: 10.10.251.102] [tid: 46] [userId: oracle] [ecid: ba168280-6f23-49f3-ac9f-cb73fd25b363-00000002,0] [SRC_CLASS: oracle.sysman.sdkImpl.core.ip.model.bipca.ProcessOutputReader] [SRC_METHOD: run] Oracle Enterprise Manager Cloud Control 13c Release 4</span><br><span class="line">[2020-06-07T17:02:17.544+08:00] [sysman] [NOTIFICATION] [] [oracle.sysman.bipca] [host: pe-dbmonitor-emcc] [nwaddr: 10.10.251.102] [tid: 46] [userId: oracle] [ecid: ba168280-6f23-49f3-ac9f-cb73fd25b363-00000002,0] [SRC_CLASS: oracle.sysman.sdkImpl.core.ip.model.bipca.ProcessOutputReader] [SRC_METHOD: run] Copyright (c) 1996, 2020 Oracle Corporation.  All rights reserved.</span><br><span class="line">[2020-06-07T17:02:18.332+08:00] [sysman] [NOTIFICATION] [] [oracle.sysman.bipca] [host: pe-dbmonitor-emcc] [nwaddr: 10.10.251.102] [tid: 46] [userId: oracle] [ecid: ba168280-6f23-49f3-ac9f-cb73fd25b363-00000002,0] [SRC_CLASS: oracle.sysman.sdkImpl.core.ip.model.bipca.ProcessOutputReader] [SRC_METHOD: run] Starting BI Publisher Server only.</span><br><span class="line">[2020-06-07T17:02:18.342+08:00] [sysman] [NOTIFICATION] [] [oracle.sysman.bipca] [host: pe-dbmonitor-emcc] [nwaddr: 10.10.251.102] [tid: 46] [userId: oracle] [ecid: ba168280-6f23-49f3-ac9f-cb73fd25b363-00000002,0] [SRC_CLASS: oracle.sysman.sdkImpl.core.ip.model.bipca.ProcessOutputReader] [SRC_METHOD: run] Starting BI Publisher Server at: Jun 7, 2020 17:02:18 PM CST</span><br><span class="line">[2020-06-07T17:02:18.342+08:00] [sysman] [NOTIFICATION] [] [oracle.sysman.bipca] [host: pe-dbmonitor-emcc] [nwaddr: 10.10.251.102] [tid: 46] [userId: oracle] [ecid: ba168280-6f23-49f3-ac9f-cb73fd25b363-00000002,0] [SRC_CLASS: oracle.sysman.sdkImpl.core.ip.model.bipca.ProcessOutputReader] [SRC_METHOD: run] Starting BI Publisher Server ...</span><br><span class="line">[2020-06-07T17:05:03.342+08:00] [sysman] [NOTIFICATION] [] [oracle.sysman.bipca] [host: pe-dbmonitor-emcc] [nwaddr: 10.10.251.102] [tid: 46] [userId: oracle] [ecid: ba168280-6f23-49f3-ac9f-cb73fd25b363-00000002,0] [SRC_CLASS: oracle.sysman.sdkImpl.core.ip.model.bipca.ProcessOutputReader] [SRC_METHOD: run] WebTier Could Not Be Started.</span><br><span class="line">[2020-06-07T17:05:03.347+08:00] [sysman] [NOTIFICATION] [] [oracle.sysman.bipca] [host: pe-dbmonitor-emcc] [nwaddr: 10.10.251.102] [tid: 46] [userId: oracle] [ecid: ba168280-6f23-49f3-ac9f-cb73fd25b363-00000002,0] [SRC_CLASS: oracle.sysman.sdkImpl.core.ip.model.bipca.ProcessOutputReader] [SRC_METHOD: run] Error Occurred: WebTier Could Not Be Started.</span><br><span class="line">[2020-06-07T17:05:03.347+08:00] [sysman] [NOTIFICATION] [] [oracle.sysman.bipca] [host: pe-dbmonitor-emcc] [nwaddr: 10.10.251.102] [tid: 46] [userId: oracle] [ecid: ba168280-6f23-49f3-ac9f-cb73fd25b363-00000002,0] [SRC_CLASS: oracle.sysman.sdkImpl.core.ip.model.bipca.ProcessOutputReader] [SRC_METHOD: run] Please check /u01/app/oracle/gc_inst/em/EMGC_OMS1/sysman/<span class="built_in">log</span>/emctl.log <span class="keyword">for</span> error details</span><br><span class="line">[2020-06-07T17:05:03.381+08:00] [sysman] [NOTIFICATION] [] [oracle.sysman.bipca] [host: pe-dbmonitor-emcc] [nwaddr: 10.10.251.102] [tid: 1] [userId: oracle] [ecid: ba168280-6f23-49f3-ac9f-cb73fd25b363-00000002,0] [SRC_CLASS: oracle.sysman.sdkImpl.core.ip.model.bipca.BIPCA] [SRC_METHOD: execCommand] Exit code from <span class="built_in">command</span>: 1</span><br><span class="line">[2020-06-07T17:05:03.381+08:00] [sysman] [ERROR] [] [oracle.sysman.bipca] [host: pe-dbmonitor-emcc] [nwaddr: 10.10.251.102] [tid: 1] [userId: oracle] [ecid: ba168280-6f23-49f3-ac9f-cb73fd25b363-00000002,0] [SRC_CLASS: oracle.sysman.sdkImpl.core.ip.model.bipca.BIPCA] [SRC_METHOD: execCommand] </span><br><span class="line">[2020-06-07T17:05:03.383+08:00] [sysman] [ERROR] [] [oracle.sysman.bipca] [host: pe-dbmonitor-emcc] [nwaddr: 10.10.251.102] [tid: 1] [userId: oracle] [ecid: ba168280-6f23-49f3-ac9f-cb73fd25b363-00000002,0] [SRC_CLASS: oracle.sysman.sdkImpl.core.ip.model.bipca.BIPCA] [SRC_METHOD: lockEM]             Failed to start Enterprise Manager. Diagnostic code 1.</span><br><span class="line">[2020-06-07T17:05:03.384+08:00] [sysman] [ERROR] [] [oracle.sysman.bipca] [host: pe-dbmonitor-emcc] [nwaddr: 10.10.251.102] [tid: 1] [userId: oracle] [ecid: ba168280-6f23-49f3-ac9f-cb73fd25b363-00000002,0] [SRC_CLASS: oracle.sysman.sdkImpl.core.ip.model.bipca.BIPCA] [SRC_METHOD: extendDomainWithBIP] See <span class="built_in">log</span> at /u01/app/oracle/Middleware/cfgtoollogs/bip/bipca_20200607165716.log <span class="keyword">for</span> details.</span><br><span class="line">[2020-06-07T17:05:03.384+08:00] [sysman] [ERROR] [] [oracle.sysman.bipca] [host: pe-dbmonitor-emcc] [nwaddr: 10.10.251.102] [tid: 1] [userId: oracle] [ecid: ba168280-6f23-49f3-ac9f-cb73fd25b363-00000002,0] [SRC_CLASS: oracle.sysman.sdkImpl.core.ip.model.bipca.BIPCA] [SRC_METHOD: handleFatalError] Error extending domain</span><br><span class="line">[2020-06-07T17:05:03.385+08:00] [sysman] [ERROR] [] [oracle.sysman.bipca] [host: pe-dbmonitor-emcc] [nwaddr: 10.10.251.102] [tid: 1] [userId: oracle] [ecid: ba168280-6f23-49f3-ac9f-cb73fd25b363-00000002,0] [SRC_CLASS: oracle.sysman.sdkImpl.core.ip.model.bipca.BIPCA] [SRC_METHOD: handleFatalError] Fatal error:[[</span><br><span class="line">java.lang.Exception: See <span class="built_in">log</span> at /u01/app/oracle/Middleware/cfgtoollogs/bip/bipca_20200607165716.log <span class="keyword">for</span> details.</span><br><span class="line">at oracle.sysman.sdkImpl.core.ip.model.bipca.BIPCA.extendDomainWithBIP(BIPCA.java:3924)</span><br><span class="line">at oracle.sysman.sdkImpl.core.ip.model.bipca.BIPCA.main(BIPCA.java:2176)</span><br></pre></td></tr></table></figure><ul><li><p>emctl.log</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">2020-06-07 17:05:02,602 [Thread-1] INFO  commands.BaseCommand run.610 - &lt;OUT&gt;NMProcess: INFO: /u01/app/oracle/Middleware/ohs/bin/httpd: error <span class="keyword">while</span> loading shared libraries: libclntshcore.so.12.1: cannot open shared object file: No such file or directory</span><br><span class="line">2020-06-07 17:05:02,906 [Thread-1] INFO  commands.BaseCommand run.610 - &lt;OUT&gt;NMProcess: Jun 07, 2020 5:05:02 PM oracle.ohs.plugin.nodemanager.OhsRunCommand execute</span><br><span class="line">2020-06-07 17:05:02,906 [Thread-1] INFO  commands.BaseCommand run.610 - &lt;OUT&gt;NMProcess: SEVERE: /u01/app/oracle/Middleware/ohs/bin/launch httpd -DOHS_MPM_WORKER -d /u01/app/oracle/gc_inst/user_projects/domains/GCDomain/config/fmwconfig/components/OHS/instances/ohs1 -k start -f /u01/app/oracle/gc_inst/user_projects/domains/GCDomain/config/fmwconfig/components/OHS/instances/ohs1/httpd.conf: <span class="built_in">exit</span> status = 127</span><br><span class="line">2020-06-07 17:05:02,906 [Thread-1] INFO  commands.BaseCommand run.610 - &lt;OUT&gt;NMProcess: Jun 07, 2020 5:05:02 PM oracle.ohs.plugin.nodemanager.OhsProcessHandler buildProcess</span><br><span class="line">2020-06-07 17:05:02,906 [Thread-1] INFO  commands.BaseCommand run.610 - &lt;OUT&gt;NMProcess: INFO: Check the instance <span class="built_in">log</span> file <span class="keyword">for</span> more information: /u01/app/oracle/gc_inst/user_projects/domains/GCDomain/servers/ohs1/logs/ohs1.log</span><br><span class="line">2020-06-07 17:05:02,906 [Thread-1] INFO  commands.BaseCommand run.610 - &lt;OUT&gt;NMProcess: Jun 07, 2020 5:05:02 PM oracle.ohs.plugin.nodemanager.OhsProcessManagementPlugin<span class="variable">$ProcessImpl</span> buildIoException</span><br><span class="line">2020-06-07 17:05:02,907 [Thread-1] INFO  commands.BaseCommand run.610 - &lt;OUT&gt;NMProcess: SEVERE: Failed to start the server ohs1</span><br></pre></td></tr></table></figure></li><li><p>处理方法</p></li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">[oracle@pe-dbmonitor-emcc Middleware]$ cp ./bi/products/Essbase/EssbaseServer/bin/libclntshcore.so.12.1 /u01/app/oracle/Middleware/lib/</span><br><span class="line">[oracle@pe-dbmonitor-emcc Middleware]$ <span class="built_in">cd</span> bin/</span><br><span class="line">[oracle@pe-dbmonitor-emcc bin]$ ./emctl stop oms -all -force</span><br><span class="line">Oracle Enterprise Manager Cloud Control 13c Release 4  </span><br><span class="line">Copyright (c) 1996, 2020 Oracle Corporation.  All rights reserved.</span><br><span class="line">Stopping Oracle Management Server...</span><br><span class="line">WebTier Successfully Stopped</span><br><span class="line">Node Manager Not Running</span><br><span class="line">Oracle Management Server is Down</span><br><span class="line">JVMD Engine is Down</span><br><span class="line">BI Publisher Server is Down</span><br><span class="line">[oracle@pe-dbmonitor-emcc bin]$ ./emctl start oms -admin_only</span><br><span class="line">Oracle Enterprise Manager Cloud Control 13c Release 4  </span><br><span class="line">Copyright (c) 1996, 2020 Oracle Corporation.  All rights reserved.</span><br><span class="line">Starting Admin Server only...</span><br><span class="line">Admin Server Successfully Started </span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果图形界面未关闭，点击retry按钮，完成后运行root脚本</span></span><br><span class="line">[root@pe-dbmonitor-emcc ~]<span class="comment"># /u01/app/oracle/Middleware/allroot.sh </span></span><br><span class="line"></span><br><span class="line">Starting to execute allroot.sh ......... </span><br><span class="line"></span><br><span class="line">Starting to execute /u01/app/oracle/Middleware/root.sh ......</span><br><span class="line">Performing root user operation.</span><br><span class="line"></span><br><span class="line">The following environment variables are <span class="built_in">set</span> as:</span><br><span class="line">    ORACLE_OWNER= oracle</span><br><span class="line">    ORACLE_HOME=  /u01/app/oracle/Middleware</span><br><span class="line"></span><br><span class="line">Enter the full pathname of the <span class="built_in">local</span> bin directory: [/usr/<span class="built_in">local</span>/bin]: </span><br><span class="line">The contents of <span class="string">"dbhome"</span> have not changed. No need to overwrite.</span><br><span class="line">The file <span class="string">"oraenv"</span> already exists <span class="keyword">in</span> /usr/<span class="built_in">local</span>/bin.  Overwrite it? (y/n) </span><br><span class="line">[n]:  </span><br><span class="line">The file <span class="string">"coraenv"</span> already exists <span class="keyword">in</span> /usr/<span class="built_in">local</span>/bin.  Overwrite it? (y/n) </span><br><span class="line">[n]: y</span><br><span class="line">   Copying coraenv to /usr/<span class="built_in">local</span>/bin ...</span><br><span class="line"></span><br><span class="line">Entries will be added to the /etc/oratab file as needed by</span><br><span class="line">Database Configuration Assistant when a database is created</span><br><span class="line">Finished running generic part of root script.</span><br><span class="line">Now product-specific root actions will be performed.</span><br><span class="line">/etc exist</span><br><span class="line"></span><br><span class="line">Creating /etc/oragchomelist file...</span><br><span class="line">/u01/app/oracle/Middleware</span><br><span class="line"></span><br><span class="line">Finished product-specific root actions.</span><br><span class="line">/etc exist</span><br><span class="line">Finished execution of  /u01/app/oracle/Middleware/root.sh ......</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Starting to execute /u01/app/oracle/MiddlewareAgent/agent_13.4.0.0.0/root.sh ......</span><br><span class="line"></span><br><span class="line">Finished product-specific root actions.</span><br><span class="line">/etc exist</span><br><span class="line">Finished execution of  /u01/app/oracle/MiddlewareAgent/agent_13.4.0.0.0/root.sh ...</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果图形界面已经被关闭，请参考官方文档[2637385.1]</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;ul&gt;
&lt;li&gt;&lt;p&gt;平台：Oracle Linux 7.8&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;数据库： Oracle database 19c&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;EMCC： 13.4.0.0.0&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;19c &amp;amp; EMCC13.4安装到%78日志报The plug-in BI Publisher Configuration has failed its perform method&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;CfmLogger_2020-06-07_03-20-28-PM.log&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight sh&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;INFO: oracle.sysman.top.oms:start writing&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;INFO: oracle.sysman.top.oms:data written successfully&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;INFO: oracle.sysman.top.oms:file flush successfully&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;INFO: oracle.sysman.top.oms:file closed successfully&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;INFO: oracle.sysman.top.oms:The plug-in BI Publisher Configuration has failed its perform method&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;INFO: Cfm.save() was called&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;INFO: Cfm.save(): 5 aggregate instances saved&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;INFO: &lt;span class=&quot;keyword&quot;&gt;done&lt;/span&gt; waiting &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; Action from 18:05:05.846&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="Oracle Enterprise Manager Cloud Control" scheme="http://falkon.cn/categories/Oracle-Enterprise-Manager-Cloud-Control/"/>
    
    
    <category term="EMCC" scheme="http://falkon.cn/tags/EMCC/"/>
    
    <category term="19c" scheme="http://falkon.cn/tags/19c/"/>
    
  </entry>
  
  <entry>
    <title>SQL Server 2019 Installation for CentOS 7.8</title>
    <link href="http://falkon.cn/2021/01/27/database/sqlserver-2019-installation-centos78/"/>
    <id>http://falkon.cn/2021/01/27/database/sqlserver-2019-installation-centos78/</id>
    <published>2021-01-27T09:37:22.716Z</published>
    <updated>2021-01-27T13:03:57.265Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Microsoft-SQL-Server-For-Linux-installation-packages-description"><a href="#Microsoft-SQL-Server-For-Linux-installation-packages-description" class="headerlink" title="Microsoft SQL Server For Linux installation packages description"></a>Microsoft SQL Server For Linux installation packages description</h2><p>mssql-cli.x86_64 : Microsoft SQL Server CLI<br>mssql-mlservices-mlm-py-9.4.5.x86_64.x86_64 : Microsoft Machine Learning Services<br>mssql-mlservices-mlm-r-9.4.5.x86_64.x86_64 : Microsoft Machine Learning Services<br>mssql-mlservices-mml-py-9.4.5.x86_64.x86_64 : Microsoft Machine Learning Services<br>mssql-mlservices-mml-r-9.4.5.x86_64.x86_64 : Microsoft Machine Learning Services<br>mssql-mlservices-packages-py-9.4.5.x86_64.x86_64 : Microsoft Machine Learning Services<br>mssql-mlservices-packages-r-9.4.5.x86_64.x86_64 : Microsoft Machine Learning Services<br>mssql-mlservices-python-9.4.5.x86_64.x86_64 : Microsoft Machine Learning Services<br>mssql-server.x86_64 : Microsoft SQL Server Relational Database Engine<br>mssql-server-extensibility.x86_64 : Extensibility support for Microsoft SQL Server Relational Database Engine<br>mssql-server-extensibility-java.x86_64 : Extensibility Java language support for Microsoft SQL Server Relational Database Engine<br>mssql-server-fts.x86_64 : Microsoft SQL Server Full Text Search<br>mssql-server-ha.x86_64 : High Availability support for Microsoft SQL Server Relational Database Engine<br>mssql-server-is.x86_64 : Microsoft SQL Server Integration Services<br>mssql-tools.x86_64 : Tools for Microsoft(R) SQL Server (R)<br>mssql-server-polybase-15.0.4073.23-4.x86_64 : Microsoft SQL Server Polybase for SQL server,Oracle,Teradata,Mongodb<br>mssql-server-polybase-hadoop-15.0.4073.23-4.x86 : Microsoft SQL Server Polybase for Hadoop</p><h2 id="MSSQL-2019在Centos-7-8上的安装"><a href="#MSSQL-2019在Centos-7-8上的安装" class="headerlink" title="MSSQL 2019在Centos 7.8上的安装"></a>MSSQL 2019在Centos 7.8上的安装</h2><ul><li>配置hosts</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@lmssql2019 home]<span class="comment"># cat /etc/hosts</span></span><br><span class="line">127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br><span class="line">::1         localhost localhost.localdomain localhost6 localhost6.localdomain6</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Microsoft SQL Server hosts configuration</span></span><br><span class="line">10.10.251.147lmssql2019</span><br></pre></td></tr></table></figure><ul><li>关闭防火墙</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@lmssql2019 home]<span class="comment"># systemctl stop firewalld</span></span><br><span class="line">[root@lmssql2019 home]<span class="comment"># systemctl disable firewalld</span></span><br><span class="line">Removed symlink /etc/systemd/system/multi-user.target.wants/firewalld.service.</span><br><span class="line">Removed symlink /etc/systemd/system/dbus-org.fedoraproject.FirewallD1.servic</span><br></pre></td></tr></table></figure><ul><li>永久关闭selinux</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@lmssql2019 home]<span class="comment"># vi /etc/sysconfig/selinux </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># This file controls the state of SELinux on the system.</span></span><br><span class="line"><span class="comment"># SELINUX= can take one of these three values:</span></span><br><span class="line"><span class="comment">#     enforcing - SELinux security policy is enforced.</span></span><br><span class="line"><span class="comment">#     permissive - SELinux prints warnings instead of enforcing.</span></span><br><span class="line"><span class="comment">#     disabled - No SELinux policy is loaded.</span></span><br><span class="line">SELINUX=disabled</span><br><span class="line"><span class="comment"># SELINUXTYPE= can take one of three values:</span></span><br><span class="line"><span class="comment">#     targeted - Targeted processes are protected,</span></span><br><span class="line"><span class="comment">#     minimum - Modification of targeted policy. Only selected processes are protected.</span></span><br><span class="line"><span class="comment">#     mls - Multi Level Security protection.</span></span><br><span class="line">SELINUXTYPE=targete</span><br></pre></td></tr></table></figure><ul><li>使用sftp上传安装包</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@lmssql2019 home]<span class="comment"># ll</span></span><br><span class="line">total 274000</span><br><span class="line">drwx------. 3 cts8 cts8        78 Dec 22 20:22 cts8</span><br><span class="line">-rw-r--r--. 1 root root    807292 Dec 22 22:19 msodbcsql17-17.6.1.1-1.x86_64.rpm</span><br><span class="line">-rw-r--r--. 1 root root  58954712 Dec 22 22:19 mssql-cli-1.0.0-1.el7.x86_64.rpm</span><br><span class="line">-rw-r--r--. 1 root root 220310804 Dec 22 21:32 mssql-server-15.0.4073.23-4.x86_64.rpm</span><br><span class="line">-rw-r--r--. 1 root root    228628 Dec 22 22:19 mssql-tools-17.6.1.1-1.x86_64.rpm</span><br><span class="line">-rw-r--r--. 1 root root    217872 Dec 22 22:27 unixODBC-2.3.7-1.rh.x86_64.rpm</span><br><span class="line">-rw-r--r--. 1 root root     43504 Dec 22 22:19 unixODBC-devel-2.3.7-1.rh.x86_64.rpm</span><br></pre></td></tr></table></figure><ul><li>安装MSSQL数据库</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@lmssql2019 home]<span class="comment"># rpm -ivh mssql-server-15.0.4073.23-4.x86_64.rpm </span></span><br><span class="line">warning: mssql-server-15.0.4073.23-4.x86_64.rpm: Header V4 RSA/SHA256 Signature, key ID be1229cf: NOKEY</span><br><span class="line">Preparing...                          <span class="comment">################################# [100%]</span></span><br><span class="line">Updating / installing...</span><br><span class="line">   1:mssql-server-15.0.4073.23-4      <span class="comment">################################# [100%]</span></span><br><span class="line"></span><br><span class="line">+--------------------------------------------------------------+</span><br><span class="line">Please run <span class="string">'sudo /opt/mssql/bin/mssql-conf setup'</span></span><br><span class="line">to complete the setup of Microsoft SQL Server</span><br><span class="line">+--------------------------------------------------------------+</span><br></pre></td></tr></table></figure><ul><li>配置MSSQL数据库</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">[root@lmssql2019 home]<span class="comment"># /opt/mssql/bin/mssql-conf setup</span></span><br><span class="line">usermod: no changes</span><br><span class="line">Choose an edition of SQL Server:</span><br><span class="line">  1) Evaluation (free, no production use rights, 180-day <span class="built_in">limit</span>)</span><br><span class="line">  2) Developer (free, no production use rights)</span><br><span class="line">  3) Express (free)</span><br><span class="line">  4) Web (PAID)</span><br><span class="line">  5) Standard (PAID)</span><br><span class="line">  6) Enterprise (PAID) - CPU Core utilization restricted to 20 physical/40 hyperthreaded</span><br><span class="line">  7) Enterprise Core (PAID) - CPU Core utilization up to Operating System Maximum</span><br><span class="line">  8) I bought a license through a retail sales channel and have a product key to enter.</span><br><span class="line"></span><br><span class="line">Details about editions can be found at</span><br><span class="line">https://go.microsoft.com/fwlink/?LinkId=2109348&amp;clcid=0x409</span><br><span class="line"></span><br><span class="line">Use of PAID editions of this software requires separate licensing through a</span><br><span class="line">Microsoft Volume Licensing program.</span><br><span class="line">By choosing a PAID edition, you are verifying that you have the appropriate</span><br><span class="line">number of licenses <span class="keyword">in</span> place to install and run this software.</span><br><span class="line"></span><br><span class="line">Enter your edition(1-8): 5      <span class="comment">#选择标准版，客户购买的是标准版</span></span><br><span class="line">The license terms <span class="keyword">for</span> this product can be found <span class="keyword">in</span></span><br><span class="line">/usr/share/doc/mssql-server or downloaded from:</span><br><span class="line">https://go.microsoft.com/fwlink/?LinkId=2104294&amp;clcid=0x409            <span class="comment"># 许可条款</span></span><br><span class="line"></span><br><span class="line">The privacy statement can be viewed at:</span><br><span class="line">https://go.microsoft.com/fwlink/?LinkId=853010&amp;clcid=0x409             <span class="comment"># 隐私声明</span></span><br><span class="line"></span><br><span class="line">Do you accept the license terms? [Yes/No]:yes</span><br><span class="line"></span><br><span class="line">Enter the SQL Server system administrator password:         <span class="comment"># 如果用户无特殊要求，默认密码为PP--ssw00rd</span></span><br><span class="line">Confirm the SQL Server system administrator password: </span><br><span class="line">Configuring SQL Server...</span><br><span class="line"></span><br><span class="line">The licensing PID was successfully processed. The new edition is [Standard Edition].</span><br><span class="line">ForceFlush is enabled <span class="keyword">for</span> this instance. </span><br><span class="line">ForceFlush feature is enabled <span class="keyword">for</span> <span class="built_in">log</span> durability.</span><br><span class="line">Created symlink from /etc/systemd/system/multi-user.target.wants/mssql-server.service to /usr/lib/systemd/system/mssql-server.service.</span><br><span class="line">Setup has completed successfully. SQL Server is now starting.</span><br></pre></td></tr></table></figure><ul><li>查看mssql-server的服务状态</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[root@lmssql2019 home]<span class="comment"># systemctl status mssql-server</span></span><br><span class="line">● mssql-server.service - Microsoft SQL Server Database Engine</span><br><span class="line">   Loaded: loaded (/usr/lib/systemd/system/mssql-server.service; enabled; vendor preset: disabled)</span><br><span class="line">   Active: active (running) since Tue 2020-12-22 21:42:41 CST; 38min ago</span><br><span class="line">     Docs: https://docs.microsoft.com/en-us/sql/linux</span><br><span class="line"> Main PID: 12580 (sqlservr)</span><br><span class="line">   CGroup: /system.slice/mssql-server.service</span><br><span class="line">           ├─12580 /opt/mssql/bin/sqlservr</span><br><span class="line">           └─12604 /opt/mssql/bin/sqlservr</span><br><span class="line"></span><br><span class="line">Dec 22 21:42:48 lmssql2019 sqlservr[12580]: 2020-12-22 21:42:48.90 spid9s     ....</span><br><span class="line">Dec 22 21:42:50 lmssql2019 sqlservr[12580]: 2020-12-22 21:42:50.42 spid9s     ....</span><br><span class="line">Dec 22 21:42:50 lmssql2019 sqlservr[12580]: 2020-12-22 21:42:50.42 spid9s     ....</span><br><span class="line">Dec 22 21:42:51 lmssql2019 sqlservr[12580]: 2020-12-22 21:42:51.41 spid9s     ....</span><br><span class="line">Dec 22 21:42:51 lmssql2019 sqlservr[12580]: 2020-12-22 21:42:51.45 spid28s    ....</span><br><span class="line">Dec 22 21:42:51 lmssql2019 sqlservr[12580]: 2020-12-22 21:42:51.45 spid28s    ....</span><br><span class="line">Dec 22 21:42:51 lmssql2019 sqlservr[12580]: 2020-12-22 21:42:51.57 spid28s    ....</span><br><span class="line">Dec 22 21:42:51 lmssql2019 sqlservr[12580]: 2020-12-22 21:42:51.57 spid8s     ....</span><br><span class="line">Dec 22 21:42:51 lmssql2019 sqlservr[12580]: 2020-12-22 21:42:51.74 spid14s    ....</span><br><span class="line">Dec 22 21:42:51 lmssql2019 sqlservr[12580]: 2020-12-22 21:42:51.74 spid14s    ....</span><br><span class="line">Hint: Some lines were ellipsized, use -l to show <span class="keyword">in</span> full.</span><br></pre></td></tr></table></figure><ul><li>设置mssql-server开机启动</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@lmssql2019 home]<span class="comment"># systemctl enable mssql-server</span></span><br></pre></td></tr></table></figure><ul><li>安装客户端</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装依赖，从ISO镜像安装</span></span><br><span class="line">[root@lmssql2019 yum.repos.d]<span class="comment"># yum -y install libunwind</span></span><br><span class="line">Loaded plugins: fastestmirror, langpacks</span><br><span class="line">Loading mirror speeds from cached hostfile</span><br><span class="line">c7-media                                                   | 3.6 kB  00:00:00     </span><br><span class="line">(1/2): c7-media/group_gz                                   | 153 kB  00:00:00     </span><br><span class="line">(2/2): c7-media/primary_db                                 | 3.3 MB  00:00:00     </span><br><span class="line">Resolving Dependencies</span><br><span class="line">--&gt; Running transaction check</span><br><span class="line">---&gt; Package libunwind.x86_64 2:1.2-2.el7 will be installed</span><br><span class="line">--&gt; Finished Dependency Resolution</span><br><span class="line"></span><br><span class="line">Dependencies Resolved</span><br><span class="line"></span><br><span class="line">==================================================================================</span><br><span class="line"> Package            Arch            Version               Repository         Size</span><br><span class="line">==================================================================================</span><br><span class="line">Installing:</span><br><span class="line"> libunwind          x86_64          2:1.2-2.el7           c7-media           57 k</span><br><span class="line"></span><br><span class="line">Transaction Summary</span><br><span class="line">==================================================================================</span><br><span class="line">Install  1 Package</span><br><span class="line"></span><br><span class="line">Total download size: 57 k</span><br><span class="line">Installed size: 150 k</span><br><span class="line">Downloading packages:</span><br><span class="line">warning: /media/Packages/libunwind-1.2-2.el7.x86_64.rpm: Header V3 RSA/SHA256 Signature, key ID f4a80eb5: NOKEY</span><br><span class="line">Public key <span class="keyword">for</span> libunwind-1.2-2.el7.x86_64.rpm is not installed</span><br><span class="line">Retrieving key from file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7</span><br><span class="line">Importing GPG key 0xF4A80EB5:</span><br><span class="line"> Userid     : <span class="string">"CentOS-7 Key (CentOS 7 Official Signing Key) &lt;security@centos.org&gt;"</span></span><br><span class="line"> Fingerprint: 6341 ab27 53d7 8a78 a7c2 7bb1 24c6 a8a7 f4a8 0eb5</span><br><span class="line"> Package    : centos-release-7-8.2003.0.el7.centos.x86_64 (@anaconda)</span><br><span class="line"> From       : /etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7</span><br><span class="line">Running transaction check</span><br><span class="line">Running transaction <span class="built_in">test</span></span><br><span class="line">Transaction <span class="built_in">test</span> succeeded</span><br><span class="line">Running transaction</span><br><span class="line">Warning: RPMDB altered outside of yum.</span><br><span class="line">  Installing : 2:libunwind-1.2-2.el7.x86_64                                   1/1 </span><br><span class="line">  Verifying  : 2:libunwind-1.2-2.el7.x86_64                                   1/1 </span><br><span class="line"></span><br><span class="line">Installed:</span><br><span class="line">  libunwind.x86_64 2:1.2-2.el7                                                    </span><br><span class="line"></span><br><span class="line">Complete!</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装unixODBC</span></span><br><span class="line">[root@lmssql2019 home]<span class="comment"># rpm -ivh unixODBC-2.3.7-1.rh.x86_64.rpm </span></span><br><span class="line">warning: unixODBC-2.3.7-1.rh.x86_64.rpm: Header V4 RSA/SHA256 Signature, key ID be1229cf: NOKEY</span><br><span class="line">Preparing...                          <span class="comment">################################# [100%]</span></span><br><span class="line">Updating / installing...</span><br><span class="line">   1:unixODBC-2.3.7-1.rh              <span class="comment">################################# [100%]</span></span><br><span class="line">[root@lmssql2019 home]<span class="comment"># </span></span><br><span class="line">[root@lmssql2019 home]<span class="comment"># rpm -ivh unixODBC-devel-2.3.7-1.rh.x86_64.rpm </span></span><br><span class="line">warning: unixODBC-devel-2.3.7-1.rh.x86_64.rpm: Header V4 RSA/SHA256 Signature, key ID be1229cf: NOKEY</span><br><span class="line">Preparing...                          <span class="comment">################################# [100%]</span></span><br><span class="line">Updating / installing...</span><br><span class="line">   1:unixODBC-devel-2.3.7-1.rh        <span class="comment">################################# [100%]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装msodbcsql</span></span><br><span class="line">[root@lmssql2019 home]<span class="comment"># rpm -ivh msodbcsql17-17.6.1.1-1.x86_64.rpm </span></span><br><span class="line">warning: msodbcsql17-17.6.1.1-1.x86_64.rpm: Header V4 RSA/SHA256 Signature, key ID be1229cf: NOKEY</span><br><span class="line">Preparing...                          <span class="comment">################################# [100%]</span></span><br><span class="line">The license terms <span class="keyword">for</span> this product can be downloaded from</span><br><span class="line">https://aka.ms/odbc17eula and found <span class="keyword">in</span></span><br><span class="line">/usr/share/doc/msodbcsql17/LICENSE.txt . By entering <span class="string">'YES'</span>,</span><br><span class="line">you indicate that you accept the license terms.</span><br><span class="line"></span><br><span class="line">Do you accept the license terms? (Enter YES or NO)</span><br><span class="line">yes</span><br><span class="line">Updating / installing...</span><br><span class="line">   1:msodbcsql17-17.6.1.1-1           <span class="comment">################################# [100%]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装mssql-tools</span></span><br><span class="line">[root@lmssql2019 home]<span class="comment"># rpm -ivh mssql-tools-17.6.1.1-1.x86_64.rpm </span></span><br><span class="line">warning: mssql-tools-17.6.1.1-1.x86_64.rpm: Header V4 RSA/SHA256 Signature, key ID be1229cf: NOKEY</span><br><span class="line">Preparing...                          <span class="comment">################################# [100%]</span></span><br><span class="line">The license terms <span class="keyword">for</span> this product can be downloaded from</span><br><span class="line">http://go.microsoft.com/fwlink/?LinkId=746949 and found <span class="keyword">in</span></span><br><span class="line">/usr/share/doc/mssql-tools/LICENSE.txt . By entering <span class="string">'YES'</span>,</span><br><span class="line">you indicate that you accept the license terms.</span><br><span class="line"></span><br><span class="line">Do you accept the license terms? (Enter YES or NO)</span><br><span class="line">yes</span><br><span class="line">Updating / installing...</span><br><span class="line">   1:mssql-tools-17.6.1.1-1           <span class="comment">################################# [100%]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装</span></span><br><span class="line">[root@lmssql2019 home]<span class="comment"># rpm -ivh mssql-cli-1.0.0-1.el7.x86_64.rpm </span></span><br><span class="line">warning: mssql-cli-1.0.0-1.el7.x86_64.rpm: Header V4 RSA/SHA256 Signature, key ID be1229cf: NOKEY</span><br><span class="line">Preparing...                          <span class="comment">################################# [100%]</span></span><br><span class="line">Updating / installing...</span><br><span class="line">   1:mssql-cli-1.0.0-1.el7            <span class="comment">################################# [100%]</span></span><br></pre></td></tr></table></figure><ul><li>设置环境变量</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@lmssql2019 home]<span class="comment"># echo 'export PATH="$PATH:/opt/mssql-tools/bin"' &gt;&gt; ~/.bash_profile</span></span><br><span class="line">[root@lmssql2019 home]<span class="comment"># echo 'export PATH="$PATH:/opt/mssql-tools/bin"' &gt;&gt; ~/.bashrc</span></span><br><span class="line">[root@lmssql2019 home]<span class="comment"># source ~/.bashrc</span></span><br></pre></td></tr></table></figure><ul><li>黑屏客户端测试</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@lmssql2019 ~]<span class="comment"># sqlcmd -S localhost -U sa -P PP--ssw00rd</span></span><br><span class="line">1&gt; select name from sys.databases</span><br><span class="line">2&gt; go</span><br><span class="line">name                                            </span><br><span class="line">---------------------------------------------------</span><br><span class="line">master                                                </span><br><span class="line">tempdb                                           </span><br><span class="line">model                                </span><br><span class="line">msdb                                                                                            </span><br><span class="line">(4 rows affected)</span><br><span class="line">1&gt;</span><br></pre></td></tr></table></figure><ul><li>版本查看</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@lmssql2019 home]<span class="comment"># sqlcmd -S localhost -U SA -Q 'select @@VERSION'</span></span><br><span class="line">Password: </span><br><span class="line"></span><br><span class="line">Microsoft SQL Server 2019 (RTM-CU8) (KB4577194) - 15.0.4073.23 (X64) </span><br><span class="line">Sep 23 2020 16:03:08 </span><br><span class="line">Copyright (C) 2019 Microsoft Corporation</span><br><span class="line">Standard Edition (64-bit) on Linux (CentOS Linux 7 (Core)) &lt;X64&gt;</span><br></pre></td></tr></table></figure><ul><li>mssql-cli测试</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@lmssql2019 home]<span class="comment"># mssql-cli -U sa</span></span><br><span class="line">Password: </span><br><span class="line">master&gt; select name from sys.databases;   </span><br><span class="line">Time: 0.453s</span><br><span class="line">+--------+</span><br><span class="line">| name   |</span><br><span class="line">|--------|</span><br><span class="line">| master |</span><br><span class="line">| tempdb |</span><br><span class="line">| model  |</span><br><span class="line">| msdb   |</span><br><span class="line">+--------+</span><br><span class="line">(4 rows affected)</span><br><span class="line">master&gt;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Microsoft-SQL-Server-For-Linux-installation-packages-description&quot;&gt;&lt;a href=&quot;#Microsoft-SQL-Server-For-Linux-installation-packages-des</summary>
      
    
    
    
    <category term="SQL Server" scheme="http://falkon.cn/categories/SQL-Server/"/>
    
    
    <category term="12c" scheme="http://falkon.cn/tags/12c/"/>
    
    <category term="PDB" scheme="http://falkon.cn/tags/PDB/"/>
    
  </entry>
  
  <entry>
    <title>Linux Installation Oracle 12c</title>
    <link href="http://falkon.cn/2021/01/27/database/rhel-install-oracle12c/"/>
    <id>http://falkon.cn/2021/01/27/database/rhel-install-oracle12c/</id>
    <published>2021-01-27T09:37:22.710Z</published>
    <updated>2021-01-27T03:12:01.148Z</updated>
    
    <content type="html"><![CDATA[<h3 id="1-资源描述"><a href="#1-资源描述" class="headerlink" title="1. 资源描述"></a>1. 资源描述</h3><ul><li><a href="https://wiki.centos.org/Download" target="_blank" rel="noopener">CentOS 6.10</a> 操作系统可选择6.x系列其他的版本</li><li><a href="https://www.oracle.com/technetwork/database/enterprise-edition/downloads/index.html" target="_blank" rel="noopener">Oracle 12.2.0.1</a> 点击链接找到对应操作系统的版本下载即可</li><li><a href="https://www.virtualbox.org/" target="_blank" rel="noopener">Virtual Box 5.2.22</a> 虚拟机软件可选择最新版，建议使用5系列，比较稳定</li><li><a href="https://www.realvnc.com/en/connect/download/viewer/" target="_blank" rel="noopener">VNC Viewer 6.18</a> 远程桌面工具，可选用最新版</li><li><a href="https://www.netsarang.com/en/xshell/" target="_blank" rel="noopener">Xshell 5</a> 远程终端工具5系列官网已经不提供下载了，可选择6系列，有使用限制，单个窗口最大可开4个标签，可选择其他终端工具比如<a href="https://putty.org/" target="_blank" rel="noopener">Putty</a>，<a href="https://mobaxterm.mobatek.net/" target="_blank" rel="noopener">MobaXterm</a>等</li></ul><a id="more"></a><h3 id="2-操作系统检查与配置"><a href="#2-操作系统检查与配置" class="headerlink" title="2. 操作系统检查与配置"></a>2. 操作系统检查与配置</h3><ul><li><p>查看操作系统版本</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># cat /etc/redhat-release</span></span><br><span class="line">CentOS release 6.10 (Final)</span><br></pre></td></tr></table></figure></li><li><p>查看内存，swap</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 内存建议1G以上，swap建议4G以上否则在安装检查的时候会报错</span></span><br><span class="line">[root@localhost ~]<span class="comment"># free -m</span></span><br><span class="line">             total       used       free     shared    buffers     cached</span><br><span class="line">Mem:          1878        702       1175          2         52        378</span><br><span class="line">-/+ buffers/cache:        270       1607</span><br><span class="line">Swap:         4095          0       4095</span><br></pre></td></tr></table></figure></li><li><p>调整swap大小</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建分区，位置可自定，bs参数为块大小，count参数为个数</span></span><br><span class="line">[root@localhost ~]<span class="comment"># dd if=/dev/zero of=/home/swap bs=1M count=2048</span></span><br><span class="line">2048+0 records <span class="keyword">in</span></span><br><span class="line">2048+0 records out</span><br><span class="line">2147483648 bytes (2.1 GB) copied, 2.72688 s, 788 MB/s</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将分区变成swap分区</span></span><br><span class="line">[root@localhost ~]<span class="comment"># mkswap /home/swap</span></span><br><span class="line">mkswap: /home/swap: warning: don<span class="string">'t erase bootbits sectors</span></span><br><span class="line"><span class="string">        on whole disk. Use -f to force.</span></span><br><span class="line"><span class="string">Setting up swapspace version 1, size = 2097148 KiB</span></span><br><span class="line"><span class="string">no label, UUID=21751eac-33ad-4fe0-8b13-3bccc34973b9</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 使分区生效</span></span><br><span class="line"><span class="string">[root@localhost ~]# swapon /home/swap</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 修改fstab添加开机启动</span></span><br><span class="line"><span class="string">[root@localhost ~]# vi /etc/fstab</span></span><br><span class="line"><span class="string">/home/swap              swap                    swap    defaults        0 0</span></span><br></pre></td></tr></table></figure></li><li><p>查看磁盘空间</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Oracle安装目录的可用空间建议15G以上，安装操作系统磁盘建议32G以上</span></span><br><span class="line">[root@localhost ~]<span class="comment"># df -h</span></span><br><span class="line">Filesystem            Size  Used Avail Use% Mounted on</span><br><span class="line">/dev/mapper/VolGroup-LogVol00</span><br><span class="line">                       28G  7.3G   19G  29% /</span><br><span class="line">tmpfs                 940M   76K  939M   1% /dev/shm</span><br><span class="line">/dev/sda1             190M   40M  141M  22% /boot</span><br></pre></td></tr></table></figure></li><li><p>配置IP地址</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 编辑ifcfg-eth0</span></span><br><span class="line">[root@localhost ~]<span class="comment"># vi /etc/sysconfig/network-scripts/ifcfg-eth0</span></span><br><span class="line"><span class="comment"># 参照下列示例修改后六行，Virtual Box的虚拟网关为192.168.56.1</span></span><br><span class="line"><span class="comment"># 在host-only模式下你的IP地址需要在192.168.56这个网段</span></span><br><span class="line"><span class="comment"># 在生产环境下，数据库是和交换机连在一起的，具体的IP需要和应用在同</span></span><br><span class="line"><span class="comment"># 一个网段或者VLAN中</span></span><br><span class="line">DEVICE=eth0</span><br><span class="line">HWADDR=08:00:27:7F:BA:FD</span><br><span class="line">TYPE=Ethernet</span><br><span class="line">UUID=0948b812-ae70-4159-9564-bde690e7befa</span><br><span class="line">ONBOOT=yes</span><br><span class="line">NM_CONTROLLED=yes</span><br><span class="line">BOOTPROTO=static</span><br><span class="line">IPADDR=192.168.56.104</span><br><span class="line">NETMASK=255.255.255.0</span><br><span class="line">GATEWAY=192.168.56.1</span><br></pre></td></tr></table></figure></li><li><p>修改network</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 修改主机名，一般建议为：应用-类型版本的模式，这样方便的终端登陆时候，</span></span><br><span class="line"><span class="comment"># 看到主机名就知道这台服务器的作用，以及为哪个应用提供服务，如果上面有</span></span><br><span class="line"><span class="comment"># 多个库，建议为mpp(Multi Application)-类型版本的模式</span></span><br><span class="line"><span class="comment"># 编辑network配置文件</span></span><br><span class="line">[root@localhost ~]<span class="comment"># vi /etc/sysconfig/network</span></span><br><span class="line"><span class="comment"># 将localhost.localdomain修改为自定的主机名</span></span><br><span class="line">NETWORKING=yes</span><br><span class="line">HOSTNAME=app-db12c</span><br></pre></td></tr></table></figure></li><li><p>修改hosts</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># vi /etc/hosts</span></span><br><span class="line">192.168.56.104  app-db12c</span><br></pre></td></tr></table></figure></li><li><p>修改防火墙</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 关闭防火墙</span></span><br><span class="line">[root@localhost ~]<span class="comment"># service iptables stop</span></span><br><span class="line"><span class="comment"># 禁止开机启动防火墙</span></span><br><span class="line">[root@localhost ~]<span class="comment"># chkconfig iptables off</span></span><br></pre></td></tr></table></figure></li><li><p>修改selinux</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 关闭Linux增强，编辑selinx配置文件</span></span><br><span class="line">[root@localhost ~]<span class="comment"># vi /etc/sysconfig/selinux</span></span><br><span class="line"><span class="comment"># 将SELINUX=enforcing修改SELINUX=disabled</span></span><br><span class="line"><span class="comment"># This file controls the state of SELinux on the system.</span></span><br><span class="line"><span class="comment"># SELINUX= can take one of these three values:</span></span><br><span class="line"><span class="comment">#     enforcing - SELinux security policy is enforced.</span></span><br><span class="line"><span class="comment">#     permissive - SELinux prints warnings instead of enforcing.</span></span><br><span class="line"><span class="comment">#     disabled - No SELinux policy is loaded.</span></span><br><span class="line">SELINUX=disabled</span><br><span class="line"><span class="comment"># SELINUXTYPE= can take one of these two values:</span></span><br><span class="line"><span class="comment">#     targeted - Targeted processes are protected,</span></span><br><span class="line"><span class="comment">#     mls - Multi Level Security protection.</span></span><br><span class="line">SELINUXTYPE=targeted</span><br></pre></td></tr></table></figure><h3 id="3-创建用户组及用户"><a href="#3-创建用户组及用户" class="headerlink" title="3. 创建用户组及用户"></a>3. 创建用户组及用户</h3></li><li><p>创建用户组</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@app-db12c ~]<span class="comment"># groupadd oinstall</span></span><br><span class="line">[root@app-db12c ~]<span class="comment"># groupadd dba</span></span><br><span class="line">[root@app-db12c ~]<span class="comment"># groupadd oper</span></span><br></pre></td></tr></table></figure></li><li><p>创建用户并设置密码</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@app-db12c ~]<span class="comment"># useradd -g oinstall -G dba,oper oracle</span></span><br><span class="line">[root@app-db12c ~]<span class="comment"># passwd oracle</span></span><br><span class="line">Changing password <span class="keyword">for</span> user oracle.</span><br><span class="line">New password:</span><br><span class="line">BAD PASSWORD: it is based on a dictionary word</span><br><span class="line">BAD PASSWORD: is too simple</span><br><span class="line">Retype new password:</span><br><span class="line">passwd: all authentication tokens updated successfully.</span><br></pre></td></tr></table></figure></li><li><p>检查用户组及用户</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@app-db12c ~]<span class="comment"># su - oracle</span></span><br><span class="line">[oracle@app-db12c ~]$ id</span><br><span class="line">uid=500(oracle) gid=500(oinstall) groups=500(oinstall),501(dba),502(oper)</span><br></pre></td></tr></table></figure><h3 id="4-创建安装目录"><a href="#4-创建安装目录" class="headerlink" title="4. 创建安装目录"></a>4. 创建安装目录</h3></li><li><p>创建Oracle软件安装目录</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@app-db12c ~]<span class="comment"># mkdir -p /u01/app/oracle</span></span><br></pre></td></tr></table></figure></li><li><p>更改属组并授权</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@app-db12c ~]<span class="comment"># chown -R oracle:oinstall /u01/</span></span><br><span class="line">[root@app-db12c ~]<span class="comment"># chmod -R 775 /u01/app/oracle/</span></span><br></pre></td></tr></table></figure><h3 id="5-修改资源限制"><a href="#5-修改资源限制" class="headerlink" title="5. 修改资源限制"></a>5. 修改资源限制</h3></li><li><p>修改sysctl.conf</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@app-db12c ~]<span class="comment"># vi /etc/sysctl.conf</span></span><br><span class="line">fs.aio-max-nr = 1048576</span><br><span class="line">fs.file-max = 6815744</span><br><span class="line">kernel.shmall = 2097152</span><br><span class="line">kernel.shmmax = 536870912</span><br><span class="line">kernel.shmmni = 4096</span><br><span class="line">kernel.sem = 250 32000 100 128</span><br><span class="line">net.ipv4.ip_local_port_range = 9000 65500</span><br><span class="line">net.core.rmem_default = 262144</span><br><span class="line">net.core.rmem_max = 4194304</span><br><span class="line">net.core.wmem_default = 262144</span><br><span class="line">net.core.wmem_max = 1048576</span><br></pre></td></tr></table></figure></li><li><p>修改limets.conf</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[root@app-db12c ~]<span class="comment"># vi /etc/security/limits.conf</span></span><br><span class="line">oracle          soft    nproc           2047</span><br><span class="line">oracle          hard    nproc           16384</span><br><span class="line">oracle          soft    nofile          4096</span><br><span class="line">oracle          hard    nofile          65536</span><br><span class="line">oracle          soft    stack           10240</span><br><span class="line">oraclehardstack32768</span><br><span class="line"><span class="comment"># 修改完成后验证参数，需要重启</span></span><br><span class="line">[oracle@app-db12c ~]$ <span class="built_in">ulimit</span> -Sn</span><br><span class="line">4096</span><br><span class="line">[oracle@app-db12c ~]$ <span class="built_in">ulimit</span> -Hn</span><br><span class="line">65536</span><br><span class="line">[oracle@app-db12c ~]$ <span class="built_in">ulimit</span> -Su</span><br><span class="line">2047</span><br><span class="line">[oracle@app-db12c ~]$ <span class="built_in">ulimit</span> -Hu</span><br><span class="line">16384</span><br><span class="line">[oracle@app-db12c ~]$ <span class="built_in">ulimit</span> -Ss</span><br><span class="line">10240</span><br><span class="line">[oracle@app-db12c ~]$ <span class="built_in">ulimit</span> -Hs</span><br><span class="line">32768</span><br></pre></td></tr></table></figure></li></ul><h3 id="6-安装依赖包"><a href="#6-安装依赖包" class="headerlink" title="6. 安装依赖包"></a>6. 安装依赖包</h3><ul><li><p>查看<a href="https://docs.oracle.com/en/database/oracle/oracle-database/12.2/ladbi/supported-oracle-linux-6-distributions-for-x86-64.html#GUID-77B9C8E1-D094-4C32-AA18-B91646247D33" target="_blank" rel="noopener">官方文档</a>中所需的依赖包</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">binutils-2.20.51.0.2-5.36.el6 (x86_64)</span><br><span class="line">compat-libcap1-1.10-1 (x86_64)</span><br><span class="line">compat-libstdc++-33-3.2.3-69.el6 (x86_64)</span><br><span class="line">compat-libstdc++-33-3.2.3-69.el6 (i686)</span><br><span class="line">e2fsprogs-1.41.12-14.el6 (x86_64)</span><br><span class="line">e2fsprogs-libs-1.41.12-14.el6 (x86_64)</span><br><span class="line">glibc-2.12-1.7.el6 (i686)</span><br><span class="line">glibc-2.12-1.7.el6 (x86_64)</span><br><span class="line">glibc-devel-2.12-1.7.el6 (x86_64)</span><br><span class="line">glibc-devel-2.12-1.7.el6 (i686)</span><br><span class="line">ksh</span><br><span class="line">libgcc-4.4.4-13.el6 (i686)</span><br><span class="line">libgcc-4.4.4-13.el6 (x86_64)</span><br><span class="line">libstdc++-4.4.4-13.el6 (x86_64)</span><br><span class="line">libstdc++-4.4.4-13.el6 (i686)</span><br><span class="line">libstdc++-devel-4.4.4-13.el6 (x86_64)</span><br><span class="line">libstdc++-devel-4.4.4-13.el6 (i686)</span><br><span class="line">libaio-0.3.107-10.el6 (x86_64)</span><br><span class="line">libaio-0.3.107-10.el6 (i686)</span><br><span class="line">libaio-devel-0.3.107-10.el6 (x86_64)</span><br><span class="line">libaio-devel-0.3.107-10.el6 (i686)</span><br><span class="line">libXtst-1.0.99.2 (x86_64)</span><br><span class="line">libXtst-1.0.99.2 (i686)</span><br><span class="line">libX11-1.5.0-4.el6 (i686)</span><br><span class="line">libX11-1.5.0-4.el6 (x86_64)</span><br><span class="line">libXau-1.0.6-4.el6 (i686)</span><br><span class="line">libXau-1.0.6-4.el6 (x86_64)</span><br><span class="line">libxcb-1.8.1-1.el6 (i686)</span><br><span class="line">libxcb-1.8.1-1.el6 (x86_64)</span><br><span class="line">libXi-1.3 (x86_64)</span><br><span class="line">libXi-1.3 (i686)</span><br><span class="line">libXrender (i686)</span><br><span class="line">libXrender (x86_64)</span><br><span class="line">libXrender-devel (i686)</span><br><span class="line">libXrender-devel (x86_64)</span><br><span class="line">make-3.81-19.el6</span><br><span class="line">net-tools-1.60-110.el6_2.x86_64 (<span class="keyword">for</span> Oracle RAC and Oracle Clusterware)</span><br><span class="line">nfs-utils-1.2.3-15.0.1 (<span class="keyword">for</span> Oracle ACFS)</span><br><span class="line">sysstat-9.0.4-11.el6 (x86_64)</span><br><span class="line">smartmontools-5.43-1.el6.x86_64</span><br><span class="line">unixODBC-2.2.14-11.el6 (x86_64)</span><br><span class="line">unixODBC-2.2.14-11.el6.i686</span><br><span class="line">unixODBC-devel-2.2.14-11.el6 (x86_64)</span><br><span class="line">unixODBC-devel-2.2.14-11.el6.i686</span><br></pre></td></tr></table></figure></li><li><p>配置yum源</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@app-db12c ~]<span class="comment"># vi /etc/yum.repos.d/CentOS-Base.repo</span></span><br><span class="line">[base]</span><br><span class="line">name=CentOS-<span class="variable">$releasever</span> - Base</span><br><span class="line">baseurl=file:///media</span><br><span class="line"><span class="built_in">enable</span>=1</span><br><span class="line">gpgcheck=1</span><br><span class="line">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6</span><br></pre></td></tr></table></figure></li><li><p>安装依赖</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在虚拟机中添加操作系统镜像并挂载</span></span><br><span class="line">[root@app-db11g media]<span class="comment"># mount /dev/cdrom /media/</span></span><br><span class="line">mount: block device /dev/sr0 is write-protected, mounting <span class="built_in">read</span>-only</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用yum install命令安装依赖包</span></span><br><span class="line">[root@app-db11g ~]<span class="comment"># yum install -y compat-libcap1 compat-libstdc++-33 </span></span><br><span class="line">compat-libstdc++-33 gcc gcc-c++ glibc glibc-devel ksh libgcc libstdc++ </span><br><span class="line">libstdc++-devel libaio libaio-devel make sysstat unixODBC unixODBC-devel</span><br></pre></td></tr></table></figure></li></ul><h3 id="7-安装数据库软件"><a href="#7-安装数据库软件" class="headerlink" title="7. 安装数据库软件"></a>7. 安装数据库软件</h3><ul><li><p>配置oracle用户的bash_profile</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[oracle@app-db11g ~]$ vi ~/.bash_profile</span><br><span class="line"><span class="built_in">export</span> ORACLE_SID=prod1</span><br><span class="line"><span class="built_in">export</span> ORACLE_BASE=/u01/app/oracle</span><br><span class="line"><span class="built_in">export</span> ORACLE_HOME=<span class="variable">$ORACLE_BASE</span>/product/11.2.0/dbhome_1</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$ORACLE_HOME</span>/bin:<span class="variable">$PATH</span></span><br></pre></td></tr></table></figure></li><li><p>上用sftp上传安装包到服务器，完成后使用unzip命令解压</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@app-db12c ~]<span class="comment"># ls /home/</span></span><br><span class="line">linuxx64_12201_database.zip</span><br></pre></td></tr></table></figure></li><li><p>配置VNC Server</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@app-db12c ~]<span class="comment"># vi /etc/sysconfig/vncservers</span></span><br><span class="line">VNCSERVERS=<span class="string">"2:root"</span></span><br><span class="line">VNCSERVERARGS[2]=<span class="string">"-geometry 1024x768"</span></span><br></pre></td></tr></table></figure></li><li><p>设置或者重置vnc密码</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@app-db12c ~]<span class="comment"># vncpasswd</span></span><br><span class="line">Password:</span><br><span class="line">Verify:</span><br></pre></td></tr></table></figure></li><li><p>启动VNC Server</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@app-db12c ~]<span class="comment"># service vncserver start</span></span><br><span class="line">Starting VNC server: 2:root xauth:  file /root/.Xauthority does not exist</span><br><span class="line">xauth: (stdin):1:  bad display name <span class="string">"app-db12c:2"</span> <span class="keyword">in</span> <span class="string">"add"</span> <span class="built_in">command</span></span><br><span class="line"></span><br><span class="line">New <span class="string">'app-db12c:2 (root)'</span> desktop is app-db12c:2</span><br><span class="line"></span><br><span class="line">Creating default startup script /root/.vnc/xstartup</span><br><span class="line">Starting applications specified <span class="keyword">in</span> /root/.vnc/xstartup</span><br><span class="line">Log file is /root/.vnc/app-db12c:2.log</span><br><span class="line"></span><br><span class="line">                                                           [  OK  ]</span><br></pre></td></tr></table></figure></li><li><p>使用VNC Viewer连接<br>由于我的操作系统是Fedora 29，所以使用的Remmina远程桌面工具，其实连接方式是一样的注意IP地址后面的冒号，在连接上远程桌面后在终端root用户和oracle都要执行<code>xhost +</code>命令，然后<code>cd /home/database</code>执行<code>./runInstaller</code></p><img src="http://qnlcbj437.fantom.run/static/images/remmina-12c.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li></ul><ul><li><p>不执行安全更新</p><img src="http://qnlcbj437.fantom.run/static/images/ora-inst-12c-01.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>只安装数据软件</p><img src="http://qnlcbj437.fantom.run/static/images/ora-inst-12c-02.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>选择单实例安装</p><img src="http://qnlcbj437.fantom.run/static/images/ora-inst-12c-03.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>选择企业版</p><img src="http://qnlcbj437.fantom.run/static/images/ora-inst-12c-04.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>指定安装目录</p><img src="http://qnlcbj437.fantom.run/static/images/ora-inst-12c-05.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>指定oraInventory目录</p><img src="http://qnlcbj437.fantom.run/static/images/ora-inst-12c-06.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>指定用户组</p><img src="http://qnlcbj437.fantom.run/static/images/ora-inst-12c-07.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>安装信息汇总</p><img src="http://qnlcbj437.fantom.run/static/images/ora-inst-12c-08.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>安装进度</p><img src="http://qnlcbj437.fantom.run/static/images/ora-inst-12c-09.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>执行root脚本，安装完成</p><img src="http://qnlcbj437.fantom.run/static/images/ora-inst-12c-10.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">[root@app-db12c ~]<span class="comment"># /u01/app/oraInventory/orainstRoot.sh</span></span><br><span class="line">Changing permissions of /u01/app/oraInventory.</span><br><span class="line">Adding <span class="built_in">read</span>,write permissions <span class="keyword">for</span> group.</span><br><span class="line">Removing <span class="built_in">read</span>,write,execute permissions <span class="keyword">for</span> world.</span><br><span class="line"></span><br><span class="line">Changing groupname of /u01/app/oraInventory to oinstall.</span><br><span class="line">The execution of the script is complete.</span><br><span class="line">[root@app-db12c ~]<span class="comment"># /u01/app/oracle/product/12.2.0/dbhome_1/root.sh</span></span><br><span class="line">Performing root user operation.</span><br><span class="line"></span><br><span class="line">The following environment variables are <span class="built_in">set</span> as:</span><br><span class="line">    ORACLE_OWNER= oracle</span><br><span class="line">    ORACLE_HOME=  /u01/app/oracle/product/12.2.0/dbhome_1</span><br><span class="line"></span><br><span class="line">Enter the full pathname of the <span class="built_in">local</span> bin directory: [/usr/<span class="built_in">local</span>/bin]:</span><br><span class="line">   Copying dbhome to /usr/<span class="built_in">local</span>/bin ...</span><br><span class="line">   Copying oraenv to /usr/<span class="built_in">local</span>/bin ...</span><br><span class="line">   Copying coraenv to /usr/<span class="built_in">local</span>/bin ...</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Creating /etc/oratab file...</span><br><span class="line">Entries will be added to the /etc/oratab file as needed by</span><br><span class="line">Database Configuration Assistant when a database is created</span><br><span class="line">Finished running generic part of root script.</span><br><span class="line">Now product-specific root actions will be performed.</span><br><span class="line">Do you want to setup Oracle Trace File Analyzer (TFA) now ? yes|[no] :</span><br><span class="line"></span><br><span class="line">Oracle Trace File Analyzer (TFA - User Mode) is available at :</span><br><span class="line">    /u01/app/oracle/product/12.2.0/dbhome_1/suptools/tfa/release/tfa_home/bin/tfactl</span><br><span class="line"></span><br><span class="line">OR</span><br><span class="line"></span><br><span class="line">Oracle Trace File Analyzer (TFA - Daemon Mode) can be installed by running this script :</span><br><span class="line">    /u01/app/oracle/product/12.2.0/dbhome_1/suptools/tfa/release/tfa_home/install/roottfa.sh</span><br></pre></td></tr></table></figure></li></ul><h3 id="8-配置监听"><a href="#8-配置监听" class="headerlink" title="8. 配置监听"></a>8. 配置监听</h3><ul><li><p>执行netca配置监听</p><img src="http://qnlcbj437.fantom.run/static/images/ora-netca-12c-01.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>选择增加</p><img src="http://qnlcbj437.fantom.run/static/images/ora-netca-12c-02.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>监听名称</p><img src="http://qnlcbj437.fantom.run/static/images/ora-netca-12c-03.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>监听协议</p><img src="http://qnlcbj437.fantom.run/static/images/ora-netca-12c-04.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>监听端口</p><img src="http://qnlcbj437.fantom.run/static/images/ora-netca-12c-05.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>不配置另一个监听</p><img src="http://qnlcbj437.fantom.run/static/images/ora-netca-12c-06.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>监听配置完成</p><img src="http://qnlcbj437.fantom.run/static/images/ora-netca-12c-07.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li></ul><h3 id="9-创建数据库"><a href="#9-创建数据库" class="headerlink" title="9. 创建数据库"></a>9. 创建数据库</h3><ul><li><p>选择创建数据库</p><img src="http://qnlcbj437.fantom.run/static/images/ora-dbca-12c-01.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>选择高级配置</p><img src="http://qnlcbj437.fantom.run/static/images/ora-dbca-12c-02.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>选择创建数据库的类型<br>类型有通用或事务、数据仓库和自定义，我们选择通用或事务，也就是常说的OLTP</p><img src="http://qnlcbj437.fantom.run/static/images/ora-dbca-12c-03.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"> </li><li><p>填写SID<br>注意：下面是12c的新特性，创建容器库的选项，包括填写一个PDB名称，默认也可以</p><img src="http://qnlcbj437.fantom.run/static/images/ora-dbca-12c-04.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"> </li><li><p>存储选项</p><img src="http://qnlcbj437.fantom.run/static/images/ora-dbca-12c-05.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>闪回区和归档</p><img src="http://qnlcbj437.fantom.run/static/images/ora-dbca-12c-06.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>选择监听</p><img src="http://qnlcbj437.fantom.run/static/images/ora-dbca-12c-07.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>安全策略配置</p><img src="http://qnlcbj437.fantom.run/static/images/ora-dbca-12c-08.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>设置内存、进程、字符集、连接模式</p><img src="http://qnlcbj437.fantom.run/static/images/ora-dbca-12c-09.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>EM配置</p><img src="http://qnlcbj437.fantom.run/static/images/ora-dbca-12c-10.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>设置统一密码</p><img src="http://qnlcbj437.fantom.run/static/images/ora-dbca-12c-11.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>创建数据库选项</p><img src="http://qnlcbj437.fantom.run/static/images/ora-dbca-12c-12.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>创建信息汇总</p><img src="http://qnlcbj437.fantom.run/static/images/ora-dbca-12c-13.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>创建进度</p><img src="http://qnlcbj437.fantom.run/static/images/ora-dbca-12c-14.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>创建完成</p><img src="http://qnlcbj437.fantom.run/static/images/ora-dbca-12c-15.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li></ul><h3 id="10-数据库测试"><a href="#10-数据库测试" class="headerlink" title="10. 数据库测试"></a>10. 数据库测试</h3><ul><li>查看数据库版本<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; select banner from v$version;</span><br><span class="line"></span><br><span class="line">BANNER</span><br><span class="line"><span class="comment">--------------------------------------------------------------------------------</span></span><br><span class="line">Oracle Database 12c Enterprise Edition <span class="keyword">Release</span> <span class="number">12.2</span><span class="number">.0</span><span class="number">.1</span><span class="number">.0</span> - <span class="number">64</span><span class="built_in">bit</span> Production</span><br><span class="line">PL/<span class="keyword">SQL</span> <span class="keyword">Release</span> <span class="number">12.2</span><span class="number">.0</span><span class="number">.1</span><span class="number">.0</span> - Production</span><br><span class="line">CORE    <span class="number">12.2</span><span class="number">.0</span><span class="number">.1</span><span class="number">.0</span>      Production</span><br><span class="line">TNS <span class="keyword">for</span> Linux: <span class="keyword">Version</span> <span class="number">12.2</span><span class="number">.0</span><span class="number">.1</span><span class="number">.0</span> - Production</span><br><span class="line">NLSRTL <span class="keyword">Version</span> <span class="number">12.2</span><span class="number">.0</span><span class="number">.1</span><span class="number">.0</span> - Production</span><br></pre></td></tr></table></figure></li><li>查看CDB状态<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; select instance_name,status from v$instance;</span><br><span class="line"></span><br><span class="line">INSTANCE_NAME    STATUS</span><br><span class="line"><span class="comment">---------------- ------------</span></span><br><span class="line">orcl             OPEN</span><br></pre></td></tr></table></figure></li><li>查看PDB<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; show pdbs</span><br><span class="line"></span><br><span class="line">    CON_ID CON_NAME                       OPEN MODE  RESTRICTED</span><br><span class="line"><span class="comment">---------- ------------------------------ ---------- ----------</span></span><br><span class="line">         2 PDB$SEED                       READ ONLY  NO</span><br><span class="line">         3 PDB1                           READ WRITE NO</span><br></pre></td></tr></table></figure></li></ul><h3 id="11-Oracle-12c新特性"><a href="#11-Oracle-12c新特性" class="headerlink" title="11. Oracle 12c新特性"></a>11. Oracle 12c新特性</h3><ul><li><p>基本概念<br>Oracle 在12c数据库中引入了多租户环境（Multitenant Environment），允许一个数据库容器（Container Database）简称<strong>CDB</strong>，可以承载多个可插拔（Pluggable Database）简称<strong>PDB</strong>。12c以前实例和数据库是一对一，或者多对一的关系，进入12c以后实例和数据库之间的关系可以是一对多，参见官方文档中CDB和PDB的关系图</p><img src="http://qnlcbj437.fantom.run/static/images/cdb-pdb.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>CDB所包含的组件<br><strong>Root</strong><br>root又名CDB$ROOT，存储着Oracle提供的元数据和common users。元数据的一个例子就是Oracle提供的PL/SQL包。common user是每个容器中已知的用户。一个CDB只有一个root。<br><strong>Seed</strong><br>seed又名PDB$SEED，是用于创建新pdb的模板。你不能在seed中添加或者修改对象。一个CDB只有一个seed。<br><strong>PDBs</strong><br>PDB对用户和应用程序而言像是非CDB。 例如，PDB可以包含支持特定应用程序所需的数据和代码。 PDB与Oracle Database 12c之前的Oracle数据库版本完全向后兼容。</p></li></ul><h3 id="12-PDB基本操作"><a href="#12-PDB基本操作" class="headerlink" title="12. PDB基本操作"></a>12. PDB基本操作</h3><ul><li>创建PDB<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; create pluggable database pdb2 admin user pdbadmin identified by pdbadmin123 FILE_NAME_CONVERT=</span><br><span class="line">('/u01/app/oracle/oradata/orcl/pdbseed','/u01/app/oracle/oradata/orcl/pdb2');</span><br><span class="line"></span><br><span class="line">Pluggable database created.</span><br></pre></td></tr></table></figure></li><li>查看PDB<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; select con_id,dbid,name,open_mode from v$pdbs;</span><br><span class="line"></span><br><span class="line">    CON_ID DBID NAME OPEN_MODE</span><br><span class="line"><span class="comment">---------- ---------- ---------- ----------</span></span><br><span class="line"> 2 1296933544 PDB$SEED READ ONLY</span><br><span class="line"> 3 4050349150 PDB1 MOUNTED</span><br><span class="line"> 4 1025185214 PDB2 MOUNTED</span><br><span class="line"> 5 1117275895 PDB3 MOUNTED</span><br></pre></td></tr></table></figure></li><li>在CDB中开启和关闭PDB<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 开启单个PDB</span></span><br><span class="line">SQL&gt; alter pluggable database pdb1 open;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 开启多个PDB</span></span><br><span class="line">SQL&gt; alter pluggable database all open;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 关闭单个PDB</span></span><br><span class="line">SQL&gt; alter pluggable database pdb1 close;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 关闭多个PDB</span></span><br><span class="line">SQL&gt; alter pluggable database all close;</span><br></pre></td></tr></table></figure></li><li>切换PDB<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- CDB切换到PDB，PDB和PDB之间切换</span></span><br><span class="line">SQL&gt; alter session set container=pdb1;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- PDB切换到CDB</span></span><br><span class="line">SQL&gt; alter session set container=CDB$ROOT;</span><br></pre></td></tr></table></figure></li><li>删除PDB<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 拨出PDB</span></span><br><span class="line">SQL&gt; alter pluggable database pdb2 unplug into '/home/oracle/unplugged_pdbs/pdb_2.xml';</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除PDB，保留数据文件</span></span><br><span class="line">SQL&gt; drop pluggable database pdb2 keep datafiles;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除PDB，不保留数据文件</span></span><br><span class="line">SQL&gt; drop pluggable database pdb3 including datafiles;</span><br></pre></td></tr></table></figure></li></ul>]]></content>
    
    
    <summary type="html">&lt;h3 id=&quot;1-资源描述&quot;&gt;&lt;a href=&quot;#1-资源描述&quot; class=&quot;headerlink&quot; title=&quot;1. 资源描述&quot;&gt;&lt;/a&gt;1. 资源描述&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://wiki.centos.org/Download&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;CentOS 6.10&lt;/a&gt; 操作系统可选择6.x系列其他的版本&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.oracle.com/technetwork/database/enterprise-edition/downloads/index.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Oracle 12.2.0.1&lt;/a&gt; 点击链接找到对应操作系统的版本下载即可&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.virtualbox.org/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Virtual Box 5.2.22&lt;/a&gt; 虚拟机软件可选择最新版，建议使用5系列，比较稳定&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.realvnc.com/en/connect/download/viewer/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;VNC Viewer 6.18&lt;/a&gt; 远程桌面工具，可选用最新版&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.netsarang.com/en/xshell/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Xshell 5&lt;/a&gt; 远程终端工具5系列官网已经不提供下载了，可选择6系列，有使用限制，单个窗口最大可开4个标签，可选择其他终端工具比如&lt;a href=&quot;https://putty.org/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Putty&lt;/a&gt;，&lt;a href=&quot;https://mobaxterm.mobatek.net/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;MobaXterm&lt;/a&gt;等&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="Oracle" scheme="http://falkon.cn/categories/Oracle/"/>
    
    
    <category term="12c" scheme="http://falkon.cn/tags/12c/"/>
    
  </entry>
  
  <entry>
    <title>Linux Installation Oracle 12c RAC</title>
    <link href="http://falkon.cn/2021/01/27/database/rhel-install-oracle12c-rac/"/>
    <id>http://falkon.cn/2021/01/27/database/rhel-install-oracle12c-rac/</id>
    <published>2021-01-27T09:37:22.703Z</published>
    <updated>2021-01-27T03:12:20.465Z</updated>
    
    
    
    
    <category term="Oracle" scheme="http://falkon.cn/categories/Oracle/"/>
    
    
    <category term="RAC" scheme="http://falkon.cn/tags/RAC/"/>
    
    <category term="12c" scheme="http://falkon.cn/tags/12c/"/>
    
    <category term="AFD" scheme="http://falkon.cn/tags/AFD/"/>
    
  </entry>
  
  <entry>
    <title>Linux Installation Oracle 11g</title>
    <link href="http://falkon.cn/2021/01/27/database/rhel-install-oracle11g/"/>
    <id>http://falkon.cn/2021/01/27/database/rhel-install-oracle11g/</id>
    <published>2021-01-27T09:37:22.698Z</published>
    <updated>2021-01-27T03:11:07.031Z</updated>
    
    <content type="html"><![CDATA[<h3 id="1-资源描述"><a href="#1-资源描述" class="headerlink" title="1. 资源描述"></a>1. 资源描述</h3><ul><li><a href="https://wiki.centos.org/Download" target="_blank" rel="noopener">CentOS 6.10</a> 操作系统可选择6.x系列其他的版本</li><li><a href="https://www.oracle.com/technetwork/database/enterprise-edition/downloads/index.html" target="_blank" rel="noopener">Oracle 11.2.0.4</a> 我使用的数据库版本需要MOS才能下载，可选择11.2.0.1版本</li><li><a href="https://www.virtualbox.org/" target="_blank" rel="noopener">Virtual Box 5.2.22</a> 虚拟机软件可选择最新版，建议使用5系列，比较稳定</li><li><a href="https://www.realvnc.com/en/connect/download/viewer/" target="_blank" rel="noopener">VNC Viewer 6.18</a> 远程桌面工具，可选用最新版</li><li><a href="https://www.netsarang.com/en/xshell/" target="_blank" rel="noopener">Xshell 5</a> 远程终端工具5系列官网已经不提供下载了，可选择6系列，有使用限制，单个窗口最大可开4个标签，可选择其他终端工具比如<a href="https://putty.org/" target="_blank" rel="noopener">Putty</a>，<a href="https://mobaxterm.mobatek.net/" target="_blank" rel="noopener">MobaXterm</a>等</li></ul><a id="more"></a><h3 id="2-操作系统检查与配置"><a href="#2-操作系统检查与配置" class="headerlink" title="2. 操作系统检查与配置"></a>2. 操作系统检查与配置</h3><ul><li><p>查看操作系统版本</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># cat /etc/redhat-release </span></span><br><span class="line">CentOS release 6.10 (Final)</span><br></pre></td></tr></table></figure></li><li><p>查看内存，swap</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 内存建议1G以上，swap建议4G以上否则在安装检查的时候会报错</span></span><br><span class="line">[root@localhost ~]<span class="comment"># free -m</span></span><br><span class="line">             total       used       free     shared    buffers     cached</span><br><span class="line">Mem:          1878        702       1175          2         52        378</span><br><span class="line">-/+ buffers/cache:        270       1607</span><br><span class="line">Swap:         4095          0       4095</span><br></pre></td></tr></table></figure></li><li><p>调整swap大小</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建分区，位置可自定，bs参数为块大小，count参数为个数</span></span><br><span class="line">[root@localhost ~]<span class="comment"># dd if=/dev/zero of=/home/swap bs=1M count=2048</span></span><br><span class="line">2048+0 records <span class="keyword">in</span></span><br><span class="line">2048+0 records out</span><br><span class="line">2147483648 bytes (2.1 GB) copied, 2.72688 s, 788 MB/s</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将分区变成swap分区</span></span><br><span class="line">[root@localhost ~]<span class="comment"># mkswap /home/swap</span></span><br><span class="line">mkswap: /home/swap: warning: don<span class="string">'t erase bootbits sectors</span></span><br><span class="line"><span class="string">        on whole disk. Use -f to force.</span></span><br><span class="line"><span class="string">Setting up swapspace version 1, size = 2097148 KiB</span></span><br><span class="line"><span class="string">no label, UUID=21751eac-33ad-4fe0-8b13-3bccc34973b9</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 使分区生效</span></span><br><span class="line"><span class="string">[root@localhost ~]# swapon /home/swap</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 修改fstab添加开机启动</span></span><br><span class="line"><span class="string">[root@localhost ~]# vi /etc/fstab</span></span><br><span class="line"><span class="string">/home/swap              swap                    swap    defaults        0 0</span></span><br></pre></td></tr></table></figure></li><li><p>查看磁盘空间</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Oracle安装目录的可用空间建议15G以上，安装操作系统磁盘建议32G以上</span></span><br><span class="line">[root@localhost ~]<span class="comment"># df -h</span></span><br><span class="line">Filesystem            Size  Used Avail Use% Mounted on</span><br><span class="line">/dev/mapper/VolGroup-LogVol00</span><br><span class="line">                       28G  7.3G   19G  29% /</span><br><span class="line">tmpfs                 940M   76K  939M   1% /dev/shm</span><br><span class="line">/dev/sda1             190M   40M  141M  22% /boot</span><br></pre></td></tr></table></figure></li><li><p>配置IP地址</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 编辑ifcfg-eth0</span></span><br><span class="line">[root@localhost ~]<span class="comment"># vi /etc/sysconfig/network-scripts/ifcfg-eth0</span></span><br><span class="line"><span class="comment"># 参照下列示例修改后六行，Virtual Box的虚拟网关为192.168.56.1</span></span><br><span class="line"><span class="comment"># 在host-only模式下你的IP地址需要在192.168.56这个网段</span></span><br><span class="line"><span class="comment"># 在生产环境下，数据库是和交换机连在一起的，具体的IP需要和应用在同</span></span><br><span class="line"><span class="comment"># 一个网段或者VLAN中</span></span><br><span class="line">DEVICE=eth0</span><br><span class="line">HWADDR=08:00:27:7F:BA:FD</span><br><span class="line">TYPE=Ethernet</span><br><span class="line">UUID=0948b812-ae70-4159-9564-bde690e7befa</span><br><span class="line">ONBOOT=yes</span><br><span class="line">NM_CONTROLLED=yes</span><br><span class="line">BOOTPROTO=static</span><br><span class="line">IPADDR=192.168.56.103</span><br><span class="line">NETMASK=255.255.255.0</span><br><span class="line">GATEWAY=192.168.56.1</span><br></pre></td></tr></table></figure></li><li><p>修改network</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 修改主机名，一般建议为：应用-类型版本的模式，这样方便的终端登陆时候，</span></span><br><span class="line"><span class="comment"># 看到主机名就知道这台服务器的作用，以及为哪个应用提供服务，如果上面有</span></span><br><span class="line"><span class="comment"># 多个库，建议为mpp(Multi Application)-类型版本的模式</span></span><br><span class="line"><span class="comment"># 编辑network配置文件</span></span><br><span class="line">[root@localhost ~]<span class="comment"># vi /etc/sysconfig/network</span></span><br><span class="line"><span class="comment"># 将localhost.localdomain修改为自定的主机名</span></span><br><span class="line">NETWORKING=yes</span><br><span class="line">HOSTNAME=app-db11g</span><br></pre></td></tr></table></figure></li><li><p>修改hosts</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># vi /etc/hosts</span></span><br><span class="line">192.168.56.103  app-db11g</span><br></pre></td></tr></table></figure></li><li><p>修改防火墙</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 关闭防火墙</span></span><br><span class="line">[root@localhost ~]<span class="comment"># service iptables stop</span></span><br><span class="line"><span class="comment"># 禁止开机启动防火墙</span></span><br><span class="line">[root@localhost ~]<span class="comment"># chkconfig iptables off</span></span><br></pre></td></tr></table></figure></li><li><p>修改selinux</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 关闭Linux增强，编辑selinx配置文件</span></span><br><span class="line">[root@localhost ~]<span class="comment"># vi /etc/sysconfig/selinux</span></span><br><span class="line"><span class="comment"># 将SELINUX=enforcing修改SELINUX=disabled</span></span><br><span class="line"><span class="comment"># This file controls the state of SELinux on the system.</span></span><br><span class="line"><span class="comment"># SELINUX= can take one of these three values:</span></span><br><span class="line"><span class="comment">#     enforcing - SELinux security policy is enforced.</span></span><br><span class="line"><span class="comment">#     permissive - SELinux prints warnings instead of enforcing.</span></span><br><span class="line"><span class="comment">#     disabled - No SELinux policy is loaded.</span></span><br><span class="line">SELINUX=disabled</span><br><span class="line"><span class="comment"># SELINUXTYPE= can take one of these two values:</span></span><br><span class="line"><span class="comment">#     targeted - Targeted processes are protected,</span></span><br><span class="line"><span class="comment">#     mls - Multi Level Security protection.</span></span><br><span class="line">SELINUXTYPE=targeted</span><br></pre></td></tr></table></figure></li></ul><h3 id="3-创建用户组及用户"><a href="#3-创建用户组及用户" class="headerlink" title="3. 创建用户组及用户"></a>3. 创建用户组及用户</h3><ul><li>创建用户组<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@app-db11g ~]<span class="comment"># groupadd oinstall</span></span><br><span class="line">[root@app-db11g ~]<span class="comment"># groupadd dba</span></span><br><span class="line">[root@app-db11g ~]<span class="comment"># groupadd oper</span></span><br></pre></td></tr></table></figure></li><li>创建用户并设置密码<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@app-db11g ~]<span class="comment"># useradd -g oinstall -G dba,oper oracle</span></span><br><span class="line">[root@app-db11g ~]<span class="comment"># passwd oracle</span></span><br><span class="line">Changing password <span class="keyword">for</span> user oracle.</span><br><span class="line">New password: </span><br><span class="line">BAD PASSWORD: it is based on a dictionary word</span><br><span class="line">BAD PASSWORD: is too simple</span><br><span class="line">Retype new password: </span><br><span class="line">passwd: all authentication tokens updated successfully.</span><br></pre></td></tr></table></figure></li><li>检查用户组及用户<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@app-db11g ~]<span class="comment"># su - oracle</span></span><br><span class="line">[oracle@app-db11g ~]$ id</span><br><span class="line">uid=500(oracle) gid=500(oinstall) groups=500(oinstall),501(dba),502(oper)</span><br></pre></td></tr></table></figure><h3 id="4-创建安装目录"><a href="#4-创建安装目录" class="headerlink" title="4. 创建安装目录"></a>4. 创建安装目录</h3></li><li>创建Oracle软件安装目录<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@app-db11g ~]<span class="comment"># mkdir -p /u01/app/oracle</span></span><br></pre></td></tr></table></figure></li><li>更改属组并授权<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@app-db11g ~]<span class="comment"># chown -R oracle:oinstall /u01/</span></span><br><span class="line">[root@app-db11g ~]<span class="comment"># chmod -R 775 /u01/app/oracle/</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="5-修改资源限制"><a href="#5-修改资源限制" class="headerlink" title="5. 修改资源限制"></a>5. 修改资源限制</h3><ul><li>修改sysctl.conf<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@app-db11g ~]<span class="comment"># vi /etc/sysctl.conf</span></span><br><span class="line">fs.aio-max-nr = 1048576</span><br><span class="line">fs.file-max = 6815744</span><br><span class="line">kernel.shmall = 2097152</span><br><span class="line">kernel.shmmax = 536870912</span><br><span class="line">kernel.shmmni = 4096</span><br><span class="line">kernel.sem = 250 32000 100 128</span><br><span class="line">net.ipv4.ip_local_port_range = 9000 65500</span><br><span class="line">net.core.rmem_default = 262144</span><br><span class="line">net.core.rmem_max = 4194304</span><br><span class="line">net.core.wmem_default = 262144</span><br><span class="line">net.core.wmem_max = 1048576</span><br></pre></td></tr></table></figure></li><li>修改limets.conf<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[root@app-db11g ~]<span class="comment"># vi /etc/security/limits.conf</span></span><br><span class="line">oracle          soft    nproc           2047</span><br><span class="line">oracle          hard    nproc           16384</span><br><span class="line">oracle          soft    nofile          4096</span><br><span class="line">oracle          hard    nofile          65536</span><br><span class="line">oracle          soft    stack           10240</span><br><span class="line">oraclehardstack32768</span><br><span class="line"><span class="comment"># 修改完成后验证参数，需要重启</span></span><br><span class="line">[oracle@app-db11g ~]$ <span class="built_in">ulimit</span> -Sn</span><br><span class="line">4096</span><br><span class="line">[oracle@app-db11g ~]$ <span class="built_in">ulimit</span> -Hn</span><br><span class="line">65536</span><br><span class="line">[oracle@app-db11g ~]$ <span class="built_in">ulimit</span> -Su</span><br><span class="line">2047</span><br><span class="line">[oracle@app-db11g ~]$ <span class="built_in">ulimit</span> -Hu</span><br><span class="line">16384</span><br><span class="line">[oracle@app-db11g ~]$ <span class="built_in">ulimit</span> -Ss</span><br><span class="line">10240</span><br><span class="line">[oracle@app-db11g ~]$ <span class="built_in">ulimit</span> -Hs</span><br><span class="line">32768</span><br></pre></td></tr></table></figure></li></ul><h3 id="6-安装依赖包"><a href="#6-安装依赖包" class="headerlink" title="6. 安装依赖包"></a>6. 安装依赖包</h3><ul><li><p>查看<a href="https://docs.oracle.com/cd/E11882_01/install.112/e24326/toc.htm#BHCFACHG" target="_blank" rel="noopener">官方文档</a>中所需的依赖包</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">binutils-2.20.51.0.2-5.11.el6 (x86_64)</span><br><span class="line">compat-libcap1-1.10-1 (x86_64)</span><br><span class="line">compat-libstdc++-33-3.2.3-69.el6 (x86_64)</span><br><span class="line">compat-libstdc++-33-3.2.3-69.el6.i686</span><br><span class="line">ksh</span><br><span class="line">gcc-4.4.4-13.el6 (x86_64)</span><br><span class="line">gcc-c++-4.4.4-13.el6 (x86_64)</span><br><span class="line">glibc-2.12-1.7.el6 (i686)</span><br><span class="line">glibc-2.12-1.7.el6 (x86_64)</span><br><span class="line">glibc-devel-2.12-1.7.el6 (x86_64)</span><br><span class="line">glibc-devel-2.12-1.7.el6.i686</span><br><span class="line">libgcc-4.4.4-13.el6 (i686)</span><br><span class="line">libgcc-4.4.4-13.el6 (x86_64)</span><br><span class="line">libstdc++-4.4.4-13.el6 (x86_64)</span><br><span class="line">libstdc++-4.4.4-13.el6.i686</span><br><span class="line">libstdc++-devel-4.4.4-13.el6 (x86_64)</span><br><span class="line">libstdc++-devel-4.4.4-13.el6.i686</span><br><span class="line">libaio-0.3.107-10.el6 (x86_64)</span><br><span class="line">libaio-0.3.107-10.el6.i686</span><br><span class="line">libaio-devel-0.3.107-10.el6 (x86_64)</span><br><span class="line">libaio-devel-0.3.107-10.el6.i686</span><br><span class="line">make-3.81-19.el6</span><br><span class="line">sysstat-9.0.4-11.el6 (x86_64)</span><br><span class="line">unixODBC-2.2.14-11.el6 (x86_64)</span><br><span class="line">unixODBC-2.2.14-11.el6.i686</span><br><span class="line">unixODBC-devel-2.2.14-11.el6 (x86_64)</span><br><span class="line">unixODBC-devel-2.2.14-11.el6.i686</span><br></pre></td></tr></table></figure></li><li><p>配置yum源</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@app-db11g ~]<span class="comment"># vi /etc/yum.repos.d/CentOS-Base.repo</span></span><br><span class="line">[base]</span><br><span class="line">name=CentOS-<span class="variable">$releasever</span> - Base</span><br><span class="line">baseurl=file:///media</span><br><span class="line"><span class="built_in">enable</span>=1</span><br><span class="line">gpgcheck=1</span><br><span class="line">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6</span><br></pre></td></tr></table></figure></li><li><p>安装依赖</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在虚拟机中添加操作系统镜像并挂载</span></span><br><span class="line">[root@app-db11g media]<span class="comment"># mount /dev/cdrom /media/</span></span><br><span class="line">mount: block device /dev/sr0 is write-protected, mounting <span class="built_in">read</span>-only</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用yum install命令安装依赖包</span></span><br><span class="line">[root@app-db11g ~]<span class="comment"># yum install -y compat-libcap1 compat-libstdc++-33 </span></span><br><span class="line">compat-libstdc++-33 gcc gcc-c++ glibc glibc-devel ksh libgcc libstdc++ </span><br><span class="line">libstdc++-devel libaio libaio-devel make sysstat unixODBC unixODBC-devel</span><br></pre></td></tr></table></figure></li></ul><h3 id="7-安装数据库软件"><a href="#7-安装数据库软件" class="headerlink" title="7. 安装数据库软件"></a>7. 安装数据库软件</h3><ul><li>配置oracle用户的bash_profile<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[oracle@app-db11g ~]$ vi ~/.bash_profile</span><br><span class="line"><span class="built_in">export</span> ORACLE_SID=prod1</span><br><span class="line"><span class="built_in">export</span> ORACLE_BASE=/u01/app/oracle</span><br><span class="line"><span class="built_in">export</span> ORACLE_HOME=<span class="variable">$ORACLE_BASE</span>/product/11.2.0/dbhome_1</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$ORACLE_HOME</span>/bin:<span class="variable">$PATH</span></span><br></pre></td></tr></table></figure></li><li>上用sftp上传安装包到服务器，完成后使用unzip命令解压<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@app-db11g ~]<span class="comment"># ls /home/</span></span><br><span class="line">p13390677_112040_Linux-x86-64_1of7.zip</span><br><span class="line">p13390677_112040_Linux-x86-64_2of7.zip</span><br></pre></td></tr></table></figure></li><li>处理缺少elfultils-libelf-devel-0.97和pdksh-5.2.14依赖包问题<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 备份cvu_config</span></span><br><span class="line">[root@app-db11g admin]<span class="comment"># cp /home/database/stage/cvu/cv/admin/cvu_config /home/database/stage/cvu/cv/admin/cvu_config.bak</span></span><br><span class="line"><span class="comment"># 修改cvu_config中的CV_ASSUME_DISTID=OEL4为CV_ASSUME_DISTID=OEL6</span></span><br><span class="line"><span class="comment"># Fallback to this distribution id</span></span><br><span class="line">CV_ASSUME_DISTID=OEL6</span><br></pre></td></tr></table></figure></li><li>重启虚拟机<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@app-db11g ~]<span class="comment"># reboot</span></span><br></pre></td></tr></table></figure></li><li>配置VNC Server<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@app-db11g ~]<span class="comment"># vi /etc/sysconfig/vncservers</span></span><br><span class="line">VNCSERVERS=<span class="string">"2:root"</span></span><br><span class="line">VNCSERVERARGS[2]=<span class="string">"-geometry 1024x768"</span></span><br></pre></td></tr></table></figure></li><li>设置或者重置vnc密码<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@app-db11g ~]<span class="comment"># vncpasswd</span></span><br><span class="line">Password:</span><br><span class="line">Verify:</span><br></pre></td></tr></table></figure></li><li>启动VNC Server<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@app-db11g ~]<span class="comment"># service vncserver start</span></span><br><span class="line">Starting VNC server: 2:root xauth:  file /root/.Xauthority does not exist</span><br><span class="line">xauth: (stdin):1:  bad display name <span class="string">"app-db11g:2"</span> <span class="keyword">in</span> <span class="string">"add"</span> <span class="built_in">command</span></span><br><span class="line"></span><br><span class="line">New <span class="string">'app-db11g:2 (root)'</span> desktop is app-db11g:2</span><br><span class="line"></span><br><span class="line">Creating default startup script /root/.vnc/xstartup</span><br><span class="line">Starting applications specified <span class="keyword">in</span> /root/.vnc/xstartup</span><br><span class="line">Log file is /root/.vnc/app-db11g:2.log</span><br><span class="line"></span><br><span class="line">                                                           [  OK  ]</span><br></pre></td></tr></table></figure></li></ul><ul><li><p>使用VNC Viewer连接<br>由于我的操作系统是Fedora 29，所以使用的Remmina远程桌面工具，其实连接方式是一样的注意IP地址后面的冒号，在连接上远程桌面后在终端root用户和oracle都要执行<code>xhost +</code>命令，然后<code>cd /home/database</code>执行<code>./runInstaller</code></p><img src="http://qnlcbj437.fantom.run/static/images/remmina.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim">                                      </li><li><p>不执行安全更新</p><img src="http://qnlcbj437.fantom.run/static/images/ora-11g-inst-01.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>跳过软件更新</p><img src="http://qnlcbj437.fantom.run/static/images/ora-11g-inst-02.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>只安装数据库软件</p><img src="http://qnlcbj437.fantom.run/static/images/ora-11g-inst-03.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>选择单实例安装</p><img src="http://qnlcbj437.fantom.run/static/images/ora-11g-inst-04.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>选择语言</p><img src="http://qnlcbj437.fantom.run/static/images/ora-11g-inst-05.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>选择企业版</p><img src="http://qnlcbj437.fantom.run/static/images/ora-11g-inst-06.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>指定安装路径</p><img src="http://qnlcbj437.fantom.run/static/images/ora-11g-inst-07.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>创建Inventoy</p><img src="http://qnlcbj437.fantom.run/static/images/ora-11g-inst-08.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>指定用户组</p><img src="http://qnlcbj437.fantom.run/static/images/ora-11g-inst-09.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>汇总信息</p><img src="http://qnlcbj437.fantom.run/static/images/ora-11g-inst-10.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>安装进度</p><img src="http://qnlcbj437.fantom.run/static/images/ora-11g-inst-11.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>执行root脚本</p><img src="http://qnlcbj437.fantom.run/static/images/ora-11g-inst-12.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[root@app-db11g ~]<span class="comment"># /u01/app/oraInventory/orainstRoot.sh </span></span><br><span class="line">Changing permissions of /u01/app/oraInventory.</span><br><span class="line">Adding <span class="built_in">read</span>,write permissions <span class="keyword">for</span> group.</span><br><span class="line">Removing <span class="built_in">read</span>,write,execute permissions <span class="keyword">for</span> world.</span><br><span class="line"></span><br><span class="line">Changing groupname of /u01/app/oraInventory to oinstall.</span><br><span class="line">The execution of the script is complete.</span><br><span class="line">[root@app-db11g ~]<span class="comment"># /u01/app/oracle/product/11.2.0/dbhome_1/root.sh </span></span><br><span class="line">Performing root user operation <span class="keyword">for</span> Oracle 11g </span><br><span class="line"></span><br><span class="line">The following environment variables are <span class="built_in">set</span> as:</span><br><span class="line">    ORACLE_OWNER= oracle</span><br><span class="line">    ORACLE_HOME=  /u01/app/oracle/product/11.2.0/dbhome_1</span><br><span class="line"></span><br><span class="line">Enter the full pathname of the <span class="built_in">local</span> bin directory: [/usr/<span class="built_in">local</span>/bin]: </span><br><span class="line">   Copying dbhome to /usr/<span class="built_in">local</span>/bin ...</span><br><span class="line">   Copying oraenv to /usr/<span class="built_in">local</span>/bin ...</span><br><span class="line">   Copying coraenv to /usr/<span class="built_in">local</span>/bin ...</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Creating /etc/oratab file...</span><br><span class="line">Entries will be added to the /etc/oratab file as needed by</span><br><span class="line">Database Configuration Assistant when a database is created</span><br><span class="line">Finished running generic part of root script.</span><br><span class="line">Now product-specific root actions will be performed.</span><br><span class="line">Finished product-specific root actions.</span><br></pre></td></tr></table></figure></li><li><p>安装完成 </p><img src="http://qnlcbj437.fantom.run/static/images/ora-11g-inst-13.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li></ul><h3 id="8-配置监听"><a href="#8-配置监听" class="headerlink" title="8. 配置监听"></a>8. 配置监听</h3><ul><li><p>执行netca配置监听</p><img src="http://qnlcbj437.fantom.run/static/images/ora-11g-netca-01.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>选择增加</p><img src="http://qnlcbj437.fantom.run/static/images/ora-11g-netca-02.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>监听名称</p><img src="http://qnlcbj437.fantom.run/static/images/ora-11g-netca-03.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>监听协议</p><img src="http://qnlcbj437.fantom.run/static/images/ora-11g-netca-04.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>监听端口</p><img src="http://qnlcbj437.fantom.run/static/images/ora-11g-netca-05.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>不配置另一个监听</p><img src="http://qnlcbj437.fantom.run/static/images/ora-11g-netca-06.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>监听配置完成</p><img src="http://qnlcbj437.fantom.run/static/images/ora-11g-netca-07.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li></ul><h3 id="9-创建数据库"><a href="#9-创建数据库" class="headerlink" title="9. 创建数据库"></a>9. 创建数据库</h3><ul><li><p>dbca配置助手欢迎页面</p><img src="http://qnlcbj437.fantom.run/static/images/ora-11g-dbca-01.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>选择创建操作</p><img src="http://qnlcbj437.fantom.run/static/images/ora-11g-dbca-02.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>选择创建数据库的类型<br>类型有通用或事务、数据仓库和自定义，我们选择通用或事务，也就是常说的OLTP</p><img src="http://qnlcbj437.fantom.run/static/images/ora-11g-dbca-03.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>填写SID<br>Global Database Name和SID一致</p><img src="http://qnlcbj437.fantom.run/static/images/ora-11g-dbca-04.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>开启EM<br>EM是Oracle的企业管理器，启动后可以在Web Console对数据库进行监控和操作</p><img src="http://qnlcbj437.fantom.run/static/images/ora-11g-dbca-05.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>设置统一密码</p><img src="http://qnlcbj437.fantom.run/static/images/ora-11g-dbca-06.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>选择文件系统</p><img src="http://qnlcbj437.fantom.run/static/images/ora-11g-dbca-07.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>开启闪回区</p><img src="http://qnlcbj437.fantom.run/static/images/ora-11g-dbca-08.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>不勾选示例</p><img src="http://qnlcbj437.fantom.run/static/images/ora-11g-dbca-09.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>设置内存、进程、字符集、连接模式<br>内存设置为自动管理，进程默认150就可以，正式环境很具使用情况进行调整，连接模式选择专用服务器</p><img src="http://qnlcbj437.fantom.run/static/images/ora-11g-dbca-10.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>字符集选用AL32UTF8或者ZHS16GBK，根据应用需求，这里我们选择ZHS16GBK</p><img src="http://qnlcbj437.fantom.run/static/images/ora-11g-dbca-11.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>Database Storage<br>这里可以查看和增加控制文件、数据文件以及REDO日志组</p><img src="http://qnlcbj437.fantom.run/static/images/ora-11g-dbca-12.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>创建数据库</p><img src="http://qnlcbj437.fantom.run/static/images/ora-11g-dbca-13.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>创建过程<br>等待创建完成，约30分钟左右</p><img src="http://qnlcbj437.fantom.run/static/images/ora-11g-dbca-14.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li></ul><h3 id="10-数据库测试"><a href="#10-数据库测试" class="headerlink" title="10. 数据库测试"></a>10. 数据库测试</h3><ul><li><p>以sysdba登陆数据库</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[oracle@app-db11g ~]$ sqlplus / as sysdba</span><br><span class="line"></span><br><span class="line">SQL*Plus: Release 11.2.0.4.0 Production on Sun Feb 24 15:05:01 2019</span><br><span class="line"></span><br><span class="line">Copyright (c) 1982, 2013, Oracle.  All rights reserved.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Connected to:</span><br><span class="line">Oracle Database 11g Enterprise Edition <span class="keyword">Release</span> <span class="number">11.2</span><span class="number">.0</span><span class="number">.4</span><span class="number">.0</span> - <span class="number">64</span><span class="built_in">bit</span> Production</span><br><span class="line"><span class="keyword">With</span> the Partitioning, OLAP, <span class="keyword">Data</span> <span class="keyword">Mining</span> <span class="keyword">and</span> <span class="built_in">Real</span> Application Testing options</span><br><span class="line"></span><br><span class="line"><span class="keyword">SQL</span>&gt;</span><br></pre></td></tr></table></figure></li><li><p>查看数据库状态</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; select instance_name,status from v$instance;</span><br><span class="line"></span><br><span class="line">INSTANCE_NAME STATUS</span><br><span class="line"><span class="comment">---------------- ------------</span></span><br><span class="line">prod1 OPEN</span><br></pre></td></tr></table></figure></li><li><p>查看数据文件</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; select name from v$datafile;</span><br><span class="line"></span><br><span class="line">NAME</span><br><span class="line"><span class="comment">--------------------------------------------------</span></span><br><span class="line">/u01/app/oracle/oradata/prod1/system01.dbf</span><br><span class="line">/u01/app/oracle/oradata/prod1/sysaux01.dbf</span><br><span class="line">/u01/app/oracle/oradata/prod1/undotbs01.dbf</span><br><span class="line">/u01/app/oracle/oradata/prod1/users01.dbf</span><br></pre></td></tr></table></figure></li></ul>]]></content>
    
    
    <summary type="html">&lt;h3 id=&quot;1-资源描述&quot;&gt;&lt;a href=&quot;#1-资源描述&quot; class=&quot;headerlink&quot; title=&quot;1. 资源描述&quot;&gt;&lt;/a&gt;1. 资源描述&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://wiki.centos.org/Download&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;CentOS 6.10&lt;/a&gt; 操作系统可选择6.x系列其他的版本&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.oracle.com/technetwork/database/enterprise-edition/downloads/index.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Oracle 11.2.0.4&lt;/a&gt; 我使用的数据库版本需要MOS才能下载，可选择11.2.0.1版本&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.virtualbox.org/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Virtual Box 5.2.22&lt;/a&gt; 虚拟机软件可选择最新版，建议使用5系列，比较稳定&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.realvnc.com/en/connect/download/viewer/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;VNC Viewer 6.18&lt;/a&gt; 远程桌面工具，可选用最新版&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.netsarang.com/en/xshell/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Xshell 5&lt;/a&gt; 远程终端工具5系列官网已经不提供下载了，可选择6系列，有使用限制，单个窗口最大可开4个标签，可选择其他终端工具比如&lt;a href=&quot;https://putty.org/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Putty&lt;/a&gt;，&lt;a href=&quot;https://mobaxterm.mobatek.net/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;MobaXterm&lt;/a&gt;等&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="Oracle" scheme="http://falkon.cn/categories/Oracle/"/>
    
    
    <category term="Install" scheme="http://falkon.cn/tags/Install/"/>
    
    <category term="11g" scheme="http://falkon.cn/tags/11g/"/>
    
  </entry>
  
  <entry>
    <title>Linux Installation 11g RAC</title>
    <link href="http://falkon.cn/2021/01/27/database/rhel-install-oracle11g-rac/"/>
    <id>http://falkon.cn/2021/01/27/database/rhel-install-oracle11g-rac/</id>
    <published>2021-01-27T09:37:22.691Z</published>
    <updated>2021-01-27T03:11:44.562Z</updated>
    
    
    
    
    <category term="Oracle" scheme="http://falkon.cn/categories/Oracle/"/>
    
    
    <category term="RAC" scheme="http://falkon.cn/tags/RAC/"/>
    
    <category term="11g" scheme="http://falkon.cn/tags/11g/"/>
    
    <category term="UDEV" scheme="http://falkon.cn/tags/UDEV/"/>
    
  </entry>
  
  <entry>
    <title>Linux Installation Oracle11g GoldenGate</title>
    <link href="http://falkon.cn/2021/01/27/database/rhel-install-oracle11g-ogg/"/>
    <id>http://falkon.cn/2021/01/27/database/rhel-install-oracle11g-ogg/</id>
    <published>2021-01-27T09:37:22.686Z</published>
    <updated>2021-01-27T03:11:28.197Z</updated>
    
    <content type="html"><![CDATA[<h3 id="1-资源描述"><a href="#1-资源描述" class="headerlink" title="1. 资源描述"></a>1. 资源描述</h3><ul><li><a href="https://www.oracle.com/technetwork/cn/middleware/goldengate/downloads/index.html" target="_blank" rel="noopener">GoldenGate</a> 组件版本选择为12.3.0.1</li><li><a href="http://rpmfind.net/linux/epel/6/x86_64/Packages/r/rlwrap-0.42-1.el6.x86_64.rpm" target="_blank" rel="noopener">rlwrap</a> 可以解决Linux下sqlplus提供历史命令浏览、删除错误输入等功能</li></ul><h3 id="2-环境准备"><a href="#2-环境准备" class="headerlink" title="2. 环境准备"></a>2. 环境准备</h3><table><thead><tr><th>名称</th><th>主机名</th><th>SID</th><th>IP地址</th></tr></thead><tbody><tr><td>源端</td><td>ogg-src</td><td>prod1</td><td>192.168.56.103</td></tr><tr><td>目标端</td><td>ogg-trg</td><td>prod2</td><td>192.168.56.104</td></tr></tbody></table><a id="more"></a><h3 id="3-目录及配置"><a href="#3-目录及配置" class="headerlink" title="3. 目录及配置"></a>3. 目录及配置</h3><ul><li>创建安装目录<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 源端创建目录</span></span><br><span class="line">mkdir -p /u01/app/oracle/product/11.2.0/oggcore_1</span><br><span class="line"><span class="comment"># 目标端创建目录</span></span><br><span class="line">mkdir -p /u01/app/oracle/product/11.2.0/oggcore_1</span><br></pre></td></tr></table></figure></li><li>配置环境变量<br>每次配置完环境变量别忘了执行<code>source .bash_profile</code>使配置生效<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 源端添加环境变量</span></span><br><span class="line">[oracle@ogg-src ~]$ vi .bash_profile</span><br><span class="line"><span class="built_in">export</span> ORACLE_BASE=/u01/app/oracle</span><br><span class="line"><span class="built_in">export</span> ORACLE_HOME=<span class="variable">$ORACLE_BASE</span>/product/11.2.0/dbhome_1</span><br><span class="line"><span class="built_in">export</span> ORACLE_SID=prod1</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$ORACLE_HOME</span>/bin:<span class="variable">$PATH</span></span><br><span class="line"><span class="built_in">export</span> OGG_HOME=/u01/app/oracle/product/11.2.0/oggcore_1</span><br><span class="line"><span class="built_in">export</span> LD_LIBRARY_PATH=<span class="variable">$ORACLE_HOME</span>/lib:<span class="variable">$OGG_HOME</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 目标端添加环境变量</span></span><br><span class="line">[oracle@ogg-trg ~]$ vi .bash_profile</span><br><span class="line"><span class="built_in">export</span> ORACLE_BASE=/u01/app/oracle</span><br><span class="line"><span class="built_in">export</span> ORACLE_HOME=<span class="variable">$ORACLE_BASE</span>/product/11.2.0/dbhome_1</span><br><span class="line"><span class="built_in">export</span> ORACLE_SID=prod2</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$ORACLE_HOME</span>/bin:<span class="variable">$PATH</span></span><br><span class="line"><span class="built_in">export</span> OGG_HOME=/u01/app/oracle/product/11.2.0/oggcore_1</span><br><span class="line"><span class="built_in">export</span> LD_LIBRARY_PATH=<span class="variable">$ORACLE_HOME</span>/lib:<span class="variable">$OGG_HOME</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="4-开始安装"><a href="#4-开始安装" class="headerlink" title="4. 开始安装"></a>4. 开始安装</h3><ul><li><p>解压安装包</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@ogg-src home]<span class="comment"># unzip 123014_fbo_ggs_Linux_x64_shiphome.zip</span></span><br><span class="line"><span class="comment"># VNC Viewer连接服务器操作</span></span><br><span class="line">[oracle@ogg-src ~]$ <span class="built_in">cd</span> /home/fbo_ggs_Linux_x64_shiphome/Disk1/</span><br><span class="line">[oracle@ogg-src Disk1]$ ./runInstaller</span><br></pre></td></tr></table></figure></li><li><p>选择数据库版本对应的GoldenGate版本</p><img src="http://qnlcbj437.fantom.run/static/images/ora-inst-ogg-01.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>指定安装目录</p><img src="http://qnlcbj437.fantom.run/static/images/ora-inst-ogg-02.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>汇总信息</p><img src="http://qnlcbj437.fantom.run/static/images/ora-inst-ogg-03.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>安装过程</p><img src="http://qnlcbj437.fantom.run/static/images/ora-inst-ogg-04.png?imageMogr2/auto-orient/thumbnail/700x/blur/1x0/quality/100|imageslim"></li><li><p>目标端安装步骤同上</p></li><li><p>配置OGG快捷命令和回写<br>配置快捷方式和回写需要安装readline和rlwrap两个依赖包，readline系统光盘里有，使用<code>yum</code>命令安装即可，rlwrap包需要下载使用<code>rpm -ivh rlwrap-0.42-1.el6.x86_64.rpm</code>命令安装</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">alias</span> ggsci=<span class="string">'rlwrap /u01/app/oracle/product/11.2.0/oggcore_1/ggsci'</span></span><br><span class="line">[oracle@ogg-src ~]$ <span class="built_in">which</span> ggsci</span><br><span class="line"><span class="built_in">alias</span> ggsci=<span class="string">'rlwrap /u01/app/oracle/product/11.2.0/oggcore_1/ggsci'</span></span><br><span class="line">        /usr/bin/rlwrap</span><br><span class="line">        </span><br><span class="line"><span class="comment"># 目标端添加并验证</span></span><br><span class="line"><span class="built_in">alias</span> ggsci=<span class="string">'rlwrap /u01/app/oracle/product/11.2.0/oggcore_1/ggsci'</span></span><br><span class="line">[oracle@ogg-trg ~]$ <span class="built_in">which</span> ggsci</span><br><span class="line"><span class="built_in">alias</span> ggsci=<span class="string">'rlwrap /u01/app/oracle/product/11.2.0/oggcore_1/ggsci'</span></span><br><span class="line">        /usr/bin/rlwrap</span><br></pre></td></tr></table></figure></li></ul><h3 id="5-测试"><a href="#5-测试" class="headerlink" title="5. 测试"></a>5. 测试</h3><ul><li>源端<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[oracle@ogg-src ~]$ ggsci</span><br><span class="line"></span><br><span class="line">Oracle GoldenGate Command Interpreter <span class="keyword">for</span> Oracle</span><br><span class="line">Version 12.3.0.1.4 OGGCORE_12.3.0.1.0_PLATFORMS_180415.0359_FBO</span><br><span class="line">Linux, x64, 64bit (optimized), Oracle 11g on Apr 15 2018 21:16:09</span><br><span class="line">Operating system character <span class="built_in">set</span> identified as UTF-8.</span><br><span class="line"></span><br><span class="line">Copyright (C) 1995, 2018, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">GGSCI (ogg-src) 1&gt;</span><br></pre></td></tr></table></figure></li><li>目标端<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[oracle@ogg-trg ~]$ ggsci</span><br><span class="line"></span><br><span class="line">Oracle GoldenGate Command Interpreter <span class="keyword">for</span> Oracle</span><br><span class="line">Version 12.3.0.1.4 OGGCORE_12.3.0.1.0_PLATFORMS_180415.0359_FBO</span><br><span class="line">Linux, x64, 64bit (optimized), Oracle 11g on Apr 15 2018 21:16:09</span><br><span class="line">Operating system character <span class="built_in">set</span> identified as UTF-8.</span><br><span class="line"></span><br><span class="line">Copyright (C) 1995, 2018, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">GGSCI (ogg-trg) 1&gt;</span><br></pre></td></tr></table></figure></li></ul>]]></content>
    
    
    <summary type="html">&lt;h3 id=&quot;1-资源描述&quot;&gt;&lt;a href=&quot;#1-资源描述&quot; class=&quot;headerlink&quot; title=&quot;1. 资源描述&quot;&gt;&lt;/a&gt;1. 资源描述&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.oracle.com/technetwork/cn/middleware/goldengate/downloads/index.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;GoldenGate&lt;/a&gt; 组件版本选择为12.3.0.1&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://rpmfind.net/linux/epel/6/x86_64/Packages/r/rlwrap-0.42-1.el6.x86_64.rpm&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;rlwrap&lt;/a&gt; 可以解决Linux下sqlplus提供历史命令浏览、删除错误输入等功能&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;2-环境准备&quot;&gt;&lt;a href=&quot;#2-环境准备&quot; class=&quot;headerlink&quot; title=&quot;2. 环境准备&quot;&gt;&lt;/a&gt;2. 环境准备&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;名称&lt;/th&gt;
&lt;th&gt;主机名&lt;/th&gt;
&lt;th&gt;SID&lt;/th&gt;
&lt;th&gt;IP地址&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;&lt;tr&gt;
&lt;td&gt;源端&lt;/td&gt;
&lt;td&gt;ogg-src&lt;/td&gt;
&lt;td&gt;prod1&lt;/td&gt;
&lt;td&gt;192.168.56.103&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;目标端&lt;/td&gt;
&lt;td&gt;ogg-trg&lt;/td&gt;
&lt;td&gt;prod2&lt;/td&gt;
&lt;td&gt;192.168.56.104&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;</summary>
    
    
    
    <category term="Oracle" scheme="http://falkon.cn/categories/Oracle/"/>
    
    
    <category term="GoldenGate" scheme="http://falkon.cn/tags/GoldenGate/"/>
    
  </entry>
  
  <entry>
    <title>PGA_AGGREGATE_TARGET specified is high</title>
    <link href="http://falkon.cn/2021/01/27/database/pga_aggregate_target-specified-is-high/"/>
    <id>http://falkon.cn/2021/01/27/database/pga_aggregate_target-specified-is-high/</id>
    <published>2021-01-27T09:37:22.679Z</published>
    <updated>2021-01-27T03:10:51.078Z</updated>
    
    <content type="html"><![CDATA[<ul><li>启动数据库出现PGA_AGGREGATE_TARGET specified is high</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PGA_AGGREGATE_TARGET specified is high</span><br><span class="line">Errors <span class="keyword">in</span> file /u01/app/oracle/diag/rdbms/shdb551/shdb551/trace/shdb551_ora_9494.trc  (incident=122887):</span><br><span class="line">ORA-00700: soft internal error, arguments: [pga physmem <span class="built_in">limit</span>], [12752781312], [10969017344], [], [], [], [], [], [], [], [], []</span><br><span class="line">Incident details <span class="keyword">in</span>: /u01/app/oracle/diag/rdbms/shdb551/shdb551/incident/incdir_122887/shdb551_ora_9494_i122887.trc</span><br></pre></td></tr></table></figure><a id="more"></a><ul><li>查看trace信息,发现是PGA设置过大导致错误</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">[root@sfcpid1 ~]<span class="comment"># more /u01/app/oracle/diag/rdbms/sfcpid1/sfcpid1/incident/incdir_163849/sfcpid1_ora_20259_i163849.trc</span></span><br><span class="line">Dump file /u01/app/oracle/diag/rdbms/sfcpid1/sfcpid1/incident/incdir_163849/sfcpid1_ora_20259_i163849.trc</span><br><span class="line">Oracle Database 19c Enterprise Edition Release 19.0.0.0.0 - Production</span><br><span class="line">Version 19.5.2.0.0</span><br><span class="line">Build label:    RDBMS_19.3.0.0.0DBRU_LINUX.X64_190417</span><br><span class="line">ORACLE_HOME:    /u01/app/oracle/product/19.0.0/dbhome_1</span><br><span class="line">System name:    Linux</span><br><span class="line">Node name:      sfcpid1</span><br><span class="line">Release:        3.10.0-1127.el7.x86_64</span><br><span class="line">Version:        <span class="comment">#1 SMP Tue Feb 18 16:39:12 EST 2020</span></span><br><span class="line">Machine:        x86_64</span><br><span class="line">Instance name: sfcpid1</span><br><span class="line">Redo thread mounted by this instance: 0 &lt;none&gt;</span><br><span class="line">Oracle process number: 0</span><br><span class="line">Unix process pid: 20259, image: </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*** 2020-08-24T16:15:36.805587+08:00</span><br><span class="line">[TOC00000]</span><br><span class="line">Jump to table of contents</span><br><span class="line">Dump continued from file: /u01/app/oracle/diag/rdbms/sfcpid1/sfcpid1/trace/sfcpid1_ora_20259.trc</span><br><span class="line">[TOC00001]</span><br><span class="line">ORA-00700: soft internal error, arguments: [pga physmem <span class="built_in">limit</span>], [12752781312], [10969017344], [], [], [], [], [], [], [], [], []</span><br><span class="line"></span><br><span class="line">[TOC00001-END]</span><br><span class="line">[TOC00002]</span><br><span class="line">========= Dump <span class="keyword">for</span> incident 163849 (ORA 700 [pga physmem <span class="built_in">limit</span>]) ========</span><br><span class="line">[TOC00003]</span><br><span class="line">----- Beginning of Customized Incident Dump(s) -----</span><br><span class="line"> </span><br><span class="line">WARNING: PGA_AGGREGATE_TARGET (12162 MB) is too high <span class="keyword">for</span></span><br><span class="line">         the amount of physical memory (63921 MB) and</span><br><span class="line">         SGA size (36608 MB) - it should be less than 10460 MB.</span><br><span class="line"> </span><br><span class="line">----- End of Customized Incident Dump(s) -----</span><br><span class="line">[TOC00003-END]</span><br><span class="line"></span><br><span class="line">*** 2020-08-24T16:15:36.828334+08:00</span><br><span class="line">dbkedDefDump(): Starting incident default dumps (flags=0x2, level=3, mask=0x0)</span><br><span class="line">[TOC00004]</span><br><span class="line">----- SQL Statement (None) -----</span><br><span class="line">Current SQL information unavailable - no session.</span><br><span class="line">[TOC00004-END]</span><br><span class="line"></span><br><span class="line">[TOC00005]</span><br><span class="line">----- Call Stack Trace -----</span><br><span class="line">calling              call     entry                argument values <span class="keyword">in</span> hex      </span><br><span class="line">location             <span class="built_in">type</span>     point                (? means dubious value)     </span><br><span class="line">-------------------- -------- -------------------- ----------------------------</span><br><span class="line">ksedst1()+95         call     kgdsdst()            7FFEFD089840 000000002</span><br><span class="line">                                                   7FFEFD083B70 ? 7FFEFD083C88 ?</span><br><span class="line">                                                   000000000 000000082 ?</span><br></pre></td></tr></table></figure><ul><li>根据trace信息里给出的建议值修改PGA</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; alter system set pga_aggregate_target=10460M scope=spfile;</span><br><span class="line"></span><br><span class="line">System altered.</span><br></pre></td></tr></table></figure><ul><li>修改完成后重启数据库，发现错误已经消失</li></ul>]]></content>
    
    
    <summary type="html">&lt;ul&gt;
&lt;li&gt;启动数据库出现PGA_AGGREGATE_TARGET specified is high&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight sh&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;PGA_AGGREGATE_TARGET specified is high&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Errors &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; file /u01/app/oracle/diag/rdbms/shdb551/shdb551/trace/shdb551_ora_9494.trc  (incident=122887):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ORA-00700: soft internal error, arguments: [pga physmem &lt;span class=&quot;built_in&quot;&gt;limit&lt;/span&gt;], [12752781312], [10969017344], [], [], [], [], [], [], [], [], []&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Incident details &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt;: /u01/app/oracle/diag/rdbms/shdb551/shdb551/incident/incdir_122887/shdb551_ora_9494_i122887.trc&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="Oracle" scheme="http://falkon.cn/categories/Oracle/"/>
    
    
    <category term="ORA-00700" scheme="http://falkon.cn/tags/ORA-00700/"/>
    
  </entry>
  
  <entry>
    <title>Oracle 19.5 Patch 30830913 apply (pdb CDB$ROOT) WITH ERRORS</title>
    <link href="http://falkon.cn/2021/01/27/database/patch-30830913-apply-with%20errors/"/>
    <id>http://falkon.cn/2021/01/27/database/patch-30830913-apply-with%20errors/</id>
    <published>2021-01-27T09:37:22.673Z</published>
    <updated>2021-01-27T03:10:30.829Z</updated>
    
    <content type="html"><![CDATA[<ul><li>19.3升级19.5.2，建库出现如下告警</li></ul><a id="more"></a><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">PDB<span class="variable">$SEED</span>(2):***************************************************************</span><br><span class="line">PDB<span class="variable">$SEED</span>(2):WARNING: Pluggable Database PDB<span class="variable">$SEED</span> with pdb id - 2 is</span><br><span class="line">PDB<span class="variable">$SEED</span>(2):         altered with errors or warnings. Please look into</span><br><span class="line">PDB<span class="variable">$SEED</span>(2):         PDB_PLUG_IN_VIOLATIONS view <span class="keyword">for</span> more details.</span><br><span class="line">PDB<span class="variable">$SEED</span>(2):***************************************************************</span><br><span class="line">2020-08-09T17:16:00.606239+08:00</span><br><span class="line">PDB<span class="variable">$SEED</span>(2):Opening pdb with no Resource Manager plan active</span><br><span class="line">PDB<span class="variable">$SEED</span>(2):joxcsys_required_dirobj_exists: directory object exists with required path /u01/app/oracle/product/19.3.0/dbhome_1/javavm/admin/, pid 14333 cid 2</span><br><span class="line">2020-08-09T17:16:01.609748+08:00</span><br><span class="line">Pluggable database PDB<span class="variable">$SEED</span> opened <span class="built_in">read</span> write</span><br><span class="line">Completed: alter pluggable database <span class="string">"PDB<span class="variable">$SEED</span>"</span> open READ WRITE services=NONE</span><br><span class="line">2020-08-09T17:16:02.759184+08:00</span><br><span class="line">PDB<span class="variable">$SEED</span>(2):SERVER COMPONENT id=UTLRP_BGN: timestamp=2020-08-09 17:16:02 Container=PDB<span class="variable">$SEED</span> Id=2</span><br><span class="line">2020-08-09T17:16:08.440218+08:00</span><br><span class="line">PDB<span class="variable">$SEED</span>(2):TABLE SYS.WRI<span class="variable">$_OPTSTAT_HISTHEAD_HISTORY</span>: ADDED INTERVAL PARTITION SYS_P228 (44051) VALUES LESS THAN (TO_DATE(<span class="string">' 2020-08-10 00:00:00'</span>, <span class="string">'SYYYY-MM-DD HH24:MI:SS'</span>, <span class="string">'NLS_CALENDAR=GREGORIAN'</span>))</span><br><span class="line">PDB<span class="variable">$SEED</span>(2):TABLE SYS.WRI<span class="variable">$_OPTSTAT_HISTGRM_HISTORY</span>: ADDED INTERVAL PARTITION SYS_P231 (44051) VALUES LESS THAN (TO_DATE(<span class="string">' 2020-08-10 00:00:00'</span>, <span class="string">'SYYYY-MM-DD HH24:MI:SS'</span>, <span class="string">'NLS_CALENDAR=GREGORIAN'</span>))</span><br><span class="line">2020-08-09T17:22:15.310651+08:00</span><br><span class="line">PDB<span class="variable">$SEED</span>(2):Resize operation completed <span class="keyword">for</span> file<span class="comment"># 6, old size 348160K, new size 358400K</span></span><br><span class="line">2020-08-09T17:42:36.904868+08:00</span><br><span class="line">PDB<span class="variable">$SEED</span>(2):Resize operation completed <span class="keyword">for</span> file<span class="comment"># 5, old size 296960K, new size 307200K</span></span><br><span class="line">2020-08-09T18:02:19.222225+08:00</span><br><span class="line">Resize operation completed <span class="keyword">for</span> file<span class="comment"># 3, old size 727040K, new size 737280K</span></span><br><span class="line">2020-08-09T18:34:30.481765+08:00</span><br><span class="line">PDB<span class="variable">$SEED</span>(2):SERVER COMPONENT id=UTLRP_END: timestamp=2020-08-09 18:34:30 Container=PDB<span class="variable">$SEED</span> Id=2</span><br><span class="line">2020-08-09T18:34:33.329925+08:00</span><br><span class="line">PDB<span class="variable">$SEED</span>(2):</span><br><span class="line">PDB<span class="variable">$SEED</span>(2):XDB installed.</span><br><span class="line">PDB<span class="variable">$SEED</span>(2):</span><br><span class="line">PDB<span class="variable">$SEED</span>(2):XDB initialized.</span><br><span class="line">2020-08-09T18:34:38.289646+08:00</span><br><span class="line">alter pluggable database <span class="string">"PDB<span class="variable">$SEED</span>"</span> close immediate force instances=(<span class="string">'orcl'</span>)</span><br><span class="line">2020-08-09T18:34:38.420110+08:00</span><br><span class="line">PDB<span class="variable">$SEED</span>(2):JIT: pid 19251 requesting stop</span><br><span class="line">2020-08-09T18:34:41.794154+08:00</span><br><span class="line">PDB<span class="variable">$SEED</span>(2):Buffer Cache flush started: 2</span><br><span class="line">PDB<span class="variable">$SEED</span>(2):Buffer Cache flush finished: 2</span><br><span class="line">2020-08-09T18:34:42.894106+08:00</span><br><span class="line">Pluggable database PDB<span class="variable">$SEED</span> closed</span><br><span class="line">Completed: alter pluggable database <span class="string">"PDB<span class="variable">$SEED</span>"</span> close immediate force instances=(<span class="string">'orcl'</span>)</span><br><span class="line">2020-08-09T18:34:43.348420+08:00</span><br><span class="line">alter pluggable database <span class="string">"PDB<span class="variable">$SEED</span>"</span> open READ ONLY restricted instances=(<span class="string">'orcl'</span>)</span><br><span class="line">PDB<span class="variable">$SEED</span>(2):Autotune of undo retention is turned on. </span><br><span class="line">PDB<span class="variable">$SEED</span>(2):Endian <span class="built_in">type</span> of dictionary <span class="built_in">set</span> to little</span><br><span class="line">PDB<span class="variable">$SEED</span>(2):Undo initialization finished serial:0 start:782426536 end:782426536 diff:0 ms (0.0 seconds)</span><br><span class="line">2020-08-09T18:34:44.340859+08:00</span><br><span class="line">PDB<span class="variable">$SEED</span>(2):Database Characterset <span class="keyword">for</span> PDB<span class="variable">$SEED</span> is AL32UTF8</span><br><span class="line">2020-08-09T18:34:45.358778+08:00</span><br><span class="line">Violations: Type: 1, Count: 2</span><br><span class="line">PDB<span class="variable">$SEED</span>(2):***************************************************************</span><br><span class="line">PDB<span class="variable">$SEED</span>(2):WARNING: Pluggable Database PDB<span class="variable">$SEED</span> with pdb id - 2 is</span><br><span class="line">PDB<span class="variable">$SEED</span>(2):         altered with errors or warnings. Please look into</span><br><span class="line">PDB<span class="variable">$SEED</span>(2):         PDB_PLUG_IN_VIOLATIONS view <span class="keyword">for</span> more details.</span><br><span class="line">PDB<span class="variable">$SEED</span>(2):***************************************************************</span><br></pre></td></tr></table></figure><ul><li>检查组件注册信息发现SDO组件的状态为无效</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; select comp_id,version,status from dba_registry;</span><br><span class="line"></span><br><span class="line">COMP_ID                        VERSION                        STATUS</span><br><span class="line"><span class="comment">------------------------------ ------------------------------ --------------------------------------------</span></span><br><span class="line">CATALOG                        19.0.0.0.0                     VALID</span><br><span class="line">CATPROC                        19.0.0.0.0                     VALID</span><br><span class="line">RAC                            19.0.0.0.0                     OPTION OFF</span><br><span class="line">JAVAVM                         19.0.0.0.0                     VALID</span><br><span class="line">XML                            19.0.0.0.0                     VALID</span><br><span class="line">CATJAVA                        19.0.0.0.0                     VALID</span><br><span class="line">APS                            19.0.0.0.0                     VALID</span><br><span class="line">XDB                            19.0.0.0.0                     VALID</span><br><span class="line">OWM                            19.0.0.0.0                     VALID</span><br><span class="line">CONTEXT                        19.0.0.0.0                     VALID</span><br><span class="line">ORDIM                          19.0.0.0.0                     VALID</span><br><span class="line"></span><br><span class="line">COMP_ID                        VERSION                        STATUS</span><br><span class="line"><span class="comment">------------------------------ ------------------------------ --------------------------------------------</span></span><br><span class="line">SDO                            19.0.0.0.0                     INVALID</span><br><span class="line">XOQ                            19.0.0.0.0                     VALID</span><br><span class="line">OLS                            19.0.0.0.0                     VALID</span><br><span class="line">DV                             19.0.0.0.0                     VALID</span><br></pre></td></tr></table></figure><ul><li>查看PDB_PLUG_IN_VIOLATIONS信息，显示补丁状态为pending</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; select * from pdb_plug_in_violations;</span><br><span class="line"></span><br><span class="line">TIME                 NAME       CAUSE           TYPE      ERROR_NUMBER       LINE MESSAGE                        STATUS    ACTION                   CON_ID</span><br><span class="line"><span class="comment">-------------------- ---------- --------------- --------- ------------ ---------- ------------------------------ --------- -------------------- ----------</span></span><br><span class="line">09-AUG-20 06.35.57.8 PDB$SEED   SQL Patch       ERROR                0          1 19.5.2.0.0 Release_Update_Revi PENDING   <span class="keyword">Call</span> datapatch <span class="keyword">to</span> <span class="keyword">in</span>          <span class="number">2</span></span><br><span class="line"><span class="number">24974</span> PM                                                                          sion <span class="number">2003300442</span>: <span class="keyword">APPLY</span> <span class="keyword">with</span> st           stall <span class="keyword">in</span> the PDB <span class="keyword">or</span></span><br><span class="line">                                                                                  atus <span class="keyword">WITH</span> <span class="keyword">ERRORS</span> <span class="keyword">in</span> the CDB              the CDB</span><br><span class="line"></span><br><span class="line"><span class="number">09</span>-AUG<span class="number">-20</span> <span class="number">06.35</span><span class="number">.57</span><span class="number">.8</span> PDB$<span class="keyword">SEED</span>   <span class="keyword">SQL</span> <span class="keyword">Patch</span>       <span class="keyword">ERROR</span>                <span class="number">0</span>          <span class="number">2</span> <span class="number">19.5</span><span class="number">.2</span><span class="number">.0</span><span class="number">.0</span> Release_Update_Revi PENDING   <span class="keyword">Call</span> datapatch <span class="keyword">to</span> <span class="keyword">in</span>          <span class="number">2</span></span><br><span class="line"><span class="number">25780</span> PM                                                                          sion <span class="number">2003300442</span>: <span class="keyword">APPLY</span> <span class="keyword">with</span> st           stall <span class="keyword">in</span> the PDB <span class="keyword">or</span></span><br><span class="line">                                                                                  atus <span class="keyword">WITH</span> <span class="keyword">ERRORS</span> <span class="keyword">in</span> the PDB              the CDB</span><br><span class="line"></span><br><span class="line"><span class="number">09</span>-AUG<span class="number">-20</span> <span class="number">06.36</span><span class="number">.16</span><span class="number">.3</span> PDB1       <span class="keyword">SQL</span> <span class="keyword">Patch</span>       <span class="keyword">ERROR</span>                <span class="number">0</span>          <span class="number">1</span> <span class="number">19.5</span><span class="number">.2</span><span class="number">.0</span><span class="number">.0</span> Release_Update_Revi PENDING   <span class="keyword">Call</span> datapatch <span class="keyword">to</span> <span class="keyword">in</span>          <span class="number">3</span></span><br><span class="line"><span class="number">61910</span> PM                                                                          sion <span class="number">2003300442</span>: <span class="keyword">APPLY</span> <span class="keyword">with</span> st           stall <span class="keyword">in</span> the PDB <span class="keyword">or</span></span><br><span class="line">                                                                                  atus <span class="keyword">WITH</span> <span class="keyword">ERRORS</span> <span class="keyword">in</span> the CDB              the CDB</span><br><span class="line"></span><br><span class="line"><span class="built_in">TIME</span>                 <span class="keyword">NAME</span>       CAUSE           <span class="keyword">TYPE</span>      ERROR_NUMBER       LINE MESSAGE                        <span class="keyword">STATUS</span>    <span class="keyword">ACTION</span>                   CON_ID</span><br><span class="line"><span class="comment">-------------------- ---------- --------------- --------- ------------ ---------- ------------------------------ --------- -------------------- ----------</span></span><br><span class="line"></span><br><span class="line"><span class="number">09</span>-AUG<span class="number">-20</span> <span class="number">06.36</span><span class="number">.16</span><span class="number">.3</span> PDB1       <span class="keyword">SQL</span> <span class="keyword">Patch</span>       <span class="keyword">ERROR</span>                <span class="number">0</span>          <span class="number">2</span> <span class="number">19.5</span><span class="number">.2</span><span class="number">.0</span><span class="number">.0</span> Release_Update_Revi PENDING   <span class="keyword">Call</span> datapatch <span class="keyword">to</span> <span class="keyword">in</span>          <span class="number">3</span></span><br><span class="line"><span class="number">62322</span> PM                                                                          sion <span class="number">2003300442</span>: <span class="keyword">APPLY</span> <span class="keyword">with</span> st           stall <span class="keyword">in</span> the PDB <span class="keyword">or</span></span><br><span class="line">                                                                                  atus <span class="keyword">WITH</span> <span class="keyword">ERRORS</span> <span class="keyword">in</span> the PDB              the CDB</span><br></pre></td></tr></table></figure><ul><li>运行datapatch -verbose报错</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line">[oracle@aproddb19c OPatch]$ ./datapatch -verbose</span><br><span class="line">SQL Patching tool version 19.5.2.0.0 Production on Sun Aug  9 22:01:50 2020</span><br><span class="line">Copyright (c) 2012, 2020, Oracle.  All rights reserved.</span><br><span class="line"></span><br><span class="line">Log file <span class="keyword">for</span> this invocation: /u01/app/oracle/cfgtoollogs/sqlpatch/sqlpatch_580_2020_08_09_22_01_50/sqlpatch_invocation.log</span><br><span class="line"></span><br><span class="line">Connecting to database...OK</span><br><span class="line">Gathering database info...done</span><br><span class="line"></span><br><span class="line">Note:  Datapatch will only apply or rollback SQL fixes <span class="keyword">for</span> PDBs</span><br><span class="line">       that are <span class="keyword">in</span> an open state, no patches will be applied to closed PDBs.</span><br><span class="line">       Please refer to Note: Datapatch: Database 12c Post Patch SQL Automation</span><br><span class="line">       (Doc ID 1585822.1)</span><br><span class="line"></span><br><span class="line">Bootstrapping registry and package to current versions...done</span><br><span class="line">Determining current state...done</span><br><span class="line"></span><br><span class="line">Current state of interim SQL patches:</span><br><span class="line">  No interim patches found</span><br><span class="line"></span><br><span class="line">Current state of release update SQL patches:</span><br><span class="line">  Binary registry:</span><br><span class="line">    19.5.2.0.0 Release_Update_Revision 200330044204: Installed</span><br><span class="line">  PDB CDB<span class="variable">$ROOT</span>:</span><br><span class="line">    Applied 19.5.2.0.0 Release_Update_Revision 200330044204 with errors on 09-AUG-20 05.01.13.205235 PM</span><br><span class="line">  PDB PDB<span class="variable">$SEED</span>:</span><br><span class="line">    Applied 19.5.2.0.0 Release_Update_Revision 200330044204 with errors on 09-AUG-20 05.01.18.928517 PM</span><br><span class="line">  PDB PDB1:</span><br><span class="line">    Applied 19.5.2.0.0 Release_Update_Revision 200330044204 with errors on 09-AUG-20 05.01.18.928517 PM</span><br><span class="line"></span><br><span class="line">Adding patches to installation queue and performing prereq checks...done</span><br><span class="line">Installation queue:</span><br><span class="line">  For the following PDBs: CDB<span class="variable">$ROOT</span> PDB<span class="variable">$SEED</span> PDB1</span><br><span class="line">    No interim patches need to be rolled back</span><br><span class="line">    Patch 30830913 (Database Release Update Revision : 19.5.2.0.200414 (30830913)):</span><br><span class="line">      Apply from 19.1.0.0.0 Feature Release to 19.5.2.0.0 Release_Update_Revision 200330044204</span><br><span class="line">    No interim patches need to be applied</span><br><span class="line"></span><br><span class="line">Installing patches...</span><br><span class="line">Patch installation complete.  Total patches installed: 3</span><br><span class="line"></span><br><span class="line">Validating logfiles...done</span><br><span class="line">Patch 30830913 apply (pdb CDB<span class="variable">$ROOT</span>): WITH ERRORS</span><br><span class="line">  logfile: /u01/app/oracle/cfgtoollogs/sqlpatch/30830913/23492483/30830913_apply_ORCL_CDBROOT_2020Aug09_22_02_39.log (errors)</span><br><span class="line">  -&gt; Error at line 121015: script md/admin/catmdloc.sql</span><br><span class="line">      - ORA-29516: Aurora assertion failure: Bogus uncaught exception</span><br><span class="line">      - ORA-00604: error occurred at recursive SQL level 1</span><br><span class="line">      - ORA-29532: Java call terminated by uncaught Java exception:</span><br><span class="line">      - java.lang.ArrayIndexOutOfBoundsException</span><br><span class="line">  -&gt; Error at line 121071: script md/admin/catmdloc.sql</span><br><span class="line">      - ORA-29516: Aurora assertion failure: Bogus uncaught exception</span><br><span class="line">      - ORA-00604: error occurred at recursive SQL level 1</span><br><span class="line">      - ORA-29532: Java call terminated by uncaught Java exception:</span><br><span class="line">      - java.lang.ArrayIndexOutOfBoundsException</span><br><span class="line">Patch 30830913 apply (pdb PDB<span class="variable">$SEED</span>): WITH ERRORS</span><br><span class="line">  logfile: /u01/app/oracle/cfgtoollogs/sqlpatch/30830913/23492483/30830913_apply_ORCL_PDBSEED_2020Aug09_22_08_32.log (errors)</span><br><span class="line">  -&gt; Error at line 186555: script md/admin/catmdloc.sql</span><br><span class="line">      - ORA-29532: Java call terminated by uncaught Java exception:</span><br><span class="line">      - oracle.aurora.server.tools.loadjava.ToolsError:</span><br><span class="line">      - Error during loadjava: Failures occurred during processing.</span><br><span class="line">      - Check trace file <span class="keyword">for</span> details</span><br><span class="line">  -&gt; Error at line 186574: script md/admin/catmdloc.sql</span><br><span class="line">      - ORA-29532: Java call terminated by uncaught Java exception:</span><br><span class="line">      - oracle.aurora.server.tools.loadjava.ToolsError:</span><br><span class="line">      - Error during loadjava: Failures occurred during processing.</span><br><span class="line">      - Check trace file <span class="keyword">for</span> details</span><br><span class="line">  -&gt; Error at line 186617: script md/admin/catmdloc.sql</span><br><span class="line">      - ORA-29532: Java call terminated by uncaught Java exception:</span><br><span class="line">      - oracle.aurora.server.tools.loadjava.ToolsError:</span><br><span class="line">      - Error during loadjava: Failures occurred during processing.</span><br><span class="line">      - Check trace file <span class="keyword">for</span> details</span><br><span class="line">Patch 30830913 apply (pdb PDB1): WITH ERRORS</span><br><span class="line">  logfile: /u01/app/oracle/cfgtoollogs/sqlpatch/30830913/23492483/30830913_apply_ORCL_PDB1_2020Aug09_22_08_31.log (errors)</span><br><span class="line">  -&gt; Error at line 121015: script md/admin/catmdloc.sql</span><br><span class="line">      - ORA-29532: Java call terminated by uncaught Java exception:</span><br><span class="line">      - oracle.aurora.server.tools.loadjava.ToolsError:</span><br><span class="line">      - Error during loadjava: Failures occurred during processing.</span><br><span class="line">      - Check trace file <span class="keyword">for</span> details</span><br><span class="line">  -&gt; Error at line 121034: script md/admin/catmdloc.sql</span><br><span class="line">      - ORA-29532: Java call terminated by uncaught Java exception:</span><br><span class="line">      - oracle.aurora.server.tools.loadjava.ToolsError:</span><br><span class="line">      - Error during loadjava: Failures occurred during processing.</span><br><span class="line">      - Check trace file <span class="keyword">for</span> details</span><br><span class="line">  -&gt; Error at line 121077: script md/admin/catmdloc.sql</span><br><span class="line">      - ORA-29532: Java call terminated by uncaught Java exception:</span><br><span class="line">      - oracle.aurora.server.tools.loadjava.ToolsError:</span><br><span class="line">      - Error during loadjava: Failures occurred during processing.</span><br><span class="line">      - Check trace file <span class="keyword">for</span> details</span><br><span class="line"></span><br><span class="line">Please refer to MOS Note 1609718.1 and/or the invocation <span class="built_in">log</span></span><br><span class="line">/u01/app/oracle/cfgtoollogs/sqlpatch/sqlpatch_580_2020_08_09_22_01_50/sqlpatch_invocation.log</span><br><span class="line"><span class="keyword">for</span> information on how to resolve the above errors.</span><br><span class="line"></span><br><span class="line">SQL Patching tool complete on Sun Aug  9 22:44:28 2020</span><br></pre></td></tr></table></figure><ul><li>打OJVM补丁</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">[oracle@aproddb19c 30128191]$ /u01/app/oracle/product/19.3.0/dbhome_1/OPatch/opatch apply</span><br><span class="line">Oracle Interim Patch Installer version 12.2.0.1.17</span><br><span class="line">Copyright (c) 2020, Oracle Corporation.  All rights reserved.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Oracle Home       : /u01/app/oracle/product/19.3.0/dbhome_1</span><br><span class="line">Central Inventory : /u01/app/oraInventory</span><br><span class="line">   from           : /u01/app/oracle/product/19.3.0/dbhome_1/oraInst.loc</span><br><span class="line">OPatch version    : 12.2.0.1.17</span><br><span class="line">OUI version       : 12.2.0.7.0</span><br><span class="line">Log file location : /u01/app/oracle/product/19.3.0/dbhome_1/cfgtoollogs/opatch/opatch2020-08-10_20-54-50PM_1.log</span><br><span class="line"></span><br><span class="line">Verifying environment and performing prerequisite checks...</span><br><span class="line">OPatch continues with these patches:   30128191  </span><br><span class="line"></span><br><span class="line">Do you want to proceed? [y|n]</span><br><span class="line">y</span><br><span class="line">User Responded with: Y</span><br><span class="line">All checks passed.</span><br><span class="line"></span><br><span class="line">Please shutdown Oracle instances running out of this ORACLE_HOME on the <span class="built_in">local</span> system.</span><br><span class="line">(Oracle Home = <span class="string">'/u01/app/oracle/product/19.3.0/dbhome_1'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Is the <span class="built_in">local</span> system ready <span class="keyword">for</span> patching? [y|n]</span><br><span class="line">y</span><br><span class="line">User Responded with: Y</span><br><span class="line">Backing up files...</span><br><span class="line">Applying interim patch <span class="string">'30128191'</span> to OH <span class="string">'/u01/app/oracle/product/19.3.0/dbhome_1'</span></span><br><span class="line"></span><br><span class="line">Patching component oracle.javavm.server, 19.0.0.0.0...</span><br><span class="line"></span><br><span class="line">Patching component oracle.javavm.server.core, 19.0.0.0.0...</span><br><span class="line"></span><br><span class="line">Patching component oracle.rdbms.dbscripts, 19.0.0.0.0...</span><br><span class="line"></span><br><span class="line">Patching component oracle.rdbms, 19.0.0.0.0...</span><br><span class="line">Patch 30128191 successfully applied.</span><br><span class="line">Log file location: /u01/app/oracle/product/19.3.0/dbhome_1/cfgtoollogs/opatch/opatch2020-08-10_20-54-50PM_1.log</span><br><span class="line"></span><br><span class="line">OPatch succeeded.</span><br></pre></td></tr></table></figure><ul><li>再次运行datapatch -verbose</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">[oracle@aproddb19c 30128191]$ /u01/app/oracle/product/19.3.0/dbhome_1/OPatch/datapatch -verbose</span><br><span class="line">SQL Patching tool version 19.5.2.0.0 Production on Mon Aug 10 20:58:41 2020</span><br><span class="line">Copyright (c) 2012, 2020, Oracle.  All rights reserved.</span><br><span class="line"></span><br><span class="line">Log file <span class="keyword">for</span> this invocation: /u01/app/oracle/cfgtoollogs/sqlpatch/sqlpatch_25968_2020_08_10_20_58_41/sqlpatch_invocation.log</span><br><span class="line"></span><br><span class="line">Connecting to database...OK</span><br><span class="line">Gathering database info...done</span><br><span class="line"></span><br><span class="line">Note:  Datapatch will only apply or rollback SQL fixes <span class="keyword">for</span> PDBs</span><br><span class="line">       that are <span class="keyword">in</span> an open state, no patches will be applied to closed PDBs.</span><br><span class="line">       Please refer to Note: Datapatch: Database 12c Post Patch SQL Automation</span><br><span class="line">       (Doc ID 1585822.1)</span><br><span class="line"></span><br><span class="line">Bootstrapping registry and package to current versions...done</span><br><span class="line">Determining current state...done</span><br><span class="line"></span><br><span class="line">Current state of interim SQL patches:</span><br><span class="line">Interim patch 30128191 (OJVM RELEASE UPDATE: 19.5.0.0.191015 (30128191)):</span><br><span class="line">  Binary registry: Installed</span><br><span class="line">  PDB CDB<span class="variable">$ROOT</span>: Not installed</span><br><span class="line">  PDB PDB<span class="variable">$SEED</span>: Not installed</span><br><span class="line">  PDB PDB1: Not installed</span><br><span class="line"></span><br><span class="line">Current state of release update SQL patches:</span><br><span class="line">  Binary registry:</span><br><span class="line">    19.5.2.0.0 Release_Update_Revision 200330044204: Installed</span><br><span class="line">  PDB CDB<span class="variable">$ROOT</span>:</span><br><span class="line">    Applied 19.5.2.0.0 Release_Update_Revision 200330044204 with errors on 09-AUG-20 10.44.12.165096 PM</span><br><span class="line">  PDB PDB<span class="variable">$SEED</span>:</span><br><span class="line">    Applied 19.5.2.0.0 Release_Update_Revision 200330044204 with errors on 09-AUG-20 10.44.14.863020 PM</span><br><span class="line">  PDB PDB1:</span><br><span class="line">    Applied 19.5.2.0.0 Release_Update_Revision 200330044204 with errors on 09-AUG-20 10.44.16.806494 PM</span><br><span class="line"></span><br><span class="line">Adding patches to installation queue and performing prereq checks...done</span><br><span class="line">Installation queue:</span><br><span class="line">  For the following PDBs: CDB<span class="variable">$ROOT</span> PDB<span class="variable">$SEED</span> PDB1</span><br><span class="line">    No interim patches need to be rolled back</span><br><span class="line">    Patch 30830913 (Database Release Update Revision : 19.5.2.0.200414 (30830913)):</span><br><span class="line">      Apply from 19.1.0.0.0 Feature Release to 19.5.2.0.0 Release_Update_Revision 200330044204</span><br><span class="line">    The following interim patches will be applied:</span><br><span class="line">      30128191 (OJVM RELEASE UPDATE: 19.5.0.0.191015 (30128191))</span><br><span class="line"></span><br><span class="line">Installing patches...</span><br><span class="line">Patch installation complete.  Total patches installed: 6</span><br><span class="line"></span><br><span class="line">Validating logfiles...done</span><br><span class="line">Patch 30830913 apply (pdb CDB<span class="variable">$ROOT</span>): SUCCESS</span><br><span class="line">  logfile: /u01/app/oracle/cfgtoollogs/sqlpatch/30830913/23492483/30830913_apply_ORCL_CDBROOT_2020Aug10_21_02_35.log (no errors)</span><br><span class="line">Patch 30128191 apply (pdb CDB<span class="variable">$ROOT</span>): SUCCESS</span><br><span class="line">  logfile: /u01/app/oracle/cfgtoollogs/sqlpatch/30128191/23093535/30128191_apply_ORCL_CDBROOT_2020Aug10_21_00_36.log (no errors)</span><br><span class="line">Patch 30830913 apply (pdb PDB<span class="variable">$SEED</span>): SUCCESS</span><br><span class="line">  logfile: /u01/app/oracle/cfgtoollogs/sqlpatch/30830913/23492483/30830913_apply_ORCL_PDBSEED_2020Aug10_21_32_48.log (no errors)</span><br><span class="line">Patch 30128191 apply (pdb PDB<span class="variable">$SEED</span>): SUCCESS</span><br><span class="line">  logfile: /u01/app/oracle/cfgtoollogs/sqlpatch/30128191/23093535/30128191_apply_ORCL_PDBSEED_2020Aug10_21_32_34.log (no errors)</span><br><span class="line">Patch 30830913 apply (pdb PDB1): SUCCESS</span><br><span class="line">  logfile: /u01/app/oracle/cfgtoollogs/sqlpatch/30830913/23492483/30830913_apply_ORCL_PDB1_2020Aug10_21_32_46.log (no errors)</span><br><span class="line">Patch 30128191 apply (pdb PDB1): SUCCESS</span><br><span class="line">  logfile: /u01/app/oracle/cfgtoollogs/sqlpatch/30128191/23093535/30128191_apply_ORCL_PDB1_2020Aug10_21_32_33.log (no errors)</span><br><span class="line">SQL Patching tool complete on Mon Aug 10 22:51:06 2020</span><br></pre></td></tr></table></figure><ul><li>编译无效对象</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; @?/rdbms/admin/utlrp.sql</span><br><span class="line"></span><br><span class="line">Session altered.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">TIMESTAMP</span><br><span class="line"><span class="comment">--------------------------------------------------------------------------------</span></span><br><span class="line">COMP_TIMESTAMP UTLRP_BGN              2020-08-10 22:54:34</span><br><span class="line"></span><br><span class="line">DOC&gt;   The following PL/SQL block invokes UTL_RECOMP to recompile invalid</span><br><span class="line">DOC&gt;   objects in the database. Recompilation time is proportional to the</span><br><span class="line">DOC&gt;   number of invalid objects in the database, so this command may take</span><br><span class="line">DOC&gt;   a long time to execute on a database with a large number of invalid</span><br><span class="line">DOC&gt;   objects.</span><br><span class="line">DOC&gt;</span><br><span class="line">DOC&gt;   Use the following queries to track recompilation progress:</span><br><span class="line">DOC&gt;</span><br><span class="line">DOC&gt;   1. Query returning the number of invalid objects remaining. This</span><br><span class="line">DOC&gt;      number should decrease with time.</span><br><span class="line">DOC&gt;         SELECT COUNT(*) FROM obj$ WHERE status IN (4, 5, 6);</span><br><span class="line">DOC&gt;</span><br><span class="line">DOC&gt;   2. Query returning the number of objects compiled so far. This number</span><br><span class="line">DOC&gt;      should increase with time.</span><br><span class="line">DOC&gt;         SELECT COUNT(*) FROM UTL_RECOMP_COMPILED;</span><br><span class="line">DOC&gt;</span><br><span class="line">DOC&gt;   This script automatically chooses serial or parallel recompilation</span><br><span class="line">DOC&gt;   based on the number of CPUs available (parameter cpu_count) multiplied</span><br><span class="line">DOC&gt;   by the number of threads per CPU (parameter parallel_threads_per_cpu).</span><br><span class="line">DOC&gt;   On RAC, this number is added across all RAC nodes.</span><br><span class="line">DOC&gt;</span><br><span class="line">DOC&gt;   UTL_RECOMP uses DBMS_SCHEDULER to create jobs for parallel</span><br><span class="line">DOC&gt;   recompilation. Jobs are created without instance affinity so that they</span><br><span class="line">DOC&gt;   can migrate across RAC nodes. Use the following queries to verify</span><br><span class="line">DOC&gt;   whether UTL_RECOMP jobs are being created and run correctly:</span><br><span class="line">DOC&gt;</span><br><span class="line">DOC&gt;   1. Query showing jobs created by UTL_RECOMP</span><br><span class="line">DOC&gt;         SELECT job_name FROM dba_scheduler_jobs</span><br><span class="line">DOC&gt;            WHERE job_name like 'UTL_RECOMP_SLAVE_%';</span><br><span class="line">DOC&gt;</span><br><span class="line">DOC&gt;   2. Query showing UTL_RECOMP jobs that are running</span><br><span class="line">DOC&gt;         SELECT job_name FROM dba_scheduler_running_jobs</span><br><span class="line">DOC&gt;            WHERE job_name like 'UTL_RECOMP_SLAVE_%';</span><br><span class="line">DOC&gt;#</span><br><span class="line"></span><br><span class="line">PL/SQL procedure successfully completed.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">TIMESTAMP</span><br><span class="line"><span class="comment">--------------------------------------------------------------------------------</span></span><br><span class="line">COMP_TIMESTAMP UTLRP_END              2020-08-10 22:55:03</span><br><span class="line"></span><br><span class="line">DOC&gt; The following query reports the number of invalid objects.</span><br><span class="line">DOC&gt;</span><br><span class="line">DOC&gt; If the number is higher than expected, please examine the error</span><br><span class="line">DOC&gt; messages reported with each object (using SHOW ERRORS) to see if they</span><br><span class="line">DOC&gt; point to system misconfiguration or resource constraints that must be</span><br><span class="line">DOC&gt; fixed before attempting to recompile these objects.</span><br><span class="line">DOC&gt;#</span><br><span class="line"></span><br><span class="line">OBJECTS <span class="keyword">WITH</span> <span class="keyword">ERRORS</span></span><br><span class="line"><span class="comment">-------------------</span></span><br><span class="line">                  <span class="number">0</span></span><br><span class="line"></span><br><span class="line">DOC&gt; The <span class="keyword">following</span> <span class="keyword">query</span> reports the <span class="built_in">number</span> <span class="keyword">of</span> <span class="keyword">exceptions</span> caught during</span><br><span class="line">DOC&gt; recompilation. <span class="keyword">If</span> this <span class="built_in">number</span> <span class="keyword">is</span> non-zero, please <span class="keyword">query</span> the <span class="keyword">error</span></span><br><span class="line">DOC&gt; messages <span class="keyword">in</span> the <span class="keyword">table</span> UTL_RECOMP_ERRORS <span class="keyword">to</span> see <span class="keyword">if</span> <span class="keyword">any</span> <span class="keyword">of</span> these <span class="keyword">errors</span></span><br><span class="line">DOC&gt; <span class="keyword">are</span> due <span class="keyword">to</span> misconfiguration <span class="keyword">or</span> <span class="keyword">resource</span> <span class="keyword">constraints</span> that must be</span><br><span class="line">DOC&gt; <span class="keyword">fixed</span> <span class="keyword">before</span> objects can compile successfully.</span><br><span class="line">DOC&gt; Note: Typical compilation <span class="keyword">errors</span> (due <span class="keyword">to</span> coding <span class="keyword">errors</span>) <span class="keyword">are</span> <span class="keyword">not</span></span><br><span class="line">DOC&gt;       logged <span class="keyword">into</span> this <span class="keyword">table</span>: they <span class="keyword">go</span> <span class="keyword">into</span> DBA_ERRORS instead.</span><br><span class="line">DOC&gt;<span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ERRORS</span> DURING RECOMPILATION</span><br><span class="line"><span class="comment">---------------------------</span></span><br><span class="line">                          <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> created.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PL/<span class="keyword">SQL</span> <span class="keyword">procedure</span> successfully completed.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> dropped.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PL/<span class="keyword">SQL</span> <span class="keyword">procedure</span> successfully completed.</span><br></pre></td></tr></table></figure><ul><li>检查无效对象</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; SELECT owner, object_name, object_type,status FROM dba_objects WHERE status = 'INVALID';</span><br><span class="line"></span><br><span class="line">no rows selected</span><br></pre></td></tr></table></figure><ul><li>再次检查组件注册</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; select comp_id,comp_name,version,status from dba_registry;</span><br><span class="line"></span><br><span class="line">COMP_ID              COMP_NAME                                          VERSION    STATUS</span><br><span class="line"><span class="comment">-------------------- -------------------------------------------------- ---------- ----------</span></span><br><span class="line">CATALOG              Oracle Database Catalog Views                      19.0.0.0.0 VALID</span><br><span class="line">CATPROC              Oracle Database Packages and Types                 19.0.0.0.0 VALID</span><br><span class="line">RAC                  Oracle Real Application Clusters                   19.0.0.0.0 OPTION OFF</span><br><span class="line">JAVAVM               JServer JAVA Virtual Machine                       19.0.0.0.0 VALID</span><br><span class="line">XML                  Oracle XDK                                         19.0.0.0.0 VALID</span><br><span class="line">CATJAVA              Oracle Database Java Packages                      19.0.0.0.0 VALID</span><br><span class="line">APS                  OLAP Analytic Workspace                            19.0.0.0.0 VALID</span><br><span class="line">XDB                  Oracle XML Database                                19.0.0.0.0 VALID</span><br><span class="line">OWM                  Oracle Workspace Manager                           19.0.0.0.0 VALID</span><br><span class="line">CONTEXT              Oracle Text                                        19.0.0.0.0 VALID</span><br><span class="line">ORDIM                Oracle Multimedia                                  19.0.0.0.0 VALID</span><br><span class="line"></span><br><span class="line">COMP_ID              COMP_NAME                                          VERSION    STATUS</span><br><span class="line"><span class="comment">-------------------- -------------------------------------------------- ---------- ----------</span></span><br><span class="line">SDO                  Spatial                                            19.0.0.0.0 VALID</span><br><span class="line">XOQ                  Oracle OLAP API                                    19.0.0.0.0 VALID</span><br><span class="line">OLS                  Oracle Label Security                              19.0.0.0.0 VALID</span><br><span class="line">DV                   Oracle Database Vault                              19.0.0.0.0 VALID</span><br><span class="line"></span><br><span class="line">15 rows selected.</span><br></pre></td></tr></table></figure><ul><li>再次检查PDB_PLUG_IN_VIOLATION</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; select * from pdb_plug_in_violations;</span><br><span class="line"></span><br><span class="line">TIME            NAME     CAUSE        TYPE      ERROR_NUMBER       LINE MESSAGE                                            STATUS    ACTION                             CON_ID</span><br><span class="line"><span class="comment">--------------- -------- ------------ --------- ------------ ---------- -------------------------------------------------- --------- ------------------------------ ----------</span></span><br><span class="line">10-AUG-20 10.51 PDB$SEED SQL Patch    ERROR                0          1 19.5.2.0.0 Release_Update_Revision 2003300442: APP RESOLVED  <span class="keyword">Call</span> datapatch <span class="keyword">to</span> <span class="keyword">install</span> <span class="keyword">in</span> t          <span class="number">2</span></span><br><span class="line"><span class="number">.02</span><span class="number">.625907</span> PM                                                           LY <span class="keyword">with</span> <span class="keyword">status</span> <span class="keyword">WITH</span> <span class="keyword">ERRORS</span> <span class="keyword">in</span> the CDB                        he PDB <span class="keyword">or</span> the CDB</span><br><span class="line"></span><br><span class="line"><span class="number">10</span>-AUG<span class="number">-20</span> <span class="number">10.51</span> PDB$<span class="keyword">SEED</span> <span class="keyword">SQL</span> <span class="keyword">Patch</span>    <span class="keyword">ERROR</span>                <span class="number">0</span>          <span class="number">2</span> <span class="number">19.5</span><span class="number">.2</span><span class="number">.0</span><span class="number">.0</span> Release_Update_Revision <span class="number">2003300442</span>: APP RESOLVED  <span class="keyword">Call</span> datapatch <span class="keyword">to</span> <span class="keyword">install</span> <span class="keyword">in</span> t          <span class="number">2</span></span><br><span class="line"><span class="number">.02</span><span class="number">.625907</span> PM                                                           LY <span class="keyword">with</span> <span class="keyword">status</span> <span class="keyword">WITH</span> <span class="keyword">ERRORS</span> <span class="keyword">in</span> the PDB                        he PDB <span class="keyword">or</span> the CDB</span><br><span class="line"></span><br><span class="line"><span class="number">10</span>-AUG<span class="number">-20</span> <span class="number">11.04</span> PDB1     <span class="keyword">SQL</span> <span class="keyword">Patch</span>    <span class="keyword">ERROR</span>                <span class="number">0</span>          <span class="number">1</span> <span class="number">19.5</span><span class="number">.2</span><span class="number">.0</span><span class="number">.0</span> Release_Update_Revision <span class="number">2003300442</span>: APP RESOLVED  <span class="keyword">Call</span> datapatch <span class="keyword">to</span> <span class="keyword">install</span> <span class="keyword">in</span> t          <span class="number">3</span></span><br><span class="line"><span class="number">.52</span><span class="number">.399087</span> PM                                                           LY <span class="keyword">with</span> <span class="keyword">status</span> <span class="keyword">WITH</span> <span class="keyword">ERRORS</span> <span class="keyword">in</span> the CDB                        he PDB <span class="keyword">or</span> the CDB</span><br><span class="line"></span><br><span class="line"><span class="number">10</span>-AUG<span class="number">-20</span> <span class="number">11.04</span> PDB1     <span class="keyword">SQL</span> <span class="keyword">Patch</span>    <span class="keyword">ERROR</span>                <span class="number">0</span>          <span class="number">2</span> <span class="number">19.5</span><span class="number">.2</span><span class="number">.0</span><span class="number">.0</span> Release_Update_Revision <span class="number">2003300442</span>: APP RESOLVED  <span class="keyword">Call</span> datapatch <span class="keyword">to</span> <span class="keyword">install</span> <span class="keyword">in</span> t          <span class="number">3</span></span><br><span class="line"><span class="number">.52</span><span class="number">.399087</span> PM                                                           LY <span class="keyword">with</span> <span class="keyword">status</span> <span class="keyword">WITH</span> <span class="keyword">ERRORS</span> <span class="keyword">in</span> the PDB                        he PDB <span class="keyword">or</span> the CDB</span><br><span class="line"></span><br><span class="line"><span class="built_in">TIME</span>            <span class="keyword">NAME</span>     CAUSE        <span class="keyword">TYPE</span>      ERROR_NUMBER       LINE MESSAGE                                            <span class="keyword">STATUS</span>    <span class="keyword">ACTION</span>                             CON_ID</span><br><span class="line"><span class="comment">--------------- -------- ------------ --------- ------------ ---------- -------------------------------------------------- --------- ------------------------------ ----------</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;ul&gt;
&lt;li&gt;19.3升级19.5.2，建库出现如下告警&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="Oracle" scheme="http://falkon.cn/categories/Oracle/"/>
    
    
    <category term="19c" scheme="http://falkon.cn/tags/19c/"/>
    
    <category term="OJVM" scheme="http://falkon.cn/tags/OJVM/"/>
    
  </entry>
  
  <entry>
    <title>深入了解Oracle Flex ASM及其优点</title>
    <link href="http://falkon.cn/2021/01/27/database/oracle-flex-asm-advantages-and-disadvantages/"/>
    <id>http://falkon.cn/2021/01/27/database/oracle-flex-asm-advantages-and-disadvantages/</id>
    <published>2021-01-27T09:37:22.667Z</published>
    <updated>2021-01-27T03:09:14.213Z</updated>
    
    
    
    
    <category term="Oracle" scheme="http://falkon.cn/categories/Oracle/"/>
    
    
    <category term="ASM" scheme="http://falkon.cn/tags/ASM/"/>
    
    <category term="19g" scheme="http://falkon.cn/tags/19g/"/>
    
    <category term="Flex" scheme="http://falkon.cn/tags/Flex/"/>
    
  </entry>
  
</feed>
