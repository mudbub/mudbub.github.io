<!DOCTYPE html>
<html lang=en>
<head>
    <meta charset="utf-8">
    
    <title>ASM中的Req_mir_free_MB实验 | MUDBUB.COM</title>
    
    
        <meta name="keywords" content="Req_mir_free_MB,ASM" />
    
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="先看下官网对lsdg给出的各个列属性的说明    属性 描述    State State of the disk group. Values include BROKEN, CONNECTED, DISMOUNTED, MOUNTED, QUIESCING, and UNKNOWN.   Type Disk group redundancy (NORMAL, HIGH, EXTERNAL).">
<meta property="og:type" content="article">
<meta property="og:title" content="ASM中的Req_mir_free_MB实验">
<meta property="og:url" content="http://mudbub.com/2021/01/27/database/asm-req_mir_free_mb-test/index.html">
<meta property="og:site_name" content="MUDBUB.COM">
<meta property="og:description" content="先看下官网对lsdg给出的各个列属性的说明    属性 描述    State State of the disk group. Values include BROKEN, CONNECTED, DISMOUNTED, MOUNTED, QUIESCING, and UNKNOWN.   Type Disk group redundancy (NORMAL, HIGH, EXTERNAL).">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2021-01-27T09:37:22.554Z">
<meta property="article:modified_time" content="2021-04-20T07:35:07.595Z">
<meta property="article:author" content="Falkon">
<meta property="article:tag" content="Req_mir_free_MB">
<meta property="article:tag" content="ASM">
<meta name="twitter:card" content="summary">
    

    
        <link rel="alternate" href="/atom.xml" title="MUDBUB.COM" type="application/atom+xml" />
    

    
        <link rel="icon" href="http://qnlcbj437.mudbub.com/favicon.png" />
    

    
<link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">

    
<link rel="stylesheet" href="/libs/open-sans/styles.css">

    
<link rel="stylesheet" href="/libs/source-code-pro/styles.css">


    
<link rel="stylesheet" href="/css/style.css">

    
<script src="/libs/jquery/2.1.3/jquery.min.js"></script>

    
<script src="/libs/jquery/plugins/cookie/1.4.1/jquery.cookie.js"></script>

    
    
        
<link rel="stylesheet" href="/libs/lightgallery/css/lightgallery.min.css">

    
    
        
<link rel="stylesheet" href="/libs/justified-gallery/justifiedGallery.min.css">

    
    
    
    


    
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
<meta name="generator" content="Hexo 4.2.0"></head>

<body>
    <div id="container">
        <header id="header">
    <div id="header-main" class="header-inner">
        <div class="outer">
            <a href="/" id="logo">
                <i class="logo"></i>
                <span class="site-title">MUDBUB.COM</span>
            </a>
            <nav id="main-nav">
                
                    <a class="main-nav-link" href="/">首页</a>
                
                    <a class="main-nav-link" href="/archives">归档</a>
                
                    <a class="main-nav-link" href="/categories">分类</a>
                
                    <a class="main-nav-link" href="/tags">标签</a>
                
                    <a class="main-nav-link" href="/about">关于</a>
                
            </nav>
            
            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="Search" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="Type something..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>


</div>
        </div>
    </div>
    <div id="main-nav-mobile" class="header-sub header-inner">
        <table class="menu outer">
            <tr>
                
                    <td><a class="main-nav-link" href="/">首页</a></td>
                
                    <td><a class="main-nav-link" href="/archives">归档</a></td>
                
                    <td><a class="main-nav-link" href="/categories">分类</a></td>
                
                    <td><a class="main-nav-link" href="/tags">标签</a></td>
                
                    <td><a class="main-nav-link" href="/about">关于</a></td>
                
                <td>
                    
    <div class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="Search" />
    </div>

                </td>
            </tr>
        </table>
    </div>
</header>

        <div class="outer">
            
            
                <aside id="sidebar">
   
        
    <div class="widget-wrap" id='categories'>
        <h3 class="widget-title">
            <span>categories</span>
            &nbsp;
            <a id='allExpand' href="#">
                <i class="fa fa-angle-double-down fa-2x"></i>
            </a>
        </h3>
        
        
        
         <ul class="unstyled" id="tree" > 
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            DevOps
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2021/01/27/linux/zabbix50-add-chinese-language/">Zabbix5.0添加中文</a></li>  <li class="file"><a href="/2021/01/27/linux/zabbix50-compile-installation/">Zabbix 5.0 编译安装</a></li>  <li class="file"><a href="/2021/01/27/linux/zabbix50-server-is-not-running/">ZABBIX SERVER IS NOT RENNING THE INFORMATION DISPLAYED MAY NOT BE CORRECT</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            Linux
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2021/01/27/linux/centos8-mini-installed-then-install-desktop/">CentOS 8 Mini installed then installation Desktop</a></li>  <li class="file"><a href="/2021/01/27/linux/linux-create-zombie-processes-and-killed/">Linux下创建模拟僵尸进程并杀死</a></li>  <li class="file"><a href="/2021/01/27/linux/linux-extend-swap/">Linux扩展swap分区</a></li>  <li class="file"><a href="/2021/01/27/linux/linux78-config-vncserver/">Linux 7.8安装配置VNCSERVER</a></li>  <li class="file"><a href="/2021/02/20/linux/docker-installation-for-centos79/">CentOS 7.9 安装 Docker</a></li>  <li class="file"><a href="/2021/02/21/linux/backup-in-the-docker-dumpfile-0/">在Docker中备份MySQL，备份文件中没有数据</a></li>  <li class="file"><a href="/2021/02/22/linux/crontab-time-format-explain-in-detail/">Linux crontab工作定义详解</a></li>  <li class="file"><a href="/2021/04/12/linux/alua-port-group-messages/">ALUA port group messages</a></li>  <li class="file"><a href="/2021/04/22/linux/ssh-limit-ip-login/">Linux SSH限制IP登录</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            MySQL
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2021/01/27/database/mysql57-installation-for-centos78/">MySQL5.7在CentOS7.8平台上的部署</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            NAS
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2021/01/27/linux/openfiler-installation-and-configuration/">Openfiler安装配置</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory open">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder-open"></i>
                            &nbsp;
                            Oracle
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file active"><a href="/2021/01/27/database/asm-req_mir_free_mb-test/">ASM中的Req_mir_free_MB实验</a></li>  <li class="file"><a href="/2021/01/27/database/exp-imp/">Oracle 导入导出工具的基本使用</a></li>  <li class="file"><a href="/2021/01/27/database/expdp-impdp/">Oracle 数据泵的基本使用</a></li>  <li class="file"><a href="/2021/01/27/database/ora-00600-internal-error-code-parameter-4511/">ORA-00600 内部错误代码 参数 [4511]</a></li>  <li class="file"><a href="/2021/01/27/database/ora-00980-synonym-translation-is-no-longer-valid/">ORA-00980 synonym translation is no longer valid</a></li>  <li class="file"><a href="/2021/01/27/database/ora-01804-failure-to-initialize-timezone-information/">ORA-01804 failure to initialize timezone information</a></li>  <li class="file"><a href="/2021/01/27/database/ora-28000-the-account-is-locked/">ORA-28000 the account is locked</a></li>  <li class="file"><a href="/2021/01/27/database/ora-65500-could-not-modify-db_unique_name-resource-exists/">ORA-65500 could not modify DB_UNIQUE_NAME, resource exists</a></li>  <li class="file"><a href="/2021/01/27/database/oracle-12c-cloud-depoly-and-local-silent-installation/">Oracle 12c 云上部署和本地静默安装</a></li>  <li class="file"><a href="/2021/01/27/database/oracle-12c-pdb-clone/">Oracle 12c PDB克隆</a></li>  <li class="file"><a href="/2021/01/27/database/oracle-12c-single-node-installation-psu-patch/">Oracle 12c单节点RAC安装PSU补丁程序</a></li>  <li class="file"><a href="/2021/01/27/database/oracle-12c-varchar2-extended/">Oracle 12c varchar2字段长度扩展</a></li>  <li class="file"><a href="/2021/01/27/database/oracle-asm-lun-size/">Oracle ASM LUN Size</a></li>  <li class="file"><a href="/2021/01/27/database/oracle-audit-files-delete-test/">Oracle Audit目录中文件的内容以及是否可以删除</a></li>  <li class="file"><a href="/2021/01/27/database/oracle-dcd/">Oracle DCD详解</a></li>  <li class="file"><a href="/2021/01/27/database/oracle-flex-asm-advantages-and-disadvantages/">深入了解Oracle Flex ASM及其优点</a></li>  <li class="file"><a href="/2021/01/27/database/patch-30830913-apply-with%20errors/">Oracle 19.5 Patch 30830913 apply (pdb CDB$ROOT) WITH ERRORS</a></li>  <li class="file"><a href="/2021/01/27/database/pga_aggregate_target-specified-is-high/">PGA_AGGREGATE_TARGET specified is high</a></li>  <li class="file"><a href="/2021/01/27/database/rhel-install-oracle11g-ogg/">Linux Installation Oracle11g GoldenGate</a></li>  <li class="file"><a href="/2021/01/27/database/rhel-install-oracle11g-rac/">Linux Installation 11g RAC</a></li>  <li class="file"><a href="/2021/01/27/database/rhel-install-oracle11g/">Linux Installation Oracle 11g</a></li>  <li class="file"><a href="/2021/01/27/database/rhel-install-oracle12c-rac/">Linux Installation Oracle 12c RAC</a></li>  <li class="file"><a href="/2021/01/27/database/rhel-install-oracle12c/">Linux Installation Oracle 12c</a></li>  <li class="file"><a href="/2021/03/22/database/warning-too-many-parse-errors/">WARNING too many parse errors</a></li>  <li class="file"><a href="/2021/03/26/database/oracle-database-misoperation-recovery/">Oracle常见误操作数据恢复</a></li>  <li class="file"><a href="/2021/03/26/database/oda-x8-2-ha-nvme-raid/">ODA X8-2 HA RAID模式错误处理</a></li>  <li class="file"><a href="/2021/03/31/database/oracle-rename-sys/">等保2.0要求Oracle重命名SYS</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            Oracle Database Appliance
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2021/01/27/database/oda-latest-patch-address/">ODA最新补丁文档和下载地址</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            Oracle Enterprise Manager Cloud Control
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2021/01/27/database/emcc134-oracle-management-server-could-not-be-started/">EMCC 13.4启动遭遇Oracle Management Server Could Not Be Started</a></li>  <li class="file"><a href="/2021/01/27/database/the-plug-in-bi-iublisher-configuration-has-failed-its-perform-method/">The plug-in BI Publisher Configuration has failed its perform method</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            SQL Server
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2021/01/27/database/sqlserver-2019-installation-for-centos78/">SQL Server 2019 Installation for CentOS 7.8</a></li>  </ul> 
                    </li> 
                     </ul> 
    </div>
    <script>
        $(document).ready(function() {
            var iconFolderOpenClass  = 'fa-folder-open';
            var iconFolderCloseClass = 'fa-folder';
            var iconAllExpandClass = 'fa-angle-double-down';
            var iconAllPackClass = 'fa-angle-double-up';
            // Handle directory-tree expansion:
            // 左键单独展开目录
            $(document).on('click', '#categories a[data-role="directory"]', function (event) {
                event.preventDefault();

                var icon = $(this).children('.fa');
                var expanded = icon.hasClass(iconFolderOpenClass);
                var subtree = $(this).siblings('ul');
                icon.removeClass(iconFolderOpenClass).removeClass(iconFolderCloseClass);
                if (expanded) {
                    if (typeof subtree != 'undefined') {
                        subtree.slideUp({ duration: 100 });
                    }
                    icon.addClass(iconFolderCloseClass);
                } else {
                    if (typeof subtree != 'undefined') {
                        subtree.slideDown({ duration: 100 });
                    }
                    icon.addClass(iconFolderOpenClass);
                }
            });
            // 右键展开下属所有目录
            $('#categories a[data-role="directory"]').bind("contextmenu", function(event){
                event.preventDefault();
                
                var icon = $(this).children('.fa');
                var expanded = icon.hasClass(iconFolderOpenClass);
                var listNode = $(this).siblings('ul');
                var subtrees = $.merge(listNode.find('li ul'), listNode);
                var icons = $.merge(listNode.find('.fa'), icon);
                icons.removeClass(iconFolderOpenClass).removeClass(iconFolderCloseClass);
                if(expanded) {
                    subtrees.slideUp({ duration: 100 });
                    icons.addClass(iconFolderCloseClass);
                } else {
                    subtrees.slideDown({ duration: 100 });
                    icons.addClass(iconFolderOpenClass);
                }
            })
            // 展开关闭所有目录按钮
            $(document).on('click', '#allExpand', function (event) {
                event.preventDefault();
                
                var icon = $(this).children('.fa');
                var expanded = icon.hasClass(iconAllExpandClass);
                icon.removeClass(iconAllExpandClass).removeClass(iconAllPackClass);
                if(expanded) {
                    $('#sidebar .fa.fa-folder').removeClass('fa-folder').addClass('fa-folder-open')
                    $('#categories li ul').slideDown({ duration: 100 });
                    icon.addClass(iconAllPackClass);
                } else {
                    $('#sidebar .fa.fa-folder-open').removeClass('fa-folder-open').addClass('fa-folder')
                    $('#categories li ul').slideUp({ duration: 100 });
                    icon.addClass(iconAllExpandClass);
                }
            });  
        });
    </script>

    
    <div id="toTop" class="fa fa-angle-up"></div>
</aside>
            
            <section id="main"><article id="post-database/asm-req_mir_free_mb-test" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
                    <div class="article-meta">
                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/Oracle/">Oracle</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/ASM/" rel="tag">ASM</a>, <a class="tag-link" href="/tags/Req-mir-free-MB/" rel="tag">Req_mir_free_MB</a>
    </div>

                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2021/01/27/database/asm-req_mir_free_mb-test/">
            <time datetime="2021-01-27T09:37:22.554Z" itemprop="datePublished">2021-01-27</time>
        </a>
    </div>


                        
                            <i class="fa fa-bar-chart"></i>
                            <span id="busuanzi_container_site_pv"><span id="busuanzi_value_page_pv"></span></span>    
                        
                        
                            <div class="article-meta-button">
                                <a href='https://github.com/falkon/mudbub/raw/writing/source/_posts/database/asm-req_mir_free_mb-test.md' target="_blank" rel="noopener"> Source </a>
                            </div>
                            <div class="article-meta-button">
                                <a href='https://github.com/falkon/mudbub/edit/writing/source/_posts/database/asm-req_mir_free_mb-test.md' target="_blank" rel="noopener"> Edit </a>
                            </div>
                            <div class="article-meta-button">
                                <a href='https://github.com/falkon/mudbub/commits/writing/source/_posts/database/asm-req_mir_free_mb-test.md' target="_blank" rel="noopener"> History </a>
                            </div>
                        
                    </div>
                
                
    
        <h1 class="article-title" itemprop="name">
            ASM中的Req_mir_free_MB实验
        </h1>
    

            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
        
            
        
        
            <ul>
<li><p>先看下官网对lsdg给出的各个列属性的说明</p>
<table>
<thead>
<tr>
<th>属性</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>State</td>
<td>State of the disk group. Values include BROKEN, CONNECTED, DISMOUNTED, MOUNTED, QUIESCING, and UNKNOWN.</td>
</tr>
<tr>
<td>Type</td>
<td>Disk group redundancy (NORMAL, HIGH, EXTERNAL).</td>
</tr>
<tr>
<td>Rebal</td>
<td>Y if a rebalance operation is in progress.</td>
</tr>
<tr>
<td>Sector</td>
<td>Sector size in bytes.</td>
</tr>
<tr>
<td>Block</td>
<td>Block size in bytes.</td>
</tr>
<tr>
<td>AU</td>
<td>Allocation unit size in bytes.</td>
</tr>
<tr>
<td>Total_MB</td>
<td>Size of the disk group in megabytes.</td>
</tr>
<tr>
<td><strong>Free_MB</strong></td>
<td><strong>Free space in the disk group in megabytes, without regard to redundancy. From the V$ASM_DISKGROUP view.</strong></td>
</tr>
<tr>
<td><strong>Req_mir_free_MB</strong></td>
<td><strong>Amount of space that must be available in the disk group to restore full redundancy after the most severe failure that can be tolerated by the disk group. This is the REQUIRED_MIRROR_FREE_MB column from the V$ASM_DISKGROUP view.</strong></td>
</tr>
<tr>
<td><strong>Usable_file_MB</strong></td>
<td><strong>Amount of free space, adjusted for mirroring, that is available for new files. From the V$ASM_DISKGROUP view.</strong></td>
</tr>
<tr>
<td>Offline_disks</td>
<td>Number of offline disks in the disk group. Offline disks are eventually dropped.</td>
</tr>
<tr>
<td>Voting_files</td>
<td>Specifies whether the disk group contains voting files (Y or N).</td>
</tr>
<tr>
<td>Name</td>
<td>Disk group name.</td>
</tr>
</tbody></table>
</li>
</ul>
<a id="more"></a>

<ul>
<li><p>从描述上看：Free_MB是不考虑冗余度的空闲空间，从V$ASM_DISKGROUP视图和lsdg命令都可以获得相关容量，也就是说如果的你ASM磁盘组是基于External，那么磁盘组在未使用的情况下，TOTAL_MB约等于FREE_MB，少的空间为ASM元数据占用，FREE_MB等于USABLE_FILE_MB，REQUIRED_MIRROR_FREE_MB等于0，因为没有独立FAILGROUP，冗余是基于存储本身的RAID技术进行冗余</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[grid@testdb12c01 ~]$ sqlplus / as sysasm</span><br><span class="line"></span><br><span class="line">SQL*Plus: Release 12.1.0.2.0 Production on Sun Mar 22 00:26:20 2020</span><br><span class="line"></span><br><span class="line">Copyright (c) 1982, 2014, Oracle.  All rights reserved.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Connected to:</span><br><span class="line">Oracle Database 12c Enterprise Edition <span class="keyword">Release</span> <span class="number">12.1</span><span class="number">.0</span><span class="number">.2</span><span class="number">.0</span> - <span class="number">64</span><span class="built_in">bit</span> Production</span><br><span class="line"><span class="keyword">With</span> the <span class="built_in">Real</span> Application Clusters <span class="keyword">and</span> <span class="keyword">Automatic</span> <span class="keyword">Storage</span> <span class="keyword">Management</span> options</span><br><span class="line"></span><br><span class="line"><span class="keyword">SQL</span>&gt; <span class="keyword">create</span> <span class="keyword">diskgroup</span> GP_EXTERNAL <span class="keyword">external</span> redundancy disk <span class="string">'/dev/asmdisk/TESTDISK01'</span>;</span><br><span class="line"></span><br><span class="line">Diskgroup created.</span><br><span class="line"></span><br><span class="line">SQL&gt; col name for a20</span><br><span class="line">SQL&gt; set linesize 200</span><br><span class="line">SQL&gt; select group_number,name,type,state,total_mb,free_mb,required_mirror_free_mb,usable_file_mb from v$asm_diskgroup where name='GP_EXTERNAL';</span><br><span class="line"></span><br><span class="line">GROUP_NUMBER NAME          TYPE     STATE           TOTAL_MB    FREE_MB REQUIRED_MIRROR_FREE_MB USABLE_FILE_MB</span><br><span class="line"><span class="comment">------------ ------------- ------ -----------       ---------- -------- ----------------------- --------------</span></span><br><span class="line">       4     GP_EXTERNAL     EXTERN MOUNTED          1024        974             0               974</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看FAILGROUP，发现FAILGROUP等于磁盘本身</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; select group_number,name,failgroup from v$asm_disk where group_number=4;</span><br><span class="line"></span><br><span class="line">GROUP_NUMBER NAME          FAILGROUP</span><br><span class="line"><span class="comment">------------ -------------------- ------------------------------</span></span><br><span class="line">       4 GP_EXTERNAL_0000      GP_EXTERNAL_0000</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建一个表空间看看会发生什么，发现每个段只有1份，在0号磁盘上进行了复制，copy=1</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; create tablespace ext_test datafile '+GP_EXTERNAL' size 1m;</span><br><span class="line"></span><br><span class="line">Tablespace created.</span><br><span class="line"></span><br><span class="line">SQL&gt; col tablespace_name for a15</span><br><span class="line">SQL&gt; col file_name for a100</span><br><span class="line">SQL&gt; set linesize 200</span><br><span class="line">SQL&gt; select tablespace_name,file_name from dba_data_files where tablespace_name='EXTER01';</span><br><span class="line"></span><br><span class="line">TABLESPACE_NAME FILE_NAME</span><br><span class="line"><span class="comment">--------------- ---------------------------------------------------------------------------------</span></span><br><span class="line">EXTER01     +GP_EXTERNAL/PRODDB/A14CD6FDD3B55795E0531570A8C04632/DATAFILE/exter01.256.1035685075</span><br><span class="line"></span><br><span class="line">SQL&gt; SELECT</span><br><span class="line">    disk_kffxp  disk<span class="comment">#,</span></span><br><span class="line">    xnum_kffxp  extent<span class="comment">#,</span></span><br><span class="line">    CASE lxn_kffxp</span><br><span class="line">        WHEN 0  THEN</span><br><span class="line">            'Primary Copy'</span><br><span class="line">        WHEN 1  THEN</span><br><span class="line">            'Mirrored Copy'</span><br><span class="line">        WHEN 2  THEN</span><br><span class="line">            '2nd Mirrored Copy or metadata'</span><br><span class="line">        ELSE</span><br><span class="line">            'Unknown'</span><br><span class="line">    <span class="keyword">END</span> <span class="keyword">type</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    x$kffxp</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">        number_kffxp = <span class="number">256</span></span><br><span class="line">    <span class="keyword">AND</span> group_kffxp = <span class="number">4</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">    <span class="number">2</span>; </span><br><span class="line"></span><br><span class="line">     DISK<span class="comment">#    EXTENT# TYPE</span></span><br><span class="line"><span class="comment">---------- ---------- -----------------------------</span></span><br><span class="line">     0        0 Primary Copy</span><br><span class="line">     0        1 Primary Copy</span><br></pre></td></tr></table></figure>
</li>
<li><p>基于normal，normal是双重数据镜像，至少要求有两块磁盘，按照最少要求两块磁盘创建，发现REQUIRED_MIRROR_FREE_MB依旧等于等于0</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; create diskgroup GP_NORMAL normal redundancy disk '/dev/asmdisk/TESTDISK02','/dev/asmdisk/TESTDISK03';</span><br><span class="line"></span><br><span class="line">Diskgroup created.</span><br><span class="line">SQL&gt; select group_number,name,type,state,total_mb,free_mb,required_mirror_free_mb,usable_file_mb from v$asm_diskgroup where name='GP_NORMAL';</span><br><span class="line"></span><br><span class="line">GROUP_NUMBER NAME          TYPE     STATE           TOTAL_MB    FREE_MB REQUIRED_MIRROR_FREE_MB USABLE_FILE_MB</span><br><span class="line"><span class="comment">------------ ------------- ------ -----------       ---------- ---------- --------------------- --------------</span></span><br><span class="line">       5 GP_NORMAL          NORMAL MOUNTED            2048       1946             0              973</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看FAILGROUP，发现FAILGROUP依旧等于等于磁盘本身，没有多余的磁盘来提供给Req_mir_free_MB使用</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; select group_number,name,failgroup from v$asm_disk where group_number=5;</span><br><span class="line"></span><br><span class="line">GROUP_NUMBER NAME                FAILGROUP</span><br><span class="line"><span class="comment">------------ ------------------------------ ------------------------------</span></span><br><span class="line">       5 GP_NORMAL_0001            GP_NORMAL_0001</span><br><span class="line">       5 GP_NORMAL_0000            GP_NORMAL_0000</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建一个表空间看看会发生什么，发现每个段被分成了两份，在0号磁盘和1号磁盘上，copy=2</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; create tablespace normal01 datafile '+GP_NORMAL' size 1m;</span><br><span class="line"></span><br><span class="line">Tablespace created.</span><br><span class="line"></span><br><span class="line">SQL&gt; select tablespace_name,file_name from dba_data_files where tablespace_name='NORMAL01';</span><br><span class="line"></span><br><span class="line">TABLESPACE_NAME FILE_NAME</span><br><span class="line"><span class="comment">--------------- --------------------------------------------------------------------------------</span></span><br><span class="line">NORMAL01    +GP_NORMAL/PRODDB/A14CD6FDD3B55795E0531570A8C04632/DATAFILE/normal01.256.1035685391</span><br><span class="line"></span><br><span class="line">SQL&gt; SELECT</span><br><span class="line">    disk_kffxp  disk<span class="comment">#,</span></span><br><span class="line">    xnum_kffxp  extent<span class="comment">#,</span></span><br><span class="line">    CASE lxn_kffxp</span><br><span class="line">        WHEN 0  THEN</span><br><span class="line">            'Primary Copy'</span><br><span class="line">        WHEN 1  THEN</span><br><span class="line">            'Mirrored Copy'</span><br><span class="line">        WHEN 2  THEN</span><br><span class="line">            '2nd Mirrored Copy or metadata'</span><br><span class="line">        ELSE</span><br><span class="line">            'Unknown'</span><br><span class="line">    <span class="keyword">END</span> <span class="keyword">type</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    x$kffxp</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">        number_kffxp = <span class="number">256</span></span><br><span class="line">    <span class="keyword">AND</span> group_kffxp = <span class="number">5</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">    <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">     DISK<span class="comment">#    EXTENT# TYPE</span></span><br><span class="line"><span class="comment">---------- ---------- -----------------------------</span></span><br><span class="line">     1        0 Primary Copy</span><br><span class="line">     0        0 Mirrored Copy</span><br><span class="line">     0        1 Primary Copy</span><br><span class="line">     1        1 Mirrored Copy</span><br></pre></td></tr></table></figure>
</li>
<li><p>Req_mir_free_MB是在磁盘组出现故障之后，磁盘组组必须有足够的空间来重新定义冗余度，normal模式，使用三块磁盘创建磁盘组，创建完成后发现REQUIRED_MIRROR_FREE_MB的空间为1G，是一块物理磁盘大小，也就意味着如果在创建的磁盘组的时候，按照最小要求磁盘数（normal最小2块、high最小3块）去创建的话，磁盘组的冗余只能是基于磁盘本身，当超出最小磁盘组要求的磁盘数时，会取其中的一块（normal）或两块（high）做为REQUIRED_MIRROR_FREE_MB的空间</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; create diskgroup GP_NORMAL01 normal redundancy disk '/dev/asmdisk/TESTDISK04','/dev/asmdisk/TESTDISK05','/dev/asmdisk/TESTDISK06';</span><br><span class="line"></span><br><span class="line">Diskgroup created.</span><br><span class="line"></span><br><span class="line">SQL&gt; select group_number,name,type,state,total_mb,free_mb,required_mirror_free_mb,usable_file_mb from v$asm_diskgroup where name='GP_NORMAL01';</span><br><span class="line"></span><br><span class="line">GROUP_NUMBER NAME          TYPE     STATE           TOTAL_MB    FREE_MB REQUIRED_MIRROR_FREE_MB USABLE_FILE_MB</span><br><span class="line"><span class="comment">------------ ----------   --------- ------          ---------- ---------- --------------------- --------------</span></span><br><span class="line">       6 GP_NORMAL01      NORMAL MOUNTED            3072        2919              1024           947</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看FAILGROUP，发现FAILGROUP多出来一块磁盘，REQUIRED_MIRROR_FREE_MB空间等于多出来的那块磁盘</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; select group_number,name,failgroup from v$asm_disk where group_number=6;</span><br><span class="line"></span><br><span class="line">GROUP_NUMBER NAME                FAILGROUP</span><br><span class="line"><span class="comment">------------ ------------------------------ ------------------------------</span></span><br><span class="line">       6 GP_NORMAL01_0002            GP_NORMAL01_0002</span><br><span class="line">       6 GP_NORMAL01_0001            GP_NORMAL01_0001</span><br><span class="line">       6 GP_NORMAL01_0000            GP_NORMAL01_0000</span><br></pre></td></tr></table></figure>
</li>
<li><p>在继续创建一个表空间，看看复制情况，发现每个段依旧被分成了两份，随机写入到0、1、2号磁盘，copy=2</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; create tablespace normal02 datafile '+GP_NORMAL01' size 1m;</span><br><span class="line"></span><br><span class="line">Tablespace created.</span><br><span class="line"></span><br><span class="line">SQL&gt; select tablespace_name,file_name from dba_data_files where tablespace_name='NORMAL02';</span><br><span class="line"></span><br><span class="line">TABLESPACE_NAME FILE_NAME</span><br><span class="line"><span class="comment">--------------- ---------------------------------------------------------------------------------</span></span><br><span class="line">NORMAL02    +GP_NORMAL01/PRODDB/A14CD6FDD3B55795E0531570A8C04632/DATAFILE/normal02.256.1035689003</span><br><span class="line"></span><br><span class="line">SQL&gt; SELECT</span><br><span class="line">    disk_kffxp  disk<span class="comment">#,</span></span><br><span class="line">    xnum_kffxp  extent<span class="comment">#,</span></span><br><span class="line">    CASE lxn_kffxp</span><br><span class="line">        WHEN 0  THEN</span><br><span class="line">            'Primary Copy'</span><br><span class="line">        WHEN 1  THEN</span><br><span class="line">            'Mirrored Copy'</span><br><span class="line">        WHEN 2  THEN</span><br><span class="line">            '2nd Mirrored Copy or metadata'</span><br><span class="line">        ELSE</span><br><span class="line">            'Unknown'</span><br><span class="line">    <span class="keyword">END</span> <span class="keyword">type</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    x$kffxp</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">        number_kffxp = <span class="number">256</span></span><br><span class="line">    <span class="keyword">AND</span> group_kffxp = <span class="number">6</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">    <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">     DISK<span class="comment">#    EXTENT# TYPE</span></span><br><span class="line"><span class="comment">---------- ---------- -----------------------------</span></span><br><span class="line">     0        0 Primary Copy</span><br><span class="line">     2        0 Mirrored Copy</span><br><span class="line">     1        1 Primary Copy</span><br><span class="line">     2        1 Mirrored Copy</span><br></pre></td></tr></table></figure></li>
<li><p>第二次创建表空间，观察段写入情况</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; create tablespace normal03 datafile '+GP_NORMAL01' size 1m;</span><br><span class="line"></span><br><span class="line">Tablespace created.</span><br><span class="line"></span><br><span class="line">SQL&gt; select tablespace_name,file_name from dba_data_files where tablespace_name='NORMAL03';</span><br><span class="line"></span><br><span class="line">TABLESPACE_NAME FILE_NAME</span><br><span class="line"><span class="comment">--------------- ---------------------------------------------------------------------------------</span></span><br><span class="line">NORMAL03    +GP_NORMAL01/PRODDB/A14CD6FDD3B55795E0531570A8C04632/DATAFILE/normal03.257.1035693469</span><br><span class="line"></span><br><span class="line">SQL&gt; SELECT</span><br><span class="line">    disk_kffxp  disk<span class="comment">#,</span></span><br><span class="line">    xnum_kffxp  extent<span class="comment">#,</span></span><br><span class="line">    CASE lxn_kffxp</span><br><span class="line">        WHEN 0  THEN</span><br><span class="line">            'Primary Copy'</span><br><span class="line">        WHEN 1  THEN</span><br><span class="line">            'Mirrored Copy'</span><br><span class="line">        WHEN 2  THEN</span><br><span class="line">            '2nd Mirrored Copy or metadata'</span><br><span class="line">        ELSE</span><br><span class="line">            'Unknown'</span><br><span class="line">    <span class="keyword">END</span> <span class="keyword">type</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    x$kffxp</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">        number_kffxp = <span class="number">257</span></span><br><span class="line">    <span class="keyword">AND</span> group_kffxp = <span class="number">6</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">    <span class="number">2</span>; </span><br><span class="line"></span><br><span class="line">     DISK<span class="comment">#    EXTENT# TYPE</span></span><br><span class="line"><span class="comment">---------- ---------- -----------------------------</span></span><br><span class="line">     1        0 Primary Copy</span><br><span class="line">     0        0 Mirrored Copy</span><br><span class="line">     2        1 Primary Copy</span><br><span class="line">     0        1 Mirrored Copy</span><br></pre></td></tr></table></figure>
</li>
<li><p>Usable_file_MB是在满足了冗余度之后，还有多少剩余空间可使用，通过上面的实验发现，Usable_file_MB本身就是在满足冗余度之后，还有多少剩余空间可用，也可以使用（Free_MB - Req_mir_free_MB）/ 冗余度 = 剩余可用空间，尝试来计算下，在external模式下为：（974 - 0）/ 1 = 974，在normal模式下：（1946 - 0）/ 2 = 973，在normal模式带Req_mir_free_MB空间下：（2919 - 1024） / 2 = 947.5，因为是MB所以小数部分不显示</p>
</li>
</ul>

            </div>
        
        <footer class="article-footer">
        </footer>
    </div>
</article>


    
<nav id="article-nav">
    
        <a href="/2021/01/27/database/emcc134-oracle-management-server-could-not-be-started/" id="article-nav-newer" class="article-nav-link-wrap">
            <strong class="article-nav-caption">Newer</strong>
            <div class="article-nav-title">
                
                    EMCC 13.4启动遭遇Oracle Management Server Could Not Be Started
                
            </div>
        </a>
    
    
</nav>





    
    




<!-- baidu url auto push script -->
<script type="text/javascript">
    !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=window.location.href,o=document.referrer;if(!e.test(r)){var n="//api.share.baidu.com/s.gif";o?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var t=new Image;t.src=n}}(window);
</script>     
</section>
        </div>
        <footer id="footer">
    <div class="outer">
        <div id="footer-info" class="inner">
            Falkon &copy; 2021 
            <a rel="license noopener" href="http://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank"><img alt="Creative Commons License" style="border-width:0" src="https://licensebuttons.net/l/by-nc-nd/4.0/80x15.png" /></a>
            <br> Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Theme - <a href="https://github.com/zthxxx/hexo-theme-Wikitten" target="_blank" rel="noopener">wikitten</a>
            
                <br>
                <span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i> <span id="busuanzi_value_site_pv"></span></span>
                &nbsp;|&nbsp;
                <span id="busuanzi_container_site_pv"><i class="fa fa-user"></i> <span id="busuanzi_value_site_uv"></span></span>
            
        </div>
    </div>
</footer>

        

    
        
<script src="/libs/lightgallery/js/lightgallery.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-thumbnail.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-pager.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-autoplay.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-fullscreen.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-zoom.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-hash.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-share.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-video.min.js"></script>

    
    
        
<script src="/libs/justified-gallery/jquery.justifiedGallery.min.js"></script>

    
    
        <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true,
            TeX: {
                equationNumbers: {
                  autoNumber: 'AMS'
                }
            }
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script async src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    



<!-- Custom Scripts -->

<script src="/js/main.js"></script>


    </div>
</body>
</html>